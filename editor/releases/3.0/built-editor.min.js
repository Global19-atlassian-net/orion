/*

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
 Felipe Heidrich (IBM Corporation) - initial API and implementation
 Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
 Felipe Heidrich (IBM Corporation) - initial API and implementation
 Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
 IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
 Felipe Heidrich (IBM Corporation) - initial API and implementation
 Silenio Quarti (IBM Corporation) - initial API and implementation
 Mihai Sucan (Mozilla Foundation) - fix for Bug#334583 Bug#348471 Bug#349485 Bug#350595 Bug#360726 Bug#361180 Bug#362835 Bug#362428 Bug#362286 Bug#354270 Bug#361474 Bug#363945 Bug#366312 Bug#370584

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
 Felipe Heidrich (IBM Corporation) - initial API and implementation
 Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
 Felipe Heidrich (IBM Corporation) - initial API and implementation
 Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
 Felipe Heidrich (IBM Corporation) - initial API and implementation
 Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
 Felipe Heidrich (IBM Corporation) - initial API and implementation
 Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
 Felipe Heidrich (IBM Corporation) - initial API and implementation
 Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2009, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
 IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
 IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
 IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
 IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 Copyright (c) 2012 VMware, Inc.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
 IBM Corporation - initial API and implementation
 Andrew Eisenberg - rename to jsTemplateContentAssist.js

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation 

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
 IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation 

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation 

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation
 Alex Lakatos - fix for bug#369781

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
 IBM Corporation - initial API and implementation
 RequireJS i18n 2.0.2 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/i18n for details

 Copyright (c) 2011 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
 IBM Corporation - initial API and implementation
*/
var requirejs,require,define;
(function(p){function t(b,j){var r,a,n,c,i,g,f,e,l,q=j&&j.split("/"),o=s.map,h=o&&o["*"]||{};if(b&&b.charAt(0)===".")if(j){q=q.slice(0,q.length-1);b=q.concat(b.split("/"));for(e=0;e<b.length;e+=1)if(r=b[e],r===".")b.splice(e,1),e-=1;else if(r==="..")if(e===1&&(b[2]===".."||b[0]===".."))break;else e>0&&(b.splice(e-1,2),e-=2);b=b.join("/")}else b.indexOf("./")===0&&(b=b.substring(2));if((q||h)&&o){r=b.split("/");for(e=r.length;e>0;e-=1){a=r.slice(0,e).join("/");if(q)for(l=q.length;l>0;l-=1)if(n=o[q.slice(0,
l).join("/")])if(n=n[a]){c=n;i=e;break}if(c)break;!g&&h&&h[a]&&(g=h[a],f=e)}!c&&g&&(c=g,i=f);c&&(r.splice(0,i,c),b=r.join("/"))}return b}function m(d,j){return function(){return c.apply(p,b.call(arguments,0).concat([d,j]))}}function h(b){return function(j){return t(j,b)}}function a(b){return function(j){l[b]=j}}function e(b){if(v.call(o,b)){var j=o[b];delete o[b];u[b]=!0;g.apply(p,j)}if(!v.call(l,b)&&!v.call(u,b))throw Error("No "+b);return l[b]}function f(b){var j,r=b?b.indexOf("!"):-1;r>-1&&(j=
b.substring(0,r),b=b.substring(r+1,b.length));return[j,b]}function k(b){return function(){return s&&s.config&&s.config[b]||{}}}var g,c,i,q,l={},o={},s={},u={},v=Object.prototype.hasOwnProperty,b=[].slice;i=function(b,j){var r,a=f(b),n=a[0],b=a[1];n&&(n=t(n,j),r=e(n));n?b=r&&r.normalize?r.normalize(b,h(j)):t(b,j):(b=t(b,j),a=f(b),n=a[0],b=a[1],n&&(r=e(n)));return{f:n?n+"!"+b:b,n:b,pr:n,p:r}};q={require:function(b){return m(b)},exports:function(b){var j=l[b];return typeof j!=="undefined"?j:l[b]={}},
module:function(b){return{id:b,uri:"",exports:l[b],config:k(b)}}};g=function(b,j,r,c){var n,g,f,h,w=[],k,c=c||b;if(typeof r==="function"){j=!j.length&&r.length?["require","exports","module"]:j;for(h=0;h<j.length;h+=1)if(f=i(j[h],c),g=f.f,g==="require")w[h]=q.require(b);else if(g==="exports")w[h]=q.exports(b),k=!0;else if(g==="module")n=w[h]=q.module(b);else if(v.call(l,g)||v.call(o,g)||v.call(u,g))w[h]=e(g);else if(f.p)f.p.load(f.n,m(c,!0),a(g),{}),w[h]=l[g];else throw Error(b+" missing "+g);j=r.apply(l[b],
w);if(b)if(n&&n.exports!==p&&n.exports!==l[b])l[b]=n.exports;else if(j!==p||!k)l[b]=j}else b&&(l[b]=r)};requirejs=require=c=function(b,j,r,a,n){if(typeof b==="string")return q[b]?q[b](j):e(i(b,j).f);else b.splice||(s=b,j.splice?(b=j,j=r,r=null):b=p);j=j||function(){};typeof r==="function"&&(r=a,a=n);a?g(p,b,j,r):setTimeout(function(){g(p,b,j,r)},4);return c};c.config=function(b){s=b;return c};define=function(b,j,r){j.splice||(r=j,j=[]);!v.call(l,b)&&!v.call(o,b)&&(o[b]=[b,j,r])};define.amd={jQuery:!0}})();
define("almond",function(){});
define("orion/editor/eventTarget",[],function(){function p(){}p.addMixin=function(t){var m=p.prototype,h;for(h in m)m.hasOwnProperty(h)&&(t[h]=m[h])};p.prototype={addEventListener:function(p,m,h){if(!this._eventTypes)this._eventTypes={};var a=this._eventTypes[p];a||(a=this._eventTypes[p]={level:0,listeners:[]});a.listeners.push({listener:m,useCapture:h})},dispatchEvent:function(p){var m=p.type;this._dispatchEvent("pre"+m,p);this._dispatchEvent(m,p);this._dispatchEvent("post"+m,p)},_dispatchEvent:function(p,
m){var h=this._eventTypes?this._eventTypes[p]:null;if(h){var a=h.listeners;try{if(h.level++,a)for(var e=0,f=a.length;e<f;e++)if(a[e]){var k=a[e].listener;typeof k==="function"?k.call(this,m):k.handleEvent&&typeof k.handleEvent==="function"&&k.handleEvent(m)}}finally{if(h.level--,h.compact&&h.level===0){for(e=a.length-1;e>=0;e--)a[e]||a.splice(e,1);a.length===0&&delete this._eventTypes[p];h.compact=!1}}}},isListening:function(p){return!this._eventTypes?!1:this._eventTypes[p]!==void 0},removeEventListener:function(p,
m,h){if(this._eventTypes){var a=this._eventTypes[p];if(a){for(var e=a.listeners,f=0,k=e.length;f<k;f++){var g=e[f];if(g&&g.listener===m&&g.useCapture===h){a.level!==0?(e[f]=null,a.compact=!0):e.splice(f,1);break}}e.length===0&&delete this._eventTypes[p]}}}};return{EventTarget:p}});
define("orion/util",[],function(){var p=navigator.userAgent,t=parseFloat(p.split("MSIE")[1])||void 0,m=parseFloat(p.split("Firefox/")[1]||p.split("Minefield/")[1])||void 0,h=p.indexOf("Opera")!==-1,a=parseFloat(p.split("Chrome/")[1])||void 0,e=p.indexOf("Safari")!==-1&&!a,f=parseFloat(p.split("WebKit/")[1])||void 0,k=p.indexOf("Android")!==-1,g=p.indexOf("iPad")!==-1,p=p.indexOf("iPhone")!==-1,c=g||p,i=navigator.platform.indexOf("Mac")!==-1,q=navigator.platform.indexOf("Win")!==-1,l=navigator.platform.indexOf("Linux")!==
-1;return{formatMessage:function(a){var c=arguments;return a.replace(/\$\{([^\}]+)\}/g,function(a,g){return c[(g<<0)+1]})},createElement:function(a,c){return a.createElementNS?a.createElementNS("http://www.w3.org/1999/xhtml",c):a.createElement(c)},isIE:t,isFirefox:m,isOpera:h,isChrome:a,isSafari:e,isWebkit:f,isAndroid:k,isIPad:g,isIPhone:p,isIOS:c,isMac:i,isWindows:q,isLinux:l,platformDelimiter:q?"\r\n":"\n"}});
define("orion/editor/textModel",["orion/editor/eventTarget","orion/util"],function(p,t){function m(h,a){this._lastLineIndex=-1;this._text=[""];this._lineOffsets=[0];this.setText(h);this.setLineDelimiter(a)}m.prototype={find:function(h){if(this._text.length>1)this._text=[this._text.join("")];var a=h.string,e=a;!h.regex&&a&&(e=a.replace(/([\\$\^*\/+?\.\(\)|{}\[\]])/g,"\\$&"));var f=null,k;if(e){var a=h.reverse,g=h.wrap,c=h.wholeWord,i=h.caseInsensitive,q=h.start||0,l=h.end,h=h.end!==void 0,o="";o.indexOf("g")===
-1&&(o+="g");i&&o.indexOf("i")===-1&&(o+="i");c&&(e="\\b"+e+"\\b");var s=this._text[0],u,m,b=0;h&&(s=s.substring(q,l),b=q);var d=RegExp(e,o);if(a)k=function(){var j=null;for(d.lastIndex=0;;){m=d.lastIndex;u=d.exec(s);if(m===d.lastIndex)return null;if(u){if(!(u.index<q)){if(!g||j)break;q=s.length}j={start:u.index+b,end:d.lastIndex+b}}else break}if(j)q=j.start;return j};else{if(!h)d.lastIndex=q;k=function(){for(;;){m=d.lastIndex;u=d.exec(s);if(m===d.lastIndex)break;if(u)return{start:u.index+b,end:d.lastIndex+
b};if(!(m!==0&&g))break}return null}}f=k()}return{next:function(){var b=f;b&&(f=k());return b},hasNext:function(){return f!==null}}},getCharCount:function(){for(var h=0,a=0;a<this._text.length;a++)h+=this._text[a].length;return h},getLine:function(h,a){var e=this.getLineCount();if(!(0<=h&&h<e))return null;var f=this._lineOffsets[h];if(h+1<e){e=this.getText(f,this._lineOffsets[h+1]);if(a)return e;for(var f=e.length,k;(k=e.charCodeAt(f-1))===10||k===13;)f--;return e.substring(0,f)}else return this.getText(f)},
getLineAtOffset:function(h){var a=this.getCharCount();if(!(0<=h&&h<=a))return-1;var e=this.getLineCount();if(h===a)return e-1;var f,k,g=this._lastLineIndex;if(0<=g&&g<e&&(f=this._lineOffsets[g],k=g+1<e?this._lineOffsets[g+1]:a,f<=h&&h<k))return g;for(var c=e,i=-1;c-i>1;)if(g=Math.floor((c+i)/2),f=this._lineOffsets[g],k=g+1<e?this._lineOffsets[g+1]:a,h<=f)c=g;else if(h<k){c=g;break}else i=g;return this._lastLineIndex=c},getLineCount:function(){return this._lineOffsets.length},getLineDelimiter:function(){return this._lineDelimiter},
getLineEnd:function(h,a){var e=this.getLineCount();if(!(0<=h&&h<e))return-1;if(h+1<e){e=this._lineOffsets[h+1];if(a)return e;for(var f=this.getText(Math.max(this._lineOffsets[h],e-2),e),k=f.length,g;(g=f.charCodeAt(k-1))===10||g===13;)k--;return e-(f.length-k)}else return this.getCharCount()},getLineStart:function(h){return!(0<=h&&h<this.getLineCount())?-1:this._lineOffsets[h]},getText:function(h,a){h===void 0&&(h=0);a===void 0&&(a=this.getCharCount());if(h===a)return"";for(var e=0,f=0,k;f<this._text.length;){k=
this._text[f].length;if(h<=e+k)break;e+=k;f++}for(var g=e,c=f;f<this._text.length;){k=this._text[f].length;if(a<=e+k)break;e+=k;f++}if(c===f)return this._text[c].substring(h-g,a-e);g=this._text[c].substring(h-g);e=this._text[f].substring(0,a-e);return g+this._text.slice(c+1,f).join("")+e},onChanging:function(h){return this.dispatchEvent(h)},onChanged:function(h){return this.dispatchEvent(h)},setLineDelimiter:function(h,a){h==="auto"&&(h=void 0,this.getLineCount()>1&&(h=this.getText(this.getLineEnd(0),
this.getLineEnd(0,!0))));this._lineDelimiter=h?h:t.platformDelimiter;if(a){var e=this.getLineCount();if(e>1){for(var f=Array(e),k=0;k<e;k++)f[k]=this.getLine(k);this.setText(f.join(this._lineDelimiter))}}},setText:function(h,a,e){h===void 0&&(h="");a===void 0&&(a=0);e===void 0&&(e=this.getCharCount());if(!(a===e&&h==="")){for(var f=this.getLineAtOffset(a),k=this.getLineAtOffset(e),g=a,c=e-a,i=k-f,q=h.length,l=0,o=this.getLineCount(),s=0,u=0,m=0,b=[];;){s!==-1&&s<=m&&(s=h.indexOf("\r",m));u!==-1&&
u<=m&&(u=h.indexOf("\n",m));if(u===-1&&s===-1)break;m=s!==-1&&u!==-1?s+1===u?u+1:(s<u?s:u)+1:s!==-1?s+1:u+1;b.push(a+m);l++}this.onChanging({type:"Changing",text:h,start:g,removedCharCount:c,addedCharCount:q,removedLineCount:i,addedLineCount:l});b.length===0&&(s=this.getLineStart(f),k=k+1<o?this.getLineStart(k+1):this.getCharCount(),a!==s&&(h=this.getText(s,a)+h,a=s),e!==k&&(h+=this.getText(e,k),e=k));k=q-c;for(s=f+i+1;s<o;s++)this._lineOffsets[s]+=k;f=[f+1,i].concat(b);Array.prototype.splice.apply(this._lineOffsets,
f);for(k=b=0;k<this._text.length;){s=this._text[k].length;if(a<=b+s)break;b+=s;k++}o=b;for(f=k;k<this._text.length;){s=this._text[k].length;if(e<=b+s)break;b+=s;k++}s=this._text[k];a=this._text[f].substring(0,a-o);e=s.substring(e-b);f=[f,k-f+1];a&&f.push(a);h&&f.push(h);e&&f.push(e);Array.prototype.splice.apply(this._text,f);if(this._text.length===0)this._text=[""];this.onChanged({type:"Changed",start:g,removedCharCount:c,addedCharCount:q,removedLineCount:i,addedLineCount:l})}}};p.EventTarget.addMixin(m.prototype);
return{TextModel:m}});
define("orion/keyBinding",["orion/util"],function(p){function t(m,h,a,e,f){this.keyCode=typeof m==="string"?m.toUpperCase().charCodeAt(0):m;this.mod1=h!==void 0&&h!==null?h:!1;this.mod2=a!==void 0&&a!==null?a:!1;this.mod3=e!==void 0&&e!==null?e:!1;this.mod4=f!==void 0&&f!==null?f:!1}t.prototype={match:function(m){return this.keyCode===m.keyCode?this.mod1!==(p.isMac?m.metaKey:m.ctrlKey)?!1:this.mod2!==m.shiftKey?!1:this.mod3!==m.altKey?!1:p.isMac&&this.mod4!==m.ctrlKey?!1:!0:!1},equals:function(m){return!m?
!1:this.keyCode!==m.keyCode?!1:this.mod1!==m.mod1?!1:this.mod2!==m.mod2?!1:this.mod3!==m.mod3?!1:this.mod4!==m.mod4?!1:!0}};return{KeyBinding:t}});
define("orion/editor/textTheme",["require","orion/editor/eventTarget","orion/util"],function(p,t,m){function h(a){a=a||{};this._document=a.document||document}var a={};h.getTheme=function(e){var e=e||"default",f=a[e];f||(f=a[e]=new h);return f};h.prototype={getThemeClass:function(){return this._themeClass},setThemeClass:function(a,f){var h=this,g=h._themeClass;h._themeClass=a;this._load(a,f,function(){h.onThemeChanged({type:"ThemeChanged",oldValue:g,newValue:h.getThemeClass()})})},onThemeChanged:function(a){return this.dispatchEvent(a)},
buildStyleSheet:function(a,f){function h(c,f,l){g.push("."+a+" ."+c+" {");g.push("\t"+(l?"background-color":"color")+": "+f+";");g.push("}")}var g=[];g.push("");var c=f.fontFamily,c=c==="sans serif"?'"Menlo", "Consolas", "Vera Mono", "monospace"':"monospace";g.push("."+a+" {");g.push("\tfont-family: "+c+";");g.push("\tfont-size: "+f.fontSize+";");g.push("\tcolor: "+f.text+";");g.push("}");g.push("."+a+".textview {");g.push("\tbackground-color: "+f.background+";");g.push("}");h("ruler.annotations",
f.annotationRuler,!0);h("ruler.lines",f.annotationRuler,!0);h("ruler.folding",f.annotationRuler,!0);h("ruler.overview",f.overviewRuler,!0);h("rulerLines",f.lineNumber,!1);h("rulerLines.even",f.lineNumberEven,!1);h("rulerLines.odd",f.lineNumberOdd,!1);h("annotationLine.currentLine",f.currentLine,!0);h("entity-name-tag",f.keyword,!1);h("entity-other-attribute-name",f.attribute,!1);h("string-quoted",f.string,!1);h("line_caret",f.currentLine,!0);h("token_keyword",f.keyword,!1);h("token_string",f.string,
!1);h("token_singleline_comment",f.comment,!1);h("token_multiline_comment",f.comment,!1);h("token_doc_comment",f.comment,!1);h("token_doc_html_markup",f.comment,!1);return g.join("\n")},_createStyle:function(a,f,h,g){var c=this._document,a="orion-theme-"+a,i=c.getElementById(a);if(i){if(g||i.firstChild.data===f)return;i.removeChild(i.firstChild);i.appendChild(c.createTextNode(f))}else g?(i=m.createElement(c,"link"),i.rel="stylesheet",i.type="text/css",i.href=f,i.addEventListener("load",function(){h()})):
(i=m.createElement(c,"style"),i.appendChild(c.createTextNode(f))),i.id=a,(c.getElementsByTagName("head")[0]||c.documentElement).appendChild(i);g||h()},_load:function(a,f,h){if(a)if(typeof f==="string")this._createStyle(a,f,h);else if(f=f.href,f.substring(f.length-4)!==".css"&&(f+=".css"),/^\//.test(f)||/[a-zA-Z0-9]+:\/\//i.test(f)||!p.toUrl)this._createStyle(a,f,h,!0);else{var g=this;p(["text!"+f],function(c){g._createStyle(a,c,h,!1)})}else h()}};t.EventTarget.addMixin(h.prototype);return{TextTheme:h}});
define("orion/editor/textView",["orion/editor/textModel","orion/keyBinding","orion/editor/eventTarget","orion/editor/textTheme","orion/util"],function(p,t,m,h,a){function e(b,d,j,r){typeof b.addEventListener==="function"?b.addEventListener(d,j,r===!0):b.attachEvent("on"+d,j)}function f(b,d,j){if(j){d.className="";for(var j=d.attributes,r=j.length;r-- >0;)(!a.isIE||a.isIE>=9||a.isIE<9&&j[r].specified)&&d.removeAttribute(j[r].name)}if(b){if(b.styleClass)d.className=b.styleClass;if(j=b.style)for(var c in j)j.hasOwnProperty(c)&&
(d.style[c]=j[c]);if(b=b.attributes)for(var n in b)b.hasOwnProperty(n)&&d.setAttribute(n,b[n])}}function k(b){return b instanceof Array?b.slice(0):b}function g(b,d){if(b===d)return!0;if(b&&!d||!b&&d)return!1;if(b&&b.constructor===String||d&&d.constructor===String)return!1;if(b instanceof Array||d instanceof Array){if(!(b instanceof Array&&d instanceof Array))return!1;if(b.length!==d.length)return!1;for(var j=0;j<b.length;j++)if(!g(b[j],d[j]))return!1;return!0}if(!(b instanceof Object)||!(d instanceof
Object))return!1;for(j in b)if(b.hasOwnProperty(j)){if(!d.hasOwnProperty(j))return!1;if(!g(b[j],d[j]))return!1}for(j in d)if(!b.hasOwnProperty(j))return!1;return!0}function c(b,d,j){for(var r=0,a=0,n=0,c=b.length;n<c;){r!==-1&&r<=n&&(r=b.indexOf("\r",n));a!==-1&&a<=n&&(a=b.indexOf("\n",n));var g=n,i;if(a===-1&&r===-1){d(b.substring(n));break}r!==-1&&a!==-1?r+1===a?(i=r,n=a+1):(i=r<a?r:a,n=(r<a?r:a)+1):r!==-1?(i=r,n=r+1):(i=a,n=a+1);d(b.substring(g,i));j()}}function i(b){var d,j,r,a,n=b.ownerDocument.defaultView||
b.ownerDocument.parentWindow;if(n.getComputedStyle)b=n.getComputedStyle(b,null),d=b.getPropertyValue("padding-left"),j=b.getPropertyValue("padding-top"),r=b.getPropertyValue("padding-right"),a=b.getPropertyValue("padding-bottom");else if(b.currentStyle)d=b.currentStyle.paddingLeft,j=b.currentStyle.paddingTop,r=b.currentStyle.paddingRight,a=b.currentStyle.paddingBottom;return{left:parseInt(d,10)||0,top:parseInt(j,10)||0,right:parseInt(r,10)||0,bottom:parseInt(a,10)||0}}function q(b){var d,j,r,a,n=
b._trim;if(!n){var n=i(b),c=b.ownerDocument.defaultView||b.ownerDocument.parentWindow;if(c.getComputedStyle)a=c.getComputedStyle(b,null),d=a.getPropertyValue("border-left-width"),j=a.getPropertyValue("border-top-width"),r=a.getPropertyValue("border-right-width"),a=a.getPropertyValue("border-bottom-width");else if(b.currentStyle)d=b.currentStyle.borderLeftWidth,j=b.currentStyle.borderTopWidth,r=b.currentStyle.borderRightWidth,a=b.currentStyle.borderBottomWidth;d=parseInt(d,10)||0;j=parseInt(j,10)||
0;r=parseInt(r,10)||0;a=parseInt(a,10)||0;n.left+=d;n.top+=j;n.right+=r;n.bottom+=a;b._trim=n}return n}function l(b,d,j){this.start=b;this.end=d;this.caret=j}function o(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom}function s(b,d,j){this.view=b;this.lineIndex=d;this._lineDiv=j}function u(b){this._init(b||{})}var v=function(){function b(b){this.options=b}b.prototype.play=function(){var b=typeof this.options.duration==="number"?this.options.duration:350,j=this.options.easing||
this.defaultEasing,r=this.options.onAnimate||function(){},a=this.options.curve[0],n=this.options.curve[1],c=n-a,g=-1,i,f=this;this.interval=this.options.window.setInterval(function(){g=g===-1?(new Date).getTime():g;var e=((new Date).getTime()-g)/b;e<1?(e=j(e),i=a+e*c,r(i)):(r(n),f.stop())},typeof this.options.rate==="number"?this.options.rate:20)};b.prototype.stop=function(){this.options.window.clearInterval(this.interval);(this.options.onEnd||function(){})()};b.prototype.defaultEasing=function(b){return Math.sin(b*
(Math.PI/2))};return b}();l.prototype={clone:function(){return new l(this.start,this.end,this.caret)},collapse:function(){this.caret?this.end=this.start:this.start=this.end},extend:function(b){this.caret?this.start=b:this.end=b;if(this.start>this.end)b=this.start,this.start=this.end,this.end=b,this.caret=!this.caret},setCaret:function(b){this.end=this.start=b;this.caret=!1},getCaret:function(){return this.caret?this.start:this.end},toString:function(){return"start="+this.start+" end="+this.end+(this.caret?
" caret is at start":" caret is at end")},isEmpty:function(){return this.start===this.end},equals:function(b){return this.caret===b.caret&&this.start===b.start&&this.end===b.end}};o.prototype={toString:function(){return"{l="+this.left+", t="+this.top+", r="+this.right+", b="+this.bottom+"}"}};s.prototype={create:function(b,d){if(!this._lineDiv){var j=this._lineDiv=this._createLine(b,d,this.lineIndex);j._line=this;return j}},_createLine:function(b,d,j){var r=this.view,c=r._model,n=c.getLine(j),i=c.getLineStart(j),
e={type:"LineStyle",textView:r,lineIndex:j,lineText:n,lineStart:i};if(n.length<2E3)r.onLineStyle(e);c=d||a.createElement(b.ownerDocument,"div");if(!d||!g(d.viewStyle,e.style)){f(e.style,c,d);if(d)d._trim=null;c.viewStyle=e.style;c.setAttribute("role","presentation")}c.lineIndex=j;j=[];this._createRanges(e.ranges,n,0,n.length,i,{tabOffset:0,ranges:j});n=" ";!r._fullSelection&&a.isIE<9&&(n="\ufeff");a.isWebkit&&(n="\u200c");j.push({text:n,style:r._metrics.largestFontStyle,ignoreChars:1});var l,q,h,
o,s,n=r=0,k,u;if(d){if(q=d.modelChangedEvent)q.removedLineCount===0&&q.addedLineCount===0?(u=q.start-i,k=q.addedCharCount-q.removedCharCount):u=-1,d.modelChangedEvent=void 0;q=d.firstChild}for(i=0;i<j.length;i++){l=j[i];o=l.text;r+=o.length;e=l.style;if(q)if(s=q.firstChild.data,h=q.viewStyle,s===o&&g(e,h)){n+=s.length;q._rectsCache=void 0;l=q=q.nextSibling;continue}else for(;q;){if(u!==-1){h=r;h>=u&&(h-=k);s=(s=q.firstChild.data)?s.length:0;if(n+s>h)break;n+=s}h=q.nextSibling;c.removeChild(q);q=h}l=
this._createSpan(c,o,e,l.ignoreChars);q?c.insertBefore(l,q):c.appendChild(l);if(d)d.lineWidth=void 0}if(d)for(b=l?l.nextSibling:null;b;)h=b.nextSibling,d.removeChild(b),b=h;else b.appendChild(c);return c},_createRanges:function(b,d,j,r,a,n){if(!(j>=r)){if(b)for(var c=0;c<b.length;c++){var i=b[c];if(!(i.end<=a+j)){var f=Math.max(a+j,i.start)-a;if(f>=r)break;var e=Math.min(a+r,i.end)-a;if(f<e){f=Math.max(j,f);e=Math.min(r,e);for(j<f&&this._createRange(d,j,f,null,n);c+1<b.length&&b[c+1].start-a===e&&
g(i.style,b[c+1].style);)i=b[c+1],e=Math.min(a+r,i.end)-a,c++;this._createRange(d,f,e,i.style,n);j=e}}}j<r&&this._createRange(d,j,r,null,n)}},_createRange:function(b,d,j,r,a){if(!(d>=j)){var n=this.view._customTabSize;if(n&&n!==8)for(var c=b.indexOf("\t",d);c!==-1&&c<j;){d<c&&(d={text:b.substring(d,c),style:r},a.ranges.push(d),a.tabOffset+=d.text.length);d=n-a.tabOffset%n;if(d>0){for(var i="\u00a0",g=1;g<d;g++)i+=" ";d={text:i,style:r,ignoreChars:d-1};a.ranges.push(d);a.tabOffset+=d.text.length}d=
c+1;c=b.indexOf("\t",d)}d<j&&(d={text:b.substring(d,j),style:r},a.ranges.push(d),a.tabOffset+=d.text.length)}},_createSpan:function(b,d,j,r){var c=j&&j.tagName==="A";if(c)b.hasLink=!0;var c=c&&this.view._linksVisible?"a":"span",n=b.ownerDocument,b=a.createElement(b.ownerDocument,c);b.appendChild(n.createTextNode(d));f(j,b);if(c==="A"){var i=this.view,g=this._getWindow();e(b,"click",function(b){return i._handleLinkClick(b?b:g.event)},!1)}b.viewStyle=j;if(r)b.ignoreChars=r;return b},_ensureCreated:function(){return this._lineDiv?
this._lineDiv:this._createdDiv=this.create(this.view._clientDiv,null)},getBoundingClientRect:function(b,d){var j=this._ensureCreated(),r=this.view;if(b===void 0)return this._getLineBoundingClientRect(j,!0);var c=r._model,n=j.ownerDocument,i=this.lineIndex,g=null;if(b<c.getLineEnd(i)){c=c.getLineStart(i);for(i=j.firstChild;i;){var f=i.firstChild,e=f.length;i.ignoreChars&&(e-=i.ignoreChars);if(c+e>b){g=b-c;if(r._isRangeRects)n=n.createRange(),n.setStart(f,g),n.setEnd(f,g+1),g=new o(n.getBoundingClientRect());
else if(a.isIE)n=n.body.createTextRange(),n.moveToElementText(i),n.collapse(),n.moveEnd("character",g+1),n.moveStart("character",g),g=new o(n.getBoundingClientRect());else{var q=f.data;i.removeChild(f);i.appendChild(n.createTextNode(q.substring(0,g)));var l=a.createElement(n,"span");l.appendChild(n.createTextNode(q.substring(g,g+1)));i.appendChild(l);i.appendChild(n.createTextNode(q.substring(g+1)));g=new o(l.getBoundingClientRect());i.innerHTML="";i.appendChild(f);this._createdDiv||(n=r._getSelection(),
(c<=n.start&&n.start<c+e||c<=n.end&&n.end<c+e)&&r._updateDOMSelection())}a.isIE&&(n=j.ownerDocument.defaultView||j.ownerDocument.parentWindow,j=n.screen.logicalXDPI/n.screen.deviceXDPI,n=n.screen.logicalYDPI/n.screen.deviceYDPI,g.left*=j,g.right*=j,g.top*=n,g.bottom*=n);break}c+=e;i=i.nextSibling}}j=this.getBoundingClientRect();if(!g)r._wrapMode?(r=this.getClientRects(),g=r[r.length-1],g.left=g.right,g.left+=j.left,g.top+=j.top,g.right+=j.left,g.bottom+=j.top):(g=new o(j),g.left=g.right);if(d||d===
void 0)g.left-=j.left,g.top-=j.top,g.right-=j.left,g.bottom-=j.top;return g},_getClientRects:function(b,d){var j,r,a,n;if(!b._rectsCache){j=b.getClientRects();r=Array(j.length);for(n=0;n<j.length;n++)a=r[n]=new o(j[n]),a.left-=d.left,a.top-=d.top,a.right-=d.left,a.bottom-=d.top;b._rectsCache=r}j=b._rectsCache;r=[j.length];for(n=0;n<j.length;n++)r[n]=new o(j[n]);return r},getClientRects:function(b){if(!this.view._wrapMode)return[this.getBoundingClientRect()];for(var d=this._ensureCreated(),j=[],r=
d.firstChild,a,n=d.getBoundingClientRect();r;){for(var c=this._getClientRects(r,n),d=0;d<c.length;d++){var g=c[d],i;if(g.top!==g.bottom){var f=g.top+(g.bottom-g.top)/2;for(i=0;i<j.length;i++)if(a=j[i],a.top<=f&&f<a.bottom)break;if(i===j.length)j.push(g);else{if(g.left<a.left)a.left=g.left;if(g.top<a.top)a.top=g.top;if(g.right>a.right)a.right=g.right;if(g.bottom>a.bottom)a.bottom=g.bottom}}}r=r.nextSibling}return b!==void 0?j[b]:j},_getLineBoundingClientRect:function(b,d){var j=new o(b.getBoundingClientRect());
if(!this.view._wrapMode){j.right=j.left;for(var r=b.lastChild;r&&r.ignoreChars===r.firstChild.length;)r=r.previousSibling;if(r)r=r.getBoundingClientRect(),j.right=r.right+q(b).right}d&&(r=q(b),j.left+=r.left,j.right-=r.right);return j},getLineCount:function(){return!this.view._wrapMode?1:this.getClientRects().length},getLineIndex:function(b){if(!this.view._wrapMode)return 0;for(var d=this.getClientRects(),b=this.getBoundingClientRect(b),b=b.top+(b.bottom-b.top)/2,j=0;j<d.length;j++)if(d[j].top<=b&&
b<d[j].bottom)return j;return d.length-1},getLineStart:function(b){if(!this.view._wrapMode||b===0)return this.view._model.getLineStart(b);var d=this.getClientRects();return this.getOffset(d[b].left+1,d[b].top+1)},getOffset:function(b,d){var j=this.view,r=j._model,c=this.lineIndex,n=r.getLineStart(c),r=r.getLineEnd(c);if(n===r)return n;var g=this._ensureCreated(),c=this.getBoundingClientRect(),i,f;if(j._wrapMode){i=this.getClientRects();if(d<i[0].top)d=i[0].top;for(var e=0;e<i.length;e++)if(f=i[e],
f.top<=d&&d<f.bottom)break;if(b<f.left)b=f.left;b>f.right&&(b=f.right-1)}else b<0&&(b=0),b>c.right-c.left&&(b=c.right-c.left);var q=g.ownerDocument,e=q.defaultView||q.parentWindow,l=a.isIE?e.screen.logicalXDPI/e.screen.deviceXDPI:1,h=a.isIE?e.screen.logicalYDPI/e.screen.deviceYDPI:1,e=n,o=g.firstChild;a:for(;o;){var s=o.firstChild,g=s.length;o.ignoreChars&&(g-=o.ignoreChars);var k,u,m;i=this._getClientRects(o,c);for(var v=0;v<i.length;v++)if(f=i[v],f.left<=b&&b<f.right&&(!j._wrapMode||f.top<=d&&d<
f.bottom)){if(a.isIE||j._isRangeRects){for(var q=j._isRangeRects?q.createRange():q.body.createTextRange(),v=g,p=-1;v-p>1;){var t=Math.floor((v+p)/2);f=p+1;i=t===g-1&&o.ignoreChars?s.length:t+1;j._isRangeRects?(q.setStart(s,f),q.setEnd(s,i)):(q.moveToElementText(o),q.move("character",f),q.moveEnd("character",i-f));i=q.getClientRects();for(var F=!1,B=0;B<i.length;B++)if(f=i[B],k=f.left*l-c.left,m=f.right*l-c.left,u=f.top*h-c.top,f=f.bottom*h-c.top,k<=b&&b<m&&(!j._wrapMode||u<=d&&d<f)){F=!0;break}F?
v=t:p=t}e+=v;f=v;i=v===g-1&&o.ignoreChars?s.length:Math.min(v+1,s.length);j._isRangeRects?(q.setStart(s,f),q.setEnd(s,i)):(q.moveToElementText(o),q.move("character",f),q.moveEnd("character",i-f));f=q.getClientRects()[0];k=f.left*l-c.left;m=f.right*l-c.left;b>k+(m-k)/2&&e++}else{f=[];for(l=0;l<g;l++)f.push("<span>"),l===g-1?f.push(s.data.substring(l)):f.push(s.data.substring(l,l+1)),f.push("</span>");o.innerHTML=f.join("");for(l=o.firstChild;l;){f=l.getBoundingClientRect();k=f.left-c.left;m=f.right-
c.left;if(k<=b&&b<m){b>k+(m-k)/2&&e++;break}e++;l=l.nextSibling}if(!this._createdDiv)o.innerHTML="",o.appendChild(s),c=j._getSelection(),(e<=c.start&&c.start<e+g||e<=c.end&&c.end<e+g)&&j._updateDOMSelection()}break a}e+=g;o=o.nextSibling}return Math.min(r,Math.max(n,e))},getNextOffset:function(b,d,j){return d==="line"?(d=this.view._model,b=d.getLineAtOffset(b),j>0?d.getLineEnd(b):d.getLineStart(b)):d==="wordend"?this._getNextOffset_W3C(b,d,j):a.isIE?this._getNextOffset_IE(b,d,j):this._getNextOffset_W3C(b,
d,j)},_getNextOffset_W3C:function(b,d,j){function r(b){return 33<=b&&b<=47||58<=b&&b<=64||91<=b&&b<=94||b===96||123<=b&&b<=126}if(d==="word"||d==="wordend"){var a=this.view._model,n=a.getLineAtOffset(b),c=a.getLine(n),g=a.getLineStart(n),n=a.getLineEnd(n),a=c.length;b-=g;var i,f;if(j>0){if(b===a)return n;i=c.charCodeAt(b);f=r(i);j=!f&&!(i===32||i===9);for(b++;b<a;){i=c.charCodeAt(b);n=r(i);if(d==="wordend"){if(!n&&f)break}else if(n&&!f)break;i=!n&&!(i===32||i===9);if(d==="wordend"){if(!i&&j)break}else if(i&&
!j)break;j=i;f=n;b++}}else{if(b===0)return g;b--;i=c.charCodeAt(b);f=r(i);for(j=!f&&!(i===32||i===9);0<b;){i=c.charCodeAt(b-1);n=r(i);if(d==="wordend"){if(n&&!f)break}else if(!n&&f)break;i=!n&&!(i===32||i===9);if(d==="wordend"){if(i&&!j)break}else if(!i&&j)break;j=i;f=n;b--}}return g+b}return b+j},_getNextOffset_IE:function(b,d,j){var a=this._ensureCreated(),c=this.view._model,n=this.lineIndex,i=0,g;g=c.getLineStart(n);var f=a.ownerDocument;if(b===c.getLineEnd(n)){for(a=a.lastChild;a&&a.ignoreChars;)a=
a.previousSibling;if(!a)return g;i=f.body.createTextRange();i.moveToElementText(a);g=i.text.length;i.moveEnd(d,j);i=b+i.text.length-g}else if(b===g&&j<0)i=g;else for(a=a.firstChild;a;){c=a.firstChild.length;a.ignoreChars&&(c-=a.ignoreChars);if(g+c>b){i=f.body.createTextRange();b===g&&j<0?i.moveToElementText(a.previousSibling):(i.moveToElementText(a),i.collapse(),i.moveEnd("character",b-g));g=i.text.length;i.moveEnd(d,j);i=b+i.text.length-g;break}g=c+g;a=a.nextSibling}return i},destroy:function(){var b=
this._createdDiv;if(b)b.parentNode.removeChild(b),this._createdDiv=null}};u.prototype={addRuler:function(b,d){b.setView(this);var j=this._rulers;if(d!==void 0){var a,c;for(a=0,c=0;a<j.length&&c<d;a++)b.getLocation()===j[a].getLocation()&&c++;j.splice(c,0,b);d=c}else j.push(b);this._createRuler(b,d);this._update()},computeSize:function(){var b=0,d=0,j=this._model,c=this._clientDiv;if(!c)return{width:b,height:d};var i=c.style.width;if(a.isWebkit)c.style.width="0x7fffffffpx";for(var j=j.getLineCount(),
n=0;n<j;n++){var g=this._getLine(n),f=g.getBoundingClientRect(),b=Math.max(b,f.right-f.left);d+=f.bottom-f.top;g.destroy()}if(a.isWebkit)c.style.width=i;c=this._getViewPadding();b+=c.right+c.left+this._metrics.scrollWidth;d+=c.bottom+c.top+this._metrics.scrollWidth;return{width:b,height:d}},convert:function(b,d,j){if(this._clientDiv){var a=this._getScroll(),c=this._getViewPadding(),n=this._viewDiv.getBoundingClientRect();d==="document"&&(b.x!==void 0&&(b.x+=-a.x+n.left+c.left),b.y!==void 0&&(b.y+=
-a.y+n.top+c.top));j==="document"&&(b.x!==void 0&&(b.x+=a.x-n.left-c.left),b.y!==void 0&&(b.y+=a.y-n.top-c.top));return b}},destroy:function(){for(var b=0;b<this._rulers.length;b++)this._rulers[b].setView(null);this.rulers=null;this._destroyView();this.onDestroy({type:"Destroy"});this._actions=this._keyBindings=this._doubleClickSelection=this._selection=this._theme=this._model=this._parent=null},focus:function(){this._clientDiv&&(this._updateDOMSelection(),a.isOpera&&this._clientDiv.blur(),this._clientDiv.focus(),
this._updateDOMSelection())},hasFocus:function(){return this._hasFocus},getActionDescription:function(b){if(b=this._actions[b])return b.actionDescription},getActions:function(b){var d=[],j=this._actions,a;for(a in j)j.hasOwnProperty(a)&&(b||!j[a].defaultHandler)&&d.push(a);return d},getBottomIndex:function(b){return!this._clientDiv?0:this._getBottomIndex(b)},getBottomPixel:function(){return!this._clientDiv?0:this._getScroll().y+this._getClientHeight()},getCaretOffset:function(){return this._getSelection().getCaret()},
getClientArea:function(){if(!this._clientDiv)return{x:0,y:0,width:0,height:0};var b=this._getScroll();return{x:b.x,y:b.y,width:this._getClientWidth(),height:this._getClientHeight()}},getHorizontalPixel:function(){return!this._clientDiv?0:this._getScroll().x},getKeyBindings:function(b){for(var d=[],j=this._keyBindings,a=0;a<j.length;a++)j[a].actionID===b&&d.push(j[a].keyBinding);return d},getLineHeight:function(b){return!this._clientDiv?0:this._getLineHeight(b)},getLineIndex:function(b){return!this._clientDiv?
0:this._getLineIndex(b)},getLinePixel:function(b){return!this._clientDiv?0:this._getLinePixel(b)},getLocationAtOffset:function(b){if(!this._clientDiv)return{x:0,y:0};var d=this._model,b=Math.min(Math.max(0,b),d.getCharCount()),d=d.getLineAtOffset(b),j=this._getLine(d),b=j.getBoundingClientRect(b);j.destroy();j=b.left;d=this._getLinePixel(d)+b.top;return{x:j,y:d}},getOptions:function(){var b;if(arguments.length===0)b=this._defaultOptions();else if(arguments.length===1){if(b=arguments[0],typeof b===
"string")return k(this["_"+b])}else{b={};for(var d in arguments)arguments.hasOwnProperty(d)&&(b[arguments[d]]=void 0)}for(var j in b)b.hasOwnProperty(j)&&(b[j]=k(this["_"+j]));return b},getModel:function(){return this._model},getOffsetAtLocation:function(b,d){if(!this._clientDiv)return 0;var j=this._getLineIndex(d),a=this._getLine(j),j=a.getOffset(b,d-this._getLinePixel(j));a.destroy();return j},getRulers:function(){return this._rulers.slice(0)},getSelection:function(){var b=this._getSelection();
return{start:b.start,end:b.end}},getText:function(b,d){return this._model.getText(b,d)},getTopIndex:function(b){return!this._clientDiv?0:this._getTopIndex(b)},getTopPixel:function(){return!this._clientDiv?0:this._getScroll().y},invokeAction:function(b,d){if(this._clientDiv){var j=this._actions[b];if(j){if(!d&&j.handler&&j.handler())return;if(j.defaultHandler)return j.defaultHandler()}return!1}},isDestroyed:function(){return!this._clientDiv},onContextMenu:function(b){return this.dispatchEvent(b)},
onDragStart:function(b){return this.dispatchEvent(b)},onDrag:function(b){return this.dispatchEvent(b)},onDragEnd:function(b){return this.dispatchEvent(b)},onDragEnter:function(b){return this.dispatchEvent(b)},onDragOver:function(b){return this.dispatchEvent(b)},onDragLeave:function(b){return this.dispatchEvent(b)},onDrop:function(b){return this.dispatchEvent(b)},onDestroy:function(b){return this.dispatchEvent(b)},onLineStyle:function(b){return this.dispatchEvent(b)},onKeyDown:function(b){return this.dispatchEvent(b)},
onKeyPress:function(b){return this.dispatchEvent(b)},onKeyUp:function(b){return this.dispatchEvent(b)},onModelChanged:function(b){return this.dispatchEvent(b)},onModelChanging:function(b){return this.dispatchEvent(b)},onModify:function(b){return this.dispatchEvent(b)},onMouseDown:function(b){return this.dispatchEvent(b)},onMouseUp:function(b){return this.dispatchEvent(b)},onMouseMove:function(b){return this.dispatchEvent(b)},onMouseOver:function(b){return this.dispatchEvent(b)},onMouseOut:function(b){return this.dispatchEvent(b)},
onSelection:function(b){return this.dispatchEvent(b)},onScroll:function(b){return this.dispatchEvent(b)},onVerify:function(b){return this.dispatchEvent(b)},onFocus:function(b){return this.dispatchEvent(b)},onBlur:function(b){return this.dispatchEvent(b)},redraw:function(){if(!(this._redrawCount>0)){var b=this._model.getLineCount();this.redrawRulers(0,b);this.redrawLines(0,b)}},redrawRulers:function(b,d){if(!(this._redrawCount>0))for(var j=this.getRulers(),a=0;a<j.length;a++)this.redrawLines(b,d,j[a])},
redrawLines:function(b,d,j){if(!(this._redrawCount>0)&&(b===void 0&&(b=0),d===void 0&&(d=this._model.getLineCount()),b!==d)){var a=this._clientDiv;if(a){if(j)for(a=(j.getLocation()==="left"?this._leftDiv:this._rightDiv).firstChild;a;){if(a._ruler===j)break;a=a.nextSibling}j?a.rulerChanged=!0:this._lineHeight&&this._resetLineHeight(b,d);if(!j||j.getOverview()==="page")for(a=a.firstChild;a;){var c=a.lineIndex;if(b<=c&&c<d)a.lineChanged=!0;a=a.nextSibling}if(!j&&!this._wrapMode&&b<=this._maxLineIndex&&
this._maxLineIndex<d)this._checkMaxLineIndex=this._maxLineIndex,this._maxLineIndex=-1,this._maxLineWidth=0;this._queueUpdate()}}},redrawRange:function(b,d){if(!(this._redrawCount>0)){var j=this._model;b===void 0&&(b=0);d===void 0&&(d=j.getCharCount());var a=j.getLineAtOffset(b),j=j.getLineAtOffset(Math.max(b,d-1))+1;this.redrawLines(a,j)}},removeRuler:function(b){for(var d=this._rulers,j=0;j<d.length;j++)if(d[j]===b){d.splice(j,1);b.setView(null);this._destroyRuler(b);this._update();break}},resize:function(){this._clientDiv&&
this._handleResize(null)},setAction:function(b,d,j){if(b){var a=this._actions,c=a[b];c||(c=a[b]={});c.handler=d;c.actionDescription=j}},setKeyBinding:function(b,d){for(var j=this._keyBindings,a=0;a<j.length;a++){var c=j[a];if(c.keyBinding.equals(b)){d?c.actionID=d:c.predefined?c.actionID=null:j.splice(a,1);return}}d&&j.push({keyBinding:b,actionID:d})},setCaretOffset:function(b,d,j){var a=this._model.getCharCount(),b=Math.max(0,Math.min(b,a));this._setSelection(new l(b,b,!1),d===void 0||d,!0,j)},setHorizontalPixel:function(b){this._clientDiv&&
(b=Math.max(0,b),this._scrollView(b-this._getScroll().x,0))},setRedraw:function(b){b?--this._redrawCount===0&&this.redraw():this._redrawCount++},setModel:function(b){if(b&&b!==this._model){this._model.removeEventListener("preChanging",this._modelListener.onChanging);this._model.removeEventListener("postChanged",this._modelListener.onChanged);var d=this._model.getLineCount(),j=this._model.getCharCount(),a=b.getLineCount(),c=b.getCharCount(),n={type:"ModelChanging",text:b.getText(),start:0,removedCharCount:j,
addedCharCount:c,removedLineCount:d,addedLineCount:a};this.onModelChanging(n);this._model=b;n={type:"ModelChanged",start:0,removedCharCount:j,addedCharCount:c,removedLineCount:d,addedLineCount:a};this.onModelChanged(n);this._model.addEventListener("preChanging",this._modelListener.onChanging);this._model.addEventListener("postChanged",this._modelListener.onChanged);this._reset();this._update()}},setOptions:function(b){var d=this._defaultOptions(),j;for(j in b)if(b.hasOwnProperty(j)){var a=b[j];if(!g(this["_"+
j],a)){var c=d[j]?d[j].update:null;c?c.call(this,a):this["_"+j]=k(a)}}},setSelection:function(b,d,j,a){var c=b>d;if(c)var n=b,b=d,d=n;n=this._model.getCharCount();b=Math.max(0,Math.min(b,n));d=Math.max(0,Math.min(d,n));this._setSelection(new l(b,d,c),j===void 0||j,!0,a)},setText:function(b,d,j){var c=d===void 0&&j===void 0;d===void 0&&(d=0);j===void 0&&(j=this._model.getCharCount());this._modifyContent({text:b,start:d,end:j,_code:!0},!c);if(c)this._columnX=-1,this._setSelection(new l(0,0,!1),!0),
a.isFirefox&&this._fixCaret()},setTopIndex:function(b){this._clientDiv&&this._scrollView(0,this._getLinePixel(Math.max(0,b))-this._getScroll().y)},setTopPixel:function(b){this._clientDiv&&this._scrollView(0,Math.max(0,b)-this._getScroll().y)},showSelection:function(){return this._showCaret(!0)},update:function(b,d){this._clientDiv&&(b&&this._updateStyle(),d===void 0||d?this._update():this._queueUpdate())},_handleRootMouseDown:function(b){if(a.isFirefox&&b.which===1)this._clientDiv.contentEditable=
!1,this._ignoreBlur=(this._overlayDiv||this._clientDiv).draggable=!0;var d=this._overlayDiv||this._clientDiv;if(a.isIE<9)d=this._viewDiv;for(var j=b.target?b.target:b.srcElement;j;){if(d===j)return;j=j.parentNode}b.preventDefault&&b.preventDefault();b.stopPropagation&&b.stopPropagation();if(!this._isW3CEvents){var c=this;this._getWindow().setTimeout(function(){c._clientDiv.focus()},0)}},_handleRootMouseUp:function(b){if(a.isFirefox&&b.which===1)this._clientDiv.contentEditable=!0,(this._overlayDiv||
this._clientDiv).draggable=!1,this._fixCaret(),this._ignoreBlur=!1},_handleBlur:function(){if(!this._ignoreBlur){this._hasFocus=!1;if(a.isIE<9&&!this._getSelection().isEmpty()){var b=this._rootDiv,d=a.createElement(b.ownerDocument,"div");b.appendChild(d);b.removeChild(d)}if(this._selDiv1)if(this._selDiv1.style.background="lightgray",this._selDiv2.style.background="lightgray",this._selDiv3.style.background="lightgray",b=this._getWindow(),d=this._selDiv1.ownerDocument,b.getSelection){d=b.getSelection();
for(b=d.anchorNode;b;){if(b===this._clientDiv){d.rangeCount>0&&d.removeAllRanges();break}b=b.parentNode}}else if(d.selection){this._ignoreSelect=!1;for(b=d.selection.createRange().parentElement();b;){if(b===this._clientDiv){d.selection.empty();break}b=b.parentNode}this._ignoreSelect=!0}if(!this._ignoreFocus)this.onBlur({type:"Blur"})}},_handleContextMenu:function(b){a.isIE&&this._lastMouseButton===3&&this._updateDOMSelection();var d=!1;if(this.isListening("ContextMenu"))d=this._createMouseEvent("ContextMenu",
b),d.screenX=b.screenX,d.screenY=b.screenY,this.onContextMenu(d),d=d.defaultPrevented;if(d)return b.preventDefault&&b.preventDefault(),!1},_handleCopy:function(b){if(!this._ignoreCopy&&this._doCopy(b))return b.preventDefault&&b.preventDefault(),!1},_handleCut:function(b){if(this._doCut(b))return b.preventDefault&&b.preventDefault(),!1},_handleDataModified:function(){this._startIME()},_handleDblclick:function(b){this._lastMouseTime=b.timeStamp?b.timeStamp:(new Date).getTime();if(this._clickCount!==
2)this._clickCount=2,this._handleMouse(b)},_handleDragStart:function(b){if(a.isFirefox){var d=this;this._getWindow().setTimeout(function(){d._clientDiv.contentEditable=!0;d._clientDiv.draggable=!1;d._ignoreBlur=!1},0)}if(this.isListening("DragStart")&&this._dragOffset!==-1)this._isMouseDown=!1,this.onDragStart(this._createMouseEvent("DragStart",b)),this._dragOffset=-1;else return b.preventDefault&&b.preventDefault(),!1},_handleDrag:function(b){if(this.isListening("Drag"))this.onDrag(this._createMouseEvent("Drag",
b))},_handleDragEnd:function(b){this._dropTarget=!1;this._dragOffset=-1;if(this.isListening("DragEnd"))this.onDragEnd(this._createMouseEvent("DragEnd",b));a.isFirefox&&(this._fixCaret(),b.dataTransfer.dropEffect==="none"&&!b.dataTransfer.mozUserCancelled&&this._fixCaret())},_handleDragEnter:function(b){var d=!0;this._dropTarget=!0;this.isListening("DragEnter")&&(d=!1,this.onDragEnter(this._createMouseEvent("DragEnter",b)));if(a.isWebkit||d)return b.preventDefault&&b.preventDefault(),!1},_handleDragOver:function(b){var d=
!0;this.isListening("DragOver")&&(d=!1,this.onDragOver(this._createMouseEvent("DragOver",b)));if(a.isWebkit||d){if(d)b.dataTransfer.dropEffect="none";b.preventDefault&&b.preventDefault();return!1}},_handleDragLeave:function(b){this._dropTarget=!1;if(this.isListening("DragLeave"))this.onDragLeave(this._createMouseEvent("DragLeave",b))},_handleDrop:function(b){this._dropTarget=!1;if(this.isListening("Drop"))this.onDrop(this._createMouseEvent("Drop",b));b.preventDefault&&b.preventDefault();return!1},
_handleFocus:function(){this._hasFocus=!0;a.isIOS&&this._lastTouchOffset!==void 0?(this.setCaretOffset(this._lastTouchOffset,!0),this._lastTouchOffset=void 0):this._updateDOMSelection();if(this._selDiv1){var b=this._highlightRGB;this._selDiv1.style.background=b;this._selDiv2.style.background=b;this._selDiv3.style.background=b}if(!this._ignoreFocus)this.onFocus({type:"Focus"})},_handleKeyDown:function(b){if(this.isListening("KeyDown")){var d=this._createKeyEvent("KeyDown",b);this.onKeyDown(d);if(d.defaultPrevented){if(a.isFirefox)this._keyDownPrevented=
!0;b.preventDefault();return}}d=!1;switch(b.keyCode){case 16:case 17:case 18:case 91:d=!0;break;default:this._setLinksVisible(!1)}if(b.keyCode===229){if(this._readonly)return b.preventDefault&&b.preventDefault(),!1;d=!0;a.isSafari&&a.isMac&&b.ctrlKey&&(d=!1);d&&this._startIME()}else d||this._commitIME();if((a.isMac||a.isLinux)&&a.isFirefox<4||a.isOpera)return this._keyDownEvent=b,!0;if(this._doAction(b))return b.preventDefault?(b.preventDefault(),b.stopPropagation()):(b.cancelBubble=!0,b.returnValue=
!1,b.keyCode=0),!1},_handleKeyPress:function(b){if(this._keyDownPrevented)b.preventDefault&&(b.preventDefault(),b.stopPropagation()),this._keyDownPrevented=void 0;else{if(a.isMac&&a.isWebkit&&(63232<=b.keyCode&&b.keyCode<=63487||b.keyCode===13||b.keyCode===8))return b.preventDefault&&b.preventDefault(),!1;if(((a.isMac||a.isLinux)&&a.isFirefox<4||a.isOpera)&&this._doAction(this._keyDownEvent))return b.preventDefault&&b.preventDefault(),!1;var d=a.isMac?b.metaKey:b.ctrlKey;if(b.charCode!==void 0&&d)switch(b.charCode){case 99:case 118:case 120:return!0}if(this.isListening("KeyPress")&&
(d=this._createKeyEvent("KeyPress",b),this.onKeyPress(d),d.defaultPrevented)){b.preventDefault();return}d=!1;if(a.isMac){if(b.ctrlKey||b.metaKey)d=!0}else if(a.isFirefox){if(b.ctrlKey||b.altKey)d=!0}else b.ctrlKey^b.altKey&&(d=!0);if(!d&&(d=a.isOpera?b.which:b.charCode!==void 0?b.charCode:b.keyCode,d>31))return this._doContent(String.fromCharCode(d)),b.preventDefault&&b.preventDefault(),!1}},_handleKeyUp:function(b){if(this.isListening("KeyUp")){var d=this._createKeyEvent("KeyUp",b);this.onKeyUp(d);
if(d.defaultPrevented){b.preventDefault();return}}(a.isMac?b.metaKey:b.ctrlKey)||this._setLinksVisible(!1);b.keyCode===13&&this._commitIME()},_handleLinkClick:function(b){if(!(a.isMac?b.metaKey:b.ctrlKey))return b.preventDefault&&b.preventDefault(),!1},_handleMouse:function(b){var d=this._getWindow(),j=!0,c=d;if(a.isIE||a.isFirefox&&!this._overlayDiv)c=this._clientDiv;if(this._overlayDiv){if(this._hasFocus)this._ignoreFocus=!0;var i=this;d.setTimeout(function(){i.focus();i._ignoreFocus=!1},0)}this._clickCount===
1?(j=this._setSelectionTo(b.clientX,b.clientY,b.shiftKey,!a.isOpera&&this._hasFocus&&this.isListening("DragStart")))&&this._setGrab(c):(this._isW3CEvents&&this._setGrab(c),this._doubleClickSelection=null,this._setSelectionTo(b.clientX,b.clientY,b.shiftKey),this._doubleClickSelection=this._getSelection());return j},_handleMouseDown:function(b){if(this._linksVisible)if((b.target||b.srcElement).tagName!=="A")this._setLinksVisible(!1);else return;this._commitIME();var d=b.which;d||(b.button===4&&(d=2),
b.button===2&&(d=3),b.button===1&&(d=1));var j=d!==2&&b.timeStamp?b.timeStamp:(new Date).getTime(),c=j-this._lastMouseTime,i=Math.abs(this._lastMouseX-b.clientX),n=Math.abs(this._lastMouseY-b.clientY),g=this._lastMouseButton===d;this._lastMouseX=b.clientX;this._lastMouseY=b.clientY;this._lastMouseTime=j;this._lastMouseButton=d;if(d===1)this._isMouseDown=!0,g&&c<=this._clickTime&&i<=this._clickDist&&n<=this._clickDist?this._clickCount++:this._clickCount=1;if(this.isListening("MouseDown")&&(j=this._createMouseEvent("MouseDown",
b),this.onMouseDown(j),j.defaultPrevented)){b.preventDefault();return}if(d===1&&this._handleMouse(b)&&(a.isIE>=9||a.isOpera||a.isChrome||a.isSafari||a.isFirefox&&!this._overlayDiv))this._hasFocus||this.focus(),b.preventDefault();a.isFirefox&&this._lastMouseButton===3&&this._updateDOMSelection()},_handleMouseOver:function(b){if(!this._animation&&this.isListening("MouseOver"))this.onMouseOver(this._createMouseEvent("MouseOver",b))},_handleMouseOut:function(b){if(!this._animation&&this.isListening("MouseOut"))this.onMouseOut(this._createMouseEvent("MouseOut",
b))},_handleMouseMove:function(b){if(!this._animation){var d=this._isClientDiv(b);if(this.isListening("MouseMove")&&d)this.onMouseMove(this._createMouseEvent("MouseMove",b));if(!this._dropTarget){var j=this._linksVisible||this._lastMouseMoveX!==b.clientX||this._lastMouseMoveY!==b.clientY;this._lastMouseMoveX=b.clientX;this._lastMouseMoveY=b.clientY;this._setLinksVisible(j&&!this._isMouseDown&&(a.isMac?b.metaKey:b.ctrlKey));if(!this._isW3CEvents){if(b.button===0)return this._setGrab(null),!0;if(!this._isMouseDown&&
b.button===1&&(this._clickCount&1)!==0&&d)return this._clickCount=2,this._handleMouse(b,this._clickCount)}if(this._isMouseDown&&this._dragOffset===-1){var d=b.clientX,b=b.clientY,c=this._getViewPadding(),i=this._viewDiv.getBoundingClientRect(),n=this._getClientWidth(),g=this._getClientHeight(),j=i.left+c.left,f=i.top+c.top,n=i.left+c.left+n,c=i.top+c.top+g,i=this._model,g=i.getLineAtOffset(this._getSelection().getCaret());b<f&&g!==0?this._doAutoScroll("up",d,b-f):b>c&&g!==i.getLineCount()-1?this._doAutoScroll("down",
d,b-c):d<j&&!this._wrapMode?this._doAutoScroll("left",d-j,b):d>n&&!this._wrapMode?this._doAutoScroll("right",d-n,b):(this._endAutoScroll(),this._setSelectionTo(d,b,!0))}}}},_isClientDiv:function(b){for(var d=this._overlayDiv||this._clientDiv,b=b.target?b.target:b.srcElement;b;){if(d===b)return!0;b=b.parentNode}return!1},_createKeyEvent:function(b,d){return{type:b,event:d,preventDefault:function(){this.defaultPrevented=!0}}},_createMouseEvent:function(b,d){var j=this.convert({x:d.clientX,y:d.clientY},
"page","document");return{type:b,event:d,clickCount:this._clickCount,x:j.x,y:j.y,preventDefault:function(){this.defaultPrevented=!0}}},_handleMouseUp:function(b){var d=b.which?b.button===0:b.button===1;if(this.isListening("MouseUp")&&(this._isClientDiv(b)||d&&this._isMouseDown))this.onMouseUp(this._createMouseEvent("MouseUp",b));if(!this._linksVisible&&d&&this._isMouseDown){if(this._dragOffset!==-1)d=this._getSelection(),d.extend(this._dragOffset),d.collapse(),this._setSelection(d,!0,!0),this._dragOffset=
-1;this._isMouseDown=!1;this._endAutoScroll();this._isW3CEvents&&this._setGrab(null);a.isFirefox&&b.preventDefault()}},_handleMouseWheel:function(b){var d=this._getLineHeight(),j=0,c=0;a.isIE||a.isOpera?c=-b.wheelDelta/40*d:a.isFirefox?(d=a.isMac?b.detail*3:Math.max(-256,Math.min(256,b.detail))*d,b.axis===b.HORIZONTAL_AXIS?j=d:c=d):a.isMac?(c=j=40,b.wheelDeltaX%120!==0&&(j=1),b.wheelDeltaY%120!==0&&(c=1),j=-b.wheelDeltaX/j,-1<j&&j<0&&(j=-1),0<j&&j<1&&(j=1),c=-b.wheelDeltaY/c,-1<c&&c<0&&(c=-1),0<c&&
c<1&&(c=1)):(j=-b.wheelDeltaX,c=-b.wheelDeltaY/120*8*d);if(a.isSafari){for(d=b.target;d&&d.lineIndex===void 0;)d=d.parentNode;this._mouseWheelLine=d}d=this._getScroll();this._scrollView(j,c);j=this._getScroll();if(d.x!==j.x||d.y!==j.y)return b.preventDefault&&b.preventDefault(),!1},_handlePaste:function(b){if(!this._ignorePaste&&this._doPaste(b)){if(a.isIE){var d=this;this._ignoreFocus=!0;this._getWindow().setTimeout(function(){d._updateDOMSelection();d._ignoreFocus=!1},0)}b.preventDefault&&b.preventDefault();
return!1}},_handleResize:function(){var b=this._parent.clientWidth,d=this._parent.clientHeight;if(this._parentWidth!==b||this._parentHeight!==d)this._parentWidth!==b&&this._resetLineHeight(),this._parentWidth=b,this._parentHeight=d,a.isIE<9?this._queueUpdate():this._update()},_handleRulerEvent:function(b){for(var d=b.target?b.target:b.srcElement,j=d.lineIndex;d&&!d._ruler;){if(j===void 0&&d.lineIndex!==void 0)j=d.lineIndex;d=d.parentNode}d=d?d._ruler:null;if(j===void 0&&d&&d.getOverview()==="document"){var j=
this._getClientHeight(),a=this._model.getLineCount(),c=this._getViewPadding(),n=this._viewDiv.getBoundingClientRect(),j=Math.floor((b.clientY-n.top-this._metrics.scrollWidth)*a/(j+c.top+c.bottom-2*this._metrics.scrollWidth));0<=j&&j<a||(j=void 0)}if(d)switch(b.type){case "click":if(d.onClick)d.onClick(j,b);break;case "dblclick":if(d.onDblClick)d.onDblClick(j,b);break;case "mousemove":if(d.onMouseMove)d.onMouseMove(j,b);break;case "mouseover":if(d.onMouseOver)d.onMouseOver(j,b);break;case "mouseout":if(d.onMouseOut)d.onMouseOut(j,
b)}},_handleScroll:function(){var b=this._getScroll(!1),d=this._hScroll,j=this._vScroll;if(d!==b.x||j!==b.y)this._hScroll=b.x,this._vScroll=b.y,this._commitIME(),this._update(j===b.y),this.onScroll({type:"Scroll",oldValue:{x:d,y:j},newValue:b})},_handleSelectStart:function(b){if(this._ignoreSelect)return b&&b.preventDefault&&b.preventDefault(),!1},_getModelOffset:function(b,d){if(b){var j;j=b.tagName==="DIV"?b:b.parentNode.parentNode;var a=0,c=j.lineIndex;if(b.tagName!=="DIV")for(j=j.firstChild;j;){var n=
j.firstChild;if(n===b){j.ignoreChars&&(a-=j.ignoreChars);a+=d;break}j.ignoreChars&&(a-=j.ignoreChars);a+=n.data.length;j=j.nextSibling}return Math.max(0,a)+this._model.getLineStart(c)}},_updateSelectionFromDOM:function(){var b=this._getWindow().getSelection(),d=this._getModelOffset(b.anchorNode,b.anchorOffset),b=this._getModelOffset(b.focusNode,b.focusOffset);d===void 0||b===void 0||this._setSelection(new l(d,b),!1,!1)},_handleSelectionChange:function(){if(this._imeOffset===-1)if(a.isAndroid){var b=
this._getWindow();this._selTimer&&b.clearTimeout(this._selTimer);var d=this;this._selTimer=b.setTimeout(function(){if(d._clientDiv)d._selTimer=null,d._updateSelectionFromDOM()},250)}else this._updateSelectionFromDOM()},_handleTextInput:function(b){this._imeOffset=-1;if(a.isAndroid){for(var d=this._getWindow().getSelection(),j=d.anchorNode;j;){if(j.lineIndex!==void 0)break;j=j.parentNode}if(j){var c=this._model,i=j.lineIndex,n=c.getLine(i),g=n,f=0,c=c.getLineStart(i);if(d.rangeCount>0)d.getRangeAt(0).deleteContents(),
i=j.ownerDocument.createTextNode(b.data),d.getRangeAt(0).insertNode(i),f=this._getDOMText(j,i),g=f.text,f=f.offset,i.parentNode.removeChild(i);j.lineRemoved=!0;for(j=0;n.charCodeAt(j)===g.charCodeAt(j)&&j<f;)j++;d=n.length-1;for(i=g.length-n.length;n.charCodeAt(d)===g.charCodeAt(d+i)&&d+i>=f+b.data.length;)d--;d++;n=g.substring(j,d+i);j+=c;d+=c;this._modifyContent({text:n,start:j,end:d,_ignoreDOMSelection:!0},!0)}}else this._doContent(b.data);b.preventDefault()},_handleTouchStart:function(b){this._commitIME();
var d=this._getWindow();if(this._touchScrollTimer)this._vScrollDiv.style.display="none",this._hScrollDiv.style.display="none",d.clearInterval(this._touchScrollTimer),this._touchScrollTimer=null;var j=b.touches;if(j.length===1){var j=j[0],c=j.clientX,i=j.clientY;this._touchStartX=c;this._touchStartY=i;if(a.isAndroid&&(i<j.pageY-d.pageYOffset||c<j.pageX-d.pageXOffset))c=j.pageX-d.pageXOffset,i=j.pageY-d.pageYOffset;d=this.convert({x:c,y:i},"page","document");this._lastTouchOffset=this.getOffsetAtLocation(d.x,
d.y);this._touchStartTime=b.timeStamp;this._touching=!0}},_handleTouchMove:function(b){var d=b.touches;if(d.length===1){d=d[0];this._touchCurrentX=d.clientX;this._touchCurrentY=d.clientY;if(!this._touchScrollTimer&&b.timeStamp-this._touchStartTime<200){this._vScrollDiv.style.display="block";if(!this._wrapMode)this._hScrollDiv.style.display="block";var j=this,a=this._getWindow();this._touchScrollTimer=a.setInterval(function(){var b=0,d=0;if(j._touching)b=j._touchStartX-j._touchCurrentX,d=j._touchStartY-
j._touchCurrentY,j._touchSpeedX=b/10,j._touchSpeedY=d/10,j._touchStartX=j._touchCurrentX,j._touchStartY=j._touchCurrentY;else if(Math.abs(j._touchSpeedX)<0.1&&Math.abs(j._touchSpeedY)<0.1){j._vScrollDiv.style.display="none";j._hScrollDiv.style.display="none";a.clearInterval(j._touchScrollTimer);j._touchScrollTimer=null;return}else b=j._touchSpeedX*10,d=j._touchSpeedY*10,j._touchSpeedX*=0.95,j._touchSpeedY*=0.95;j._scrollView(b,d)},10)}this._touchScrollTimer&&b.preventDefault()}},_handleTouchEnd:function(b){if(b.touches.length===
0)this._touching=!1},_doAction:function(b){for(var d=this._keyBindings,j=0;j<d.length;j++){var a=d[j];if(a.keyBinding.match(b)){if(a.actionID&&(b=this._actions[a.actionID]))if(b.handler){if(!b.handler())return b.defaultHandler?typeof b.defaultHandler()==="boolean":!1}else if(b.defaultHandler)return typeof b.defaultHandler()==="boolean";return!0}}return!1},_doBackspace:function(b){var d=this._getSelection();if(d.isEmpty()){var j=this._model,a=d.getCaret(),c=j.getLineAtOffset(a),n=j.getLineStart(c);
if(a===n)c>0&&d.extend(j.getLineEnd(c-1));else{var i=!1;this._expandTab&&b.unit==="character"&&(a-n)%this._tabSize===0&&(i=!/[^ ]/.test(j.getText(n,a)));i?d.extend(a-this._tabSize):(j=this._getLine(c),d.extend(j.getNextOffset(a,b.unit,-1)),j.destroy())}}this._modifyContent({text:"",start:d.start,end:d.end},!0);return!0},_doContent:function(b){var d=this._getSelection();this._modifyContent({text:b,start:d.start,end:d.end,_ignoreDOMSelection:!0},!0)},_doCopy:function(b){var d=this._getSelection();return!d.isEmpty()?
this._setClipboardText(this._getBaseText(d.start,d.end),b):!0},_doCursorNext:function(b){if(!b.select&&this._clearSelection("next"))return!0;var d=this._model,j=this._getSelection(),a=j.getCaret(),c=d.getLineAtOffset(a);a===d.getLineEnd(c)?c+1<d.getLineCount()&&j.extend(d.getLineStart(c+1)):(d=this._getLine(c),j.extend(d.getNextOffset(a,b.unit,1)),d.destroy());b.select||j.collapse();this._setSelection(j,!0);return!0},_doCursorPrevious:function(b){if(!b.select&&this._clearSelection("previous"))return!0;
var d=this._model,j=this._getSelection(),a=j.getCaret(),c=d.getLineAtOffset(a);a===d.getLineStart(c)?c>0&&j.extend(d.getLineEnd(c-1)):(d=this._getLine(c),j.extend(d.getNextOffset(a,b.unit,-1)),d.destroy());b.select||j.collapse();this._setSelection(j,!0);return!0},_doCut:function(b){var d=this._getSelection();return!d.isEmpty()?(d=this._getBaseText(d.start,d.end),this._doContent(""),this._setClipboardText(d,b)):!0},_doDelete:function(b){var d=this._getSelection();if(d.isEmpty()){var j=this._model,
a=d.getCaret(),c=j.getLineAtOffset(a);a===j.getLineEnd(c)?c+1<j.getLineCount()&&d.extend(j.getLineStart(c+1)):(j=this._getLine(c),d.extend(j.getNextOffset(a,b.unit,1)),j.destroy())}this._modifyContent({text:"",start:d.start,end:d.end},!0);return!0},_doEnd:function(b){var d=this._getSelection(),j=this._model,a;if(b.ctrl)d.extend(j.getCharCount()),a=function(){};else{var c=d.getCaret(),n=j.getLineAtOffset(c);if(this._wrapMode){var i=this._getLine(n),c=i.getLineIndex(c),c=c===i.getLineCount()-1?j.getLineEnd(n):
i.getLineStart(c+1)-1;i.destroy()}else c=j.getLineEnd(n);d.extend(c)}b.select||d.collapse();this._setSelection(d,!0,!0,a);return!0},_doEnter:function(b){var d=this._model,j=this._getSelection();this._doContent(d.getLineDelimiter());if(b&&b.noCursor)j.end=j.start,this._setSelection(j,!0);return!0},_doHome:function(b){var d=this._getSelection(),j=this._model,a;if(b.ctrl)d.extend(0),a=function(){};else{var c=d.getCaret(),n=j.getLineAtOffset(c);this._wrapMode?(j=this._getLine(n),c=j.getLineIndex(c),c=
j.getLineStart(c),j.destroy()):c=j.getLineStart(n);d.extend(c)}b.select||d.collapse();this._setSelection(d,!0,!0,a);return!0},_doLineDown:function(b){var d=this._model,j=this._getSelection(),c=j.getCaret(),i=d.getLineAtOffset(c),n=this._getLine(i),g=this._columnX,f=1,e=!1;if(g===-1||b.wholeLine||b.select&&a.isIE)g=b.wholeLine?d.getLineEnd(i+1):c,g=n.getBoundingClientRect(g).left;(c=n.getLineIndex(c))<n.getLineCount()-1?f=n.getClientRects(c+1).top+1:(e=i===d.getLineCount()-1,i++);e?b.select&&(j.extend(d.getCharCount()),
this._setSelection(j,!0,!0)):(n.lineIndex!==i&&(n.destroy(),n=this._getLine(i)),j.extend(n.getOffset(g,f)),b.select||j.collapse(),this._setSelection(j,!0,!0));this._columnX=g;n.destroy();return!0},_doLineUp:function(b){var d=this._model,j=this._getSelection(),c=j.getCaret(),i=d.getLineAtOffset(c),n=this._getLine(i),g=this._columnX,f=!1,e;if(g===-1||b.wholeLine||b.select&&a.isIE)g=b.wholeLine?d.getLineStart(i-1):c,g=n.getBoundingClientRect(g).left;(c=n.getLineIndex(c))>0?e=n.getClientRects(c-1).top+
1:(f=i===0,f||(i--,e=this._getLineHeight(i)-1));f?b.select&&(j.extend(0),this._setSelection(j,!0,!0)):(n.lineIndex!==i&&(n.destroy(),n=this._getLine(i)),j.extend(n.getOffset(g,e)),b.select||j.collapse(),this._setSelection(j,!0,!0));this._columnX=g;n.destroy();return!0},_doPageDown:function(b){var d=this,j=this._model,c=this._getSelection(),i=c.getCaret(),n=j.getLineAtOffset(i),g=j.getLineCount(),f=this._getScroll(),j=this._getClientHeight(),e,q;if(this._lineHeight){e=this._columnX;f=this._getBoundsAtOffset(i);
if(e===-1||b.select&&a.isIE)e=f.left;i=this._getLineIndex(f.top+j);q=this._getLine(i);n=this._getLinePixel(i);i=q.getOffset(e,f.top+j-n);j=q.getBoundingClientRect(i);q.destroy();c.extend(i);b.select||c.collapse();this._setSelection(c,!0,!0,function(){d._columnX=e},j.top+n-f.top);return!0}if(n<g-1){var l=this._getLineHeight(),o=Math.min(g-n-1,Math.floor(j/l)),o=Math.max(1,o);e=this._columnX;if(e===-1||b.select&&a.isIE)q=this._getLine(n),e=q.getBoundingClientRect(i).left,q.destroy();q=this._getLine(n+
o);c.extend(q.getOffset(e,0));q.destroy();b.select||c.collapse();b=g*l;i=f.y+o*l;i+j>b&&(i=b-j);this._setSelection(c,!0,!0,function(){d._columnX=e},i-f.y)}return!0},_doPageUp:function(b){var d=this,j=this._model,c=this._getSelection(),i=c.getCaret(),n=j.getLineAtOffset(i),g=this._getScroll(),f=this._getClientHeight(),e;if(this._lineHeight){e=this._columnX;g=this._getBoundsAtOffset(i);if(e===-1||b.select&&a.isIE)e=g.left;i=this._getLineIndex(g.bottom-f);j=this._getLine(i);n=this._getLinePixel(i);i=
j.getOffset(e,g.bottom-f-n);f=j.getBoundingClientRect(i);j.destroy();c.extend(i);b.select||c.collapse();this._setSelection(c,!0,!0,function(){d._columnX=e},f.top+n-g.top);return!0}if(n>0){var q=this._getLineHeight(),f=Math.max(1,Math.min(n,Math.floor(f/q)));e=this._columnX;if(e===-1||b.select&&a.isIE)j=this._getLine(n),e=j.getBoundingClientRect(i).left,j.destroy();j=this._getLine(n-f);c.extend(j.getOffset(e,this._getLineHeight(n-f)-1));j.destroy();b.select||c.collapse();b=Math.max(0,g.y-f*q);this._setSelection(c,
!0,!0,function(){d._columnX=e},b-g.y)}return!0},_doPaste:function(b){var d=this;return this._getClipboardText(b,function(b){b&&(a.isLinux&&d._lastMouseButton===2&&(new Date).getTime()-d._lastMouseTime<=d._clickTime&&d._setSelectionTo(d._lastMouseX,d._lastMouseY),d._doContent(b))})!==null},_doScroll:function(b){var d=b.type,j=this._model,c=j.getLineCount(),b=this._getClientHeight(),a=this._getLineHeight();c*=a;var n=this._getScroll().y,i;switch(d){case "textStart":i=0;break;case "textEnd":i=c-b;break;
case "pageDown":i=n+b;break;case "pageUp":i=n-b;break;case "lineDown":i=n+a;break;case "lineUp":i=n-a;break;case "centerLine":d=this._getSelection(),i=j.getLineAtOffset(d.start),j=(j.getLineAtOffset(d.end)-i+1)*a,i=i*a-b/2+j/2}i!==void 0&&(i=Math.min(Math.max(0,i),c-b),this._scrollViewAnimated(0,i-n,function(){}));return!0},_doSelectAll:function(){var b=this._model,d=this._getSelection();d.setCaret(0);d.extend(b.getCharCount());this._setSelection(d,!1);return!0},_doTab:function(){if(this._tabMode&&
!this._readonly){var b="\t";if(this._expandTab)var d=this._model,b=this._getSelection().getCaret(),j=d.getLineAtOffset(b),d=d.getLineStart(j),b=Array(this._tabSize-(b-d)%this._tabSize+1).join(" ");this._doContent(b);return!0}},_doShiftTab:function(){return!this._tabMode||this._readonly?void 0:!0},_doTabMode:function(){this._tabMode=!this._tabMode;return!0},_doWrapMode:function(){this.setOptions({wrapMode:!this.getOptions("wrapMode")});return!0},_autoScroll:function(){var b=this._getSelection(),d=
this.convert({x:this._autoScrollX,y:this._autoScrollY},"page","document"),j=b.getCaret(),c=this._model.getLineAtOffset(j),a;if(this._autoScrollDir==="up"||this._autoScrollDir==="down")j=this._autoScrollY/this._getLineHeight(),j=j<0?Math.floor(j):Math.ceil(j),a=c,a=Math.max(0,Math.min(this._model.getLineCount()-1,a+j));else if(this._autoScrollDir==="left"||this._autoScrollDir==="right")a=this._getLineIndex(d.y),c=this._getLine(c),d.x+=c.getBoundingClientRect(j,!1).left,c.destroy();c=this._getLine(a);
b.extend(c.getOffset(d.x,d.y-this._getLinePixel(a)));c.destroy();this._setSelection(b,!0)},_autoScrollTimer:function(){this._autoScroll();var b=this;this._autoScrollTimerID=this._getWindow().setTimeout(function(){b._autoScrollTimer()},this._AUTO_SCROLL_RATE)},_calculateLineHeightTimer:function(b){if(this._lineHeight&&!this._calculateLHTimer){var d=this._model.getLineCount(),j=0;if(b){for(var b=0,c=(new Date).getTime(),a=0;j<d;)if(this._lineHeight[j]||(b++,a||(a=j),this._lineHeight[j]=this._calculateLineHeight(j)),
j++,(new Date).getTime()-c>100)break;this.redrawRulers(0,d);this._queueUpdate()}b=this._getWindow();if(j!==d){var n=this;this._calculateLHTimer=b.setTimeout(function(){n._calculateLHTimer=null;n._calculateLineHeightTimer(!0)},0)}else if(this._calculateLHTimer)b.clearTimeout(this._calculateLHTimer),this._calculateLHTimer=void 0}},_calculateLineHeight:function(b){var b=this._getLine(b),d=b.getBoundingClientRect();b.destroy();return Math.max(1,Math.ceil(d.bottom-d.top))},_calculateMetrics:function(){var b=
this._clientDiv,d=b.ownerDocument,c=a.createElement(d,"div");c.style.lineHeight="normal";var g={type:"LineStyle",textView:this,0:0,lineText:this._model.getLine(0),lineStart:0};this.onLineStyle(g);f(g.style,c);c.style.position="fixed";c.style.left="-1000px";var e=a.createElement(d,"span");e.appendChild(d.createTextNode(" "));c.appendChild(e);var n=a.createElement(d,"span");n.style.fontStyle="italic";n.appendChild(d.createTextNode(" "));c.appendChild(n);var l=a.createElement(d,"span");l.style.fontWeight=
"bold";l.appendChild(d.createTextNode(" "));c.appendChild(l);g=a.createElement(d,"span");g.style.fontWeight="bold";g.style.fontStyle="italic";g.appendChild(d.createTextNode(" "));c.appendChild(g);b.appendChild(c);var o=c.getBoundingClientRect(),e=e.getBoundingClientRect(),n=n.getBoundingClientRect(),l=l.getBoundingClientRect(),g=g.getBoundingClientRect(),e=e.bottom-e.top,n=n.bottom-n.top,l=l.bottom-l.top,h=g.bottom-g.top,w=0,g=o.bottom-o.top<=0,o=Math.max(1,o.bottom-o.top);n>e&&(w=1);l>n&&(w=2);h>
l&&(w=3);var s;if(w!==0){s={style:{}};if((w&1)!==0)s.style.fontStyle="italic";if((w&2)!==0)s.style.fontWeight="bold"}e=q(c);b.removeChild(c);n=i(this._viewDiv);c=a.createElement(d,"div");c.style.position="fixed";c.style.left="-1000px";c.style.paddingLeft=n.left+"px";c.style.paddingTop=n.top+"px";c.style.paddingRight=n.right+"px";c.style.paddingBottom=n.bottom+"px";c.style.width="100px";c.style.height="100px";l=a.createElement(d,"div");l.style.width="100%";l.style.height="100%";c.appendChild(l);b.appendChild(c);
d=c.getBoundingClientRect();n=l.getBoundingClientRect();c.style.overflow="hidden";l.style.height="200px";l=c.clientWidth;c.style.overflow="scroll";h=c.clientWidth;b.removeChild(c);n={left:n.left-d.left,top:n.top-d.top,right:d.right-n.right,bottom:d.bottom-n.bottom};return{lineHeight:o,largestFontStyle:s,lineTrim:e,viewPadding:n,scrollWidth:l-h,invalid:g}},_cancelAnimation:function(){if(this._animation)this._animation.stop(),this._animation=null},_clearSelection:function(b){var d=this._getSelection();
if(d.isEmpty())return!1;b==="next"?d.start=d.end:d.end=d.start;this._setSelection(d,!0);return!0},_commitIME:function(){if(this._imeOffset!==-1){this._scrollDiv.focus();this._clientDiv.focus();var b=this._model,d=b.getLineAtOffset(this._imeOffset),c=b.getLineStart(d),a=this._getDOMText(this._getLineNode(d)).text,b=b.getLine(d),c=this._imeOffset-c,b=c+a.length-b.length;c!==b&&this._doContent(a.substring(c,b));this._imeOffset=-1}},_createActions:function(){var b=t.KeyBinding,d=this._keyBindings=[];
d.push({actionID:"lineUp",keyBinding:new b(38),predefined:!0});d.push({actionID:"lineDown",keyBinding:new b(40),predefined:!0});d.push({actionID:"charPrevious",keyBinding:new b(37),predefined:!0});d.push({actionID:"charNext",keyBinding:new b(39),predefined:!0});a.isMac?(d.push({actionID:"scrollPageUp",keyBinding:new b(33),predefined:!0}),d.push({actionID:"scrollPageDown",keyBinding:new b(34),predefined:!0}),d.push({actionID:"pageUp",keyBinding:new b(33,null,null,!0),predefined:!0}),d.push({actionID:"pageDown",
keyBinding:new b(34,null,null,!0),predefined:!0}),d.push({actionID:"lineStart",keyBinding:new b(37,!0),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new b(39,!0),predefined:!0}),d.push({actionID:"wordPrevious",keyBinding:new b(37,null,null,!0),predefined:!0}),d.push({actionID:"wordNext",keyBinding:new b(39,null,null,!0),predefined:!0}),d.push({actionID:"scrollTextStart",keyBinding:new b(36),predefined:!0}),d.push({actionID:"scrollTextEnd",keyBinding:new b(35),predefined:!0}),d.push({actionID:"textStart",
keyBinding:new b(38,!0),predefined:!0}),d.push({actionID:"textEnd",keyBinding:new b(40,!0),predefined:!0}),d.push({actionID:"scrollPageUp",keyBinding:new b(38,null,null,null,!0),predefined:!0}),d.push({actionID:"scrollPageDown",keyBinding:new b(40,null,null,null,!0),predefined:!0}),d.push({actionID:"lineStart",keyBinding:new b(37,null,null,null,!0),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new b(39,null,null,null,!0),predefined:!0}),d.push({actionID:"lineStart",keyBinding:new b(38,null,
null,!0),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new b(40,null,null,!0),predefined:!0})):(d.push({actionID:"pageUp",keyBinding:new b(33),predefined:!0}),d.push({actionID:"pageDown",keyBinding:new b(34),predefined:!0}),d.push({actionID:"lineStart",keyBinding:new b(36),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new b(35),predefined:!0}),d.push({actionID:"wordPrevious",keyBinding:new b(37,!0),predefined:!0}),d.push({actionID:"wordNext",keyBinding:new b(39,!0),predefined:!0}),
d.push({actionID:"textStart",keyBinding:new b(36,!0),predefined:!0}),d.push({actionID:"textEnd",keyBinding:new b(35,!0),predefined:!0}));a.isFirefox&&a.isLinux&&(d.push({actionID:"lineUp",keyBinding:new b(38,!0),predefined:!0}),d.push({actionID:"lineDown",keyBinding:new b(40,!0),predefined:!0}));a.isWindows&&(d.push({actionID:"scrollLineUp",keyBinding:new b(38,!0),predefined:!0}),d.push({actionID:"scrollLineDown",keyBinding:new b(40,!0),predefined:!0}));d.push({actionID:"selectLineUp",keyBinding:new b(38,
null,!0),predefined:!0});d.push({actionID:"selectLineDown",keyBinding:new b(40,null,!0),predefined:!0});d.push({actionID:"selectCharPrevious",keyBinding:new b(37,null,!0),predefined:!0});d.push({actionID:"selectCharNext",keyBinding:new b(39,null,!0),predefined:!0});d.push({actionID:"selectPageUp",keyBinding:new b(33,null,!0),predefined:!0});d.push({actionID:"selectPageDown",keyBinding:new b(34,null,!0),predefined:!0});a.isMac?(d.push({actionID:"selectLineStart",keyBinding:new b(37,!0,!0),predefined:!0}),
d.push({actionID:"selectLineEnd",keyBinding:new b(39,!0,!0),predefined:!0}),d.push({actionID:"selectWordPrevious",keyBinding:new b(37,null,!0,!0),predefined:!0}),d.push({actionID:"selectWordNext",keyBinding:new b(39,null,!0,!0),predefined:!0}),d.push({actionID:"selectTextStart",keyBinding:new b(36,null,!0),predefined:!0}),d.push({actionID:"selectTextEnd",keyBinding:new b(35,null,!0),predefined:!0}),d.push({actionID:"selectTextStart",keyBinding:new b(38,!0,!0),predefined:!0}),d.push({actionID:"selectTextEnd",
keyBinding:new b(40,!0,!0),predefined:!0}),d.push({actionID:"selectLineStart",keyBinding:new b(37,null,!0,null,!0),predefined:!0}),d.push({actionID:"selectLineEnd",keyBinding:new b(39,null,!0,null,!0),predefined:!0}),d.push({actionID:"selectLineStart",keyBinding:new b(38,null,!0,!0),predefined:!0}),d.push({actionID:"selectLineEnd",keyBinding:new b(40,null,!0,!0),predefined:!0})):(a.isLinux&&(d.push({actionID:"selectWholeLineUp",keyBinding:new b(38,!0,!0),predefined:!0}),d.push({actionID:"selectWholeLineDown",
keyBinding:new b(40,!0,!0),predefined:!0})),d.push({actionID:"selectLineStart",keyBinding:new b(36,null,!0),predefined:!0}),d.push({actionID:"selectLineEnd",keyBinding:new b(35,null,!0),predefined:!0}),d.push({actionID:"selectWordPrevious",keyBinding:new b(37,!0,!0),predefined:!0}),d.push({actionID:"selectWordNext",keyBinding:new b(39,!0,!0),predefined:!0}),d.push({actionID:"selectTextStart",keyBinding:new b(36,!0,!0),predefined:!0}),d.push({actionID:"selectTextEnd",keyBinding:new b(35,!0,!0),predefined:!0}));
d.push({actionID:"undo",keyBinding:new t.KeyBinding("z",!0),predefined:!0});a.isMac?d.push({actionID:"redo",keyBinding:new t.KeyBinding("z",!0,!0),predefined:!0}):d.push({actionID:"redo",keyBinding:new t.KeyBinding("y",!0),predefined:!0});d.push({actionID:"deletePrevious",keyBinding:new b(8),predefined:!0});d.push({actionID:"deletePrevious",keyBinding:new b(8,null,!0),predefined:!0});d.push({actionID:"deleteNext",keyBinding:new b(46),predefined:!0});d.push({actionID:"deleteWordPrevious",keyBinding:new b(8,
!0),predefined:!0});d.push({actionID:"deleteWordPrevious",keyBinding:new b(8,!0,!0),predefined:!0});d.push({actionID:"deleteWordNext",keyBinding:new b(46,!0),predefined:!0});d.push({actionID:"tab",keyBinding:new b(9),predefined:!0});d.push({actionID:"shiftTab",keyBinding:new b(9,null,!0),predefined:!0});d.push({actionID:"enter",keyBinding:new b(13),predefined:!0});d.push({actionID:"enter",keyBinding:new b(13,null,!0),predefined:!0});d.push({actionID:"selectAll",keyBinding:new b("a",!0),predefined:!0});
d.push({actionID:"toggleTabMode",keyBinding:new b("m",!0),predefined:!0});a.isMac&&(d.push({actionID:"deleteNext",keyBinding:new b(46,null,!0),predefined:!0}),d.push({actionID:"deleteWordPrevious",keyBinding:new b(8,null,null,!0),predefined:!0}),d.push({actionID:"deleteWordNext",keyBinding:new b(46,null,null,!0),predefined:!0}));if(!a.isFirefox){var c=a.isMac&&a.isChrome;d.push({actionID:null,keyBinding:new b("u",!c,!1,!1,c),predefined:!0});d.push({actionID:null,keyBinding:new b("i",!c,!1,!1,c),predefined:!0});
d.push({actionID:null,keyBinding:new b("b",!c,!1,!1,c),predefined:!0})}a.isFirefox&&(d.push({actionID:"copy",keyBinding:new b(45,!0),predefined:!0}),d.push({actionID:"paste",keyBinding:new b(45,null,!0),predefined:!0}),d.push({actionID:"cut",keyBinding:new b(46,null,!0),predefined:!0}));a.isMac&&(d.push({actionID:"lineStart",keyBinding:new b("a",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new b("e",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"lineUp",keyBinding:new b("p",
!1,!1,!1,!0),predefined:!0}),d.push({actionID:"lineDown",keyBinding:new b("n",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"charPrevious",keyBinding:new b("b",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"charNext",keyBinding:new b("f",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deletePrevious",keyBinding:new b("h",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deleteNext",keyBinding:new b("d",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deleteLineEnd",keyBinding:new b("k",!1,!1,!1,!0),predefined:!0}),
a.isFirefox?(d.push({actionID:"scrollPageDown",keyBinding:new b("v",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deleteLineStart",keyBinding:new b("u",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deleteWordPrevious",keyBinding:new b("w",!1,!1,!1,!0),predefined:!0})):(d.push({actionID:"pageDown",keyBinding:new b("v",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"centerLine",keyBinding:new b("l",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"enterNoCursor",keyBinding:new b("o",!1,!1,!1,!0),predefined:!0})));
var i=this;this._actions={lineUp:{defaultHandler:function(){return i._doLineUp({select:!1})}},lineDown:{defaultHandler:function(){return i._doLineDown({select:!1})}},lineStart:{defaultHandler:function(){return i._doHome({select:!1,ctrl:!1})}},lineEnd:{defaultHandler:function(){return i._doEnd({select:!1,ctrl:!1})}},charPrevious:{defaultHandler:function(){return i._doCursorPrevious({select:!1,unit:"character"})}},charNext:{defaultHandler:function(){return i._doCursorNext({select:!1,unit:"character"})}},
pageUp:{defaultHandler:function(){return i._doPageUp({select:!1})}},pageDown:{defaultHandler:function(){return i._doPageDown({select:!1})}},scrollPageUp:{defaultHandler:function(){return i._doScroll({type:"pageUp"})}},scrollPageDown:{defaultHandler:function(){return i._doScroll({type:"pageDown"})}},scrollLineUp:{defaultHandler:function(){return i._doScroll({type:"lineUp"})}},scrollLineDown:{defaultHandler:function(){return i._doScroll({type:"lineDown"})}},wordPrevious:{defaultHandler:function(){return i._doCursorPrevious({select:!1,
unit:"word"})}},wordNext:{defaultHandler:function(){return i._doCursorNext({select:!1,unit:"word"})}},textStart:{defaultHandler:function(){return i._doHome({select:!1,ctrl:!0})}},textEnd:{defaultHandler:function(){return i._doEnd({select:!1,ctrl:!0})}},scrollTextStart:{defaultHandler:function(){return i._doScroll({type:"textStart"})}},scrollTextEnd:{defaultHandler:function(){return i._doScroll({type:"textEnd"})}},centerLine:{defaultHandler:function(){return i._doScroll({type:"centerLine"})}},selectLineUp:{defaultHandler:function(){return i._doLineUp({select:!0})}},
selectLineDown:{defaultHandler:function(){return i._doLineDown({select:!0})}},selectWholeLineUp:{defaultHandler:function(){return i._doLineUp({select:!0,wholeLine:!0})}},selectWholeLineDown:{defaultHandler:function(){return i._doLineDown({select:!0,wholeLine:!0})}},selectLineStart:{defaultHandler:function(){return i._doHome({select:!0,ctrl:!1})}},selectLineEnd:{defaultHandler:function(){return i._doEnd({select:!0,ctrl:!1})}},selectCharPrevious:{defaultHandler:function(){return i._doCursorPrevious({select:!0,
unit:"character"})}},selectCharNext:{defaultHandler:function(){return i._doCursorNext({select:!0,unit:"character"})}},selectPageUp:{defaultHandler:function(){return i._doPageUp({select:!0})}},selectPageDown:{defaultHandler:function(){return i._doPageDown({select:!0})}},selectWordPrevious:{defaultHandler:function(){return i._doCursorPrevious({select:!0,unit:"word"})}},selectWordNext:{defaultHandler:function(){return i._doCursorNext({select:!0,unit:"word"})}},selectTextStart:{defaultHandler:function(){return i._doHome({select:!0,
ctrl:!0})}},selectTextEnd:{defaultHandler:function(){return i._doEnd({select:!0,ctrl:!0})}},deletePrevious:{defaultHandler:function(){return i._doBackspace({unit:"character"})}},deleteNext:{defaultHandler:function(){return i._doDelete({unit:"character"})}},deleteWordPrevious:{defaultHandler:function(){return i._doBackspace({unit:"word"})}},deleteWordNext:{defaultHandler:function(){return i._doDelete({unit:"word"})}},deleteLineStart:{defaultHandler:function(){return i._doBackspace({unit:"line"})}},
deleteLineEnd:{defaultHandler:function(){return i._doDelete({unit:"line"})}},tab:{defaultHandler:function(){return i._doTab()}},shiftTab:{defaultHandler:function(){return i._doShiftTab()}},enter:{defaultHandler:function(){return i._doEnter()}},enterNoCursor:{defaultHandler:function(){return i._doEnter({noCursor:!0})}},selectAll:{defaultHandler:function(){return i._doSelectAll()}},copy:{defaultHandler:function(){return i._doCopy()}},cut:{defaultHandler:function(){return i._doCut()}},paste:{defaultHandler:function(){return i._doPaste()}},
toggleWrapMode:{defaultHandler:function(){return i._doWrapMode()}},toggleTabMode:{defaultHandler:function(){return i._doTabMode()}}}},_createRuler:function(b,d){if(this._clientDiv){var c=b.getLocation()==="left"?this._leftDiv:this._rightDiv;c.style.display="block";var i=a.createElement(c.ownerDocument,"div");i._ruler=b;i.rulerChanged=!0;i.style.position="relative";i.style.cssFloat="left";i.style.styleFloat="left";i.style.borderWidth="0px";i.style.margin="0px";i.style.padding="0px";i.style.outline=
"none";if(d===void 0||d<0||d>=c.children.length)c.appendChild(i);else{for(var g=c.firstChild;g&&--d>0;)g=g.nextSibling;c.insertBefore(i,g)}}},_createView:function(){if(!this._clientDiv){for(var b=this._parent;b.hasChildNodes();)b.removeChild(b.lastChild);var d=b.ownerDocument,c=a.createElement(d,"div");this._rootDiv=c;c.tabIndex=-1;c.style.position="relative";c.style.overflow="hidden";c.style.width="100%";c.style.height="100%";c.style.overflow="hidden";c.style.WebkitTextSizeAdjust="100%";c.setAttribute("role",
"application");b.appendChild(c);b=a.createElement(d,"div");b.className="textviewLeftRuler";this._leftDiv=b;b.tabIndex=-1;b.style.overflow="hidden";b.style.MozUserSelect="none";b.style.WebkitUserSelect="none";b.style.position="absolute";b.style.top="0px";b.style.bottom="0px";b.style.cursor="default";b.style.display="none";b.setAttribute("aria-hidden","true");c.appendChild(b);b=a.createElement(d,"div");b.className="textviewScroll";this._viewDiv=b;b.tabIndex=-1;b.style.overflow="auto";b.style.position=
"absolute";b.style.top="0px";b.style.bottom="0px";b.style.borderWidth="0px";b.style.margin="0px";b.style.outline="none";b.style.background="transparent";if(a.isMac&&a.isWebkit)b.style.pointerEvents="none",b.style.zIndex="2";c.appendChild(b);var i=a.createElement(d,"div");i.className="textviewRightRuler";this._rightDiv=i;i.tabIndex=-1;i.style.display="none";i.style.overflow="hidden";i.style.MozUserSelect="none";i.style.WebkitUserSelect="none";i.style.position="absolute";i.style.top="0px";i.style.bottom=
"0px";i.style.cursor="default";i.style.right="0px";i.setAttribute("aria-hidden","true");c.appendChild(i);this._scrollDiv=i=a.createElement(d,"div");i.style.margin="0px";i.style.borderWidth="0px";i.style.padding="0px";b.appendChild(i);if(a.isFirefox)this._clipboardDiv=b=a.createElement(d,"div"),b.style.position="fixed",b.style.whiteSpace="pre",b.style.left="-1000px",c.appendChild(b);if(!a.isIE&&!a.isIOS)this._clipDiv=b=a.createElement(d,"div"),b.style.position="absolute",b.style.overflow="hidden",
b.style.margin="0px",b.style.borderWidth="0px",b.style.padding="0px",b.style.background="transparent",c.appendChild(b),this._clipScrollDiv=i=a.createElement(d,"div"),i.style.position="absolute",i.style.height="1px",i.style.top="-1000px",i.style.background="transparent",b.appendChild(i);this._setFullSelection(this._fullSelection,!0);b=a.createElement(d,"div");b.className="textviewContent";this._clientDiv=b;b.style.position="absolute";b.style.borderWidth="0px";b.style.margin="0px";b.style.padding="0px";
b.style.outline="none";b.style.zIndex="1";b.style.WebkitUserSelect="text";b.setAttribute("spellcheck","false");if(a.isIOS||a.isAndroid)b.style.WebkitTapHighlightColor="transparent";(this._clipDiv||c).appendChild(b);if(a.isIOS||a.isAndroid)this._vScrollDiv=i=a.createElement(d,"div"),i.style.position="absolute",i.style.borderWidth="1px",i.style.borderColor="white",i.style.borderStyle="solid",i.style.borderRadius="4px",i.style.backgroundColor="black",i.style.opacity="0.5",i.style.margin="0px",i.style.padding=
"0px",i.style.outline="none",i.style.zIndex="3",i.style.width="8px",i.style.display="none",c.appendChild(i),this._hScrollDiv=i=a.createElement(d,"div"),i.style.position="absolute",i.style.borderWidth="1px",i.style.borderColor="white",i.style.borderStyle="solid",i.style.borderRadius="4px",i.style.backgroundColor="black",i.style.opacity="0.5",i.style.margin="0px",i.style.padding="0px",i.style.outline="none",i.style.zIndex="3",i.style.height="8px",i.style.display="none",c.appendChild(i);if(a.isFirefox&&
!b.setCapture)this._overlayDiv=d=a.createElement(d,"div"),d.style.position=b.style.position,d.style.borderWidth=b.style.borderWidth,d.style.margin=b.style.margin,d.style.padding=b.style.padding,d.style.cursor="text",d.style.zIndex="2",(this._clipDiv||c).appendChild(d);b.contentEditable="true";b.setAttribute("role","textbox");b.setAttribute("aria-multiline","true");this._setWrapMode(this._wrapMode,!0);this._setReadOnly(this._readonly);this._setThemeClass(this._themeClass,!0);this._setTabSize(this._tabSize,
!0);this._hookEvents();c=this._rulers;for(d=0;d<c.length;d++)this._createRuler(c[d]);this._update()}},_defaultOptions:function(){return{parent:{value:void 0,update:null},model:{value:void 0,update:this.setModel},scrollAnimation:{value:0,update:null},readonly:{value:!1,update:this._setReadOnly},fullSelection:{value:!0,update:this._setFullSelection},tabMode:{value:!0,update:null},tabSize:{value:8,update:this._setTabSize},expandTab:{value:!1,update:null},wrapMode:{value:!1,update:this._setWrapMode},
theme:{value:h.TextTheme.getTheme(),update:this._setTheme},themeClass:{value:void 0,update:this._setThemeClass}}},_destroyRuler:function(b){var d=b.getLocation()==="left"?this._leftDiv:this._rightDiv;if(d)for(var c=d.firstChild;c;){if(c._ruler===b){c._ruler=void 0;d.removeChild(c);if(d.children.length===0)d.style.display="none";break}c=c.nextSibling}},_destroyView:function(){if(this._clientDiv){this._setGrab(null);this._unhookEvents();var b=this._getWindow();if(this._autoScrollTimerID)b.clearTimeout(this._autoScrollTimerID),
this._autoScrollTimerID=null;if(this._updateTimer)b.clearTimeout(this._updateTimer),this._updateTimer=null;b=this._rootDiv;b.parentNode.removeChild(b);this._hScrollDiv=this._vScrollDiv=this._rightDiv=this._leftDiv=this._overlayDiv=this._clientDiv=this._clipScrollDiv=this._clipDiv=this._viewDiv=this._scrollDiv=this._rootDiv=this._clipboardDiv=this._selDiv3=this._selDiv2=this._selDiv1=null}},_doAutoScroll:function(b,d,c){this._autoScrollDir=b;this._autoScrollX=d;this._autoScrollY=c;this._autoScrollTimerID||
this._autoScrollTimer()},_endAutoScroll:function(){this._autoScrollTimerID&&this._getWindow().clearTimeout(this._autoScrollTimerID);this._autoScrollTimerID=this._autoScrollDir=void 0},_fixCaret:function(){var b=this._clientDiv;if(b){var d=this._hasFocus;this._ignoreFocus=!0;d&&b.blur();b.contentEditable=!1;b.contentEditable=!0;d&&b.focus();this._ignoreFocus=!1}},_getBaseText:function(b,d){var c=this._model;c.getBaseModel&&(b=c.mapOffset(b),d=c.mapOffset(d),c=c.getBaseModel());return c.getText(b,d)},
_getBottomIndex:function(b){var d=this._bottomChild;if(b&&this._getClientHeight()>this._getLineHeight()){var b=d.getBoundingClientRect(),c=this._clientDiv.getBoundingClientRect();b.bottom>c.bottom&&(d=this._getLinePrevious(d)||d)}return d.lineIndex},_getBoundsAtOffset:function(b){var d=this._getLine(this._model.getLineAtOffset(b)),b=d.getBoundingClientRect(b),c=this._getLinePixel(d.lineIndex);b.top+=c;b.bottom+=c;d.destroy();return b},_getClientHeight:function(){var b=this._getViewPadding();return Math.max(0,
this._viewDiv.clientHeight-b.top-b.bottom)},_getClientWidth:function(){var b=this._getViewPadding();return Math.max(0,this._viewDiv.clientWidth-b.left-b.right)},_getClipboardText:function(b,d){var i=this._model.getLineDelimiter(),g,f,n=this._getWindow();if(n.clipboardData)return g=[],f=n.clipboardData.getData("Text"),c(f,function(b){g.push(b)},function(){g.push(i)}),f=g.join(""),d&&d(f),f;if(a.isFirefox){this._ignoreFocus=!0;var e=this._clipboardDiv;e.innerHTML="<pre contenteditable=''></pre>";e.firstChild.focus();
var l=this,q=function(){var b=l._getTextFromElement(e);e.innerHTML="";g=[];c(b,function(b){g.push(b)},function(){g.push(i)});return g.join("")},o=!1;this._ignorePaste=!0;if(!a.isLinux||this._lastMouseButton!==2)try{o=e.ownerDocument.execCommand("paste",!1,null)}catch(h){o=e.childNodes.length>1||e.firstChild&&e.firstChild.childNodes.length>0}this._ignorePaste=!1;if(!o)return b?(n.setTimeout(function(){l.focus();(f=q())&&d&&d(f);l._ignoreFocus=!1},0),null):(this.focus(),this._ignoreFocus=!1,"");this.focus();
this._ignoreFocus=!1;(f=q())&&d&&d(f);return f}return b&&b.clipboardData?(g=[],f=b.clipboardData.getData("text/plain"),c(f,function(b){g.push(b)},function(){g.push(i)}),(f=g.join(""))&&d&&d(f),f):""},_getDOMText:function(b,d){for(var c=b.firstChild,a="",i=0;c;){var n;if(c.ignoreChars){n=c.lastChild;for(var g=0,f=[],e=-1;n;){for(var l=n.data,q=l.length-1;q>=0;q--){var o=l.substring(q,q+1);g<c.ignoreChars&&(o===" "||o==="\u200c"||o==="\ufeff")?g++:f.push(o==="\u00a0"?"\t":o)}if(d===n)e=f.length;n=n.previousSibling}f=
f.reverse().join("");e!==-1&&(i=a.length+f.length-e);a+=f}else for(n=c.firstChild;n;){if(d===n)i=a.length;a+=n.data;n=n.nextSibling}c=c.nextSibling}return{text:a,offset:i}},_getTextFromElement:function(b){var d=b.ownerDocument,c=d.defaultView;if(!c.getSelection)return b.innerText||b.textContent;d=d.createRange();d.selectNode(b);var b=c.getSelection(),c=[],a;for(a=0;a<b.rangeCount;a++)c.push(b.getRangeAt(a));this._ignoreSelect=!0;b.removeAllRanges();b.addRange(d);d=b.toString();b.removeAllRanges();
for(a=0;a<c.length;a++)b.addRange(c[a]);this._ignoreSelect=!1;return d},_getViewPadding:function(){return this._metrics.viewPadding},_getLine:function(b){var d=this._getLineNode(b);return d&&!d.lineChanged&&!d.lineRemoved?d._line:new s(this,b)},_getLineHeight:function(b,d){if(b!==void 0&&this._lineHeight){var c=this._lineHeight[b];if(c)return c;if(d||d===void 0)return this._lineHeight[b]=this._calculateLineHeight(b)}return this._metrics.lineHeight},_getLineNode:function(b){for(var d=this._clientDiv.firstChild;d;){if(b===
d.lineIndex)return d;d=d.nextSibling}},_getLineNext:function(b){for(b=b?b.nextSibling:this._clientDiv.firstChild;b&&b.lineIndex===-1;)b=b.nextSibling;return b},_getLinePrevious:function(b){for(b=b?b.previousSibling:this._clientDiv.lastChild;b&&b.lineIndex===-1;)b=b.previousSibling;return b},_getLinePixel:function(b){b=Math.min(Math.max(0,b),this._model.getLineCount());if(this._lineHeight){var d=this._getTopIndex(),c=-this._topIndexY+this._getScroll().y;if(b>d)for(;d<b;d++)c+=this._getLineHeight(d);
else for(d-=1;d>=b;d--)c-=this._getLineHeight(d);return c}return this._getLineHeight()*b},_getLineIndex:function(b){var d,c=0,a=this._model.getLineCount();if(this._lineHeight){var c=this._getTopIndex(),i=-this._topIndexY+this._getScroll().y;if(b!==i)if(b<i)for(;b<i&&c>0;)b+=this._getLineHeight(--c);else for(d=this._getLineHeight(c);b-d>=i&&c<a-1;)b-=d,d=this._getLineHeight(++c)}else d=this._getLineHeight(),c=Math.floor(b/d);return Math.max(0,Math.min(a-1,c))},_getScroll:function(b){(b===void 0||b)&&
this._cancelAnimation();b=this._viewDiv;return{x:b.scrollLeft,y:b.scrollTop}},_getSelection:function(){return this._selection.clone()},_getTopIndex:function(b){var d=this._topChild;if(b&&this._getClientHeight()>this._getLineHeight()){var b=d.getBoundingClientRect(),c=this._getViewPadding(),a=this._viewDiv.getBoundingClientRect();b.top<a.top+c.top&&(d=this._getLineNext(d)||d)}return d.lineIndex},_hookEvents:function(){var b=this;this._modelListener={onChanging:function(d){b._onModelChanging(d)},onChanged:function(d){b._onModelChanged(d)}};
this._model.addEventListener("preChanging",this._modelListener.onChanging);this._model.addEventListener("postChanged",this._modelListener.onChanged);this._themeListener={onChanged:function(){b._setThemeClass(b._themeClass)}};this._theme.addEventListener("ThemeChanged",this._themeListener.onChanged);var d=this._handlers=[],c=this._clientDiv,i=this._viewDiv,g=this._rootDiv,n=this._overlayDiv||c,f=c.ownerDocument,l=this._getWindow(),q=a.isIE?f:l;d.push({target:l,type:"resize",handler:function(d){return b._handleResize(d?
d:l.event)}});d.push({target:c,type:"blur",handler:function(d){return b._handleBlur(d?d:l.event)}});d.push({target:c,type:"focus",handler:function(d){return b._handleFocus(d?d:l.event)}});d.push({target:i,type:"focus",handler:function(){c.focus()}});d.push({target:i,type:"scroll",handler:function(d){return b._handleScroll(d?d:l.event)}});d.push({target:c,type:"textInput",handler:function(d){return b._handleTextInput(d?d:l.event)}});d.push({target:c,type:"keydown",handler:function(d){return b._handleKeyDown(d?
d:l.event)}});d.push({target:c,type:"keypress",handler:function(d){return b._handleKeyPress(d?d:l.event)}});d.push({target:c,type:"keyup",handler:function(d){return b._handleKeyUp(d?d:l.event)}});d.push({target:c,type:"contextmenu",handler:function(d){return b._handleContextMenu(d?d:l.event)}});d.push({target:c,type:"copy",handler:function(d){return b._handleCopy(d?d:l.event)}});d.push({target:c,type:"cut",handler:function(d){return b._handleCut(d?d:l.event)}});d.push({target:c,type:"paste",handler:function(d){return b._handlePaste(d?
d:l.event)}});if(a.isIOS||a.isAndroid)d.push({target:f,type:"selectionchange",handler:function(d){return b._handleSelectionChange(d?d:l.event)}}),d.push({target:c,type:"touchstart",handler:function(d){return b._handleTouchStart(d?d:l.event)}}),d.push({target:c,type:"touchmove",handler:function(d){return b._handleTouchMove(d?d:l.event)}}),d.push({target:c,type:"touchend",handler:function(d){return b._handleTouchEnd(d?d:l.event)}});else{d.push({target:c,type:"selectstart",handler:function(d){return b._handleSelectStart(d?
d:l.event)}});d.push({target:c,type:"mousedown",handler:function(d){return b._handleMouseDown(d?d:l.event)}});d.push({target:c,type:"mouseover",handler:function(d){return b._handleMouseOver(d?d:l.event)}});d.push({target:c,type:"mouseout",handler:function(d){return b._handleMouseOut(d?d:l.event)}});d.push({target:q,type:"mouseup",handler:function(d){return b._handleMouseUp(d?d:l.event)}});d.push({target:q,type:"mousemove",handler:function(d){return b._handleMouseMove(d?d:l.event)}});d.push({target:g,
type:"mousedown",handler:function(d){return b._handleRootMouseDown(d?d:l.event)}});d.push({target:g,type:"mouseup",handler:function(d){return b._handleRootMouseUp(d?d:l.event)}});d.push({target:n,type:"dragstart",handler:function(d){return b._handleDragStart(d?d:l.event)}});d.push({target:n,type:"drag",handler:function(d){return b._handleDrag(d?d:l.event)}});d.push({target:n,type:"dragend",handler:function(d){return b._handleDragEnd(d?d:l.event)}});d.push({target:n,type:"dragenter",handler:function(d){return b._handleDragEnter(d?
d:l.event)}});d.push({target:n,type:"dragover",handler:function(d){return b._handleDragOver(d?d:l.event)}});d.push({target:n,type:"dragleave",handler:function(d){return b._handleDragLeave(d?d:l.event)}});d.push({target:n,type:"drop",handler:function(d){return b._handleDrop(d?d:l.event)}});d.push({target:this._clientDiv,type:a.isFirefox?"DOMMouseScroll":"mousewheel",handler:function(d){return b._handleMouseWheel(d?d:l.event)}});if(a.isFirefox&&(!a.isWindows||a.isFirefox>=15))(i=l.MutationObserver||
l.MozMutationObserver)?(this._mutationObserver=new i(function(d){b._handleDataModified(d)}),this._mutationObserver.observe(c,{subtree:!0,characterData:!0})):d.push({target:this._clientDiv,type:"DOMCharacterDataModified",handler:function(d){return b._handleDataModified(d?d:l.event)}});this._overlayDiv&&(d.push({target:this._overlayDiv,type:"mousedown",handler:function(d){return b._handleMouseDown(d?d:l.event)}}),d.push({target:this._overlayDiv,type:"mouseover",handler:function(d){return b._handleMouseOver(d?
d:l.event)}}),d.push({target:this._overlayDiv,type:"mouseout",handler:function(d){return b._handleMouseOut(d?d:l.event)}}),d.push({target:this._overlayDiv,type:"contextmenu",handler:function(d){return b._handleContextMenu(d?d:l.event)}}));this._isW3CEvents||d.push({target:this._clientDiv,type:"dblclick",handler:function(d){return b._handleDblclick(d?d:l.event)}})}i=this._leftDiv;g=this._rightDiv;a.isIE&&d.push({target:i,type:"selectstart",handler:function(){return!1}});d.push({target:i,type:a.isFirefox?
"DOMMouseScroll":"mousewheel",handler:function(d){return b._handleMouseWheel(d?d:l.event)}});d.push({target:i,type:"click",handler:function(d){b._handleRulerEvent(d?d:l.event)}});d.push({target:i,type:"dblclick",handler:function(d){b._handleRulerEvent(d?d:l.event)}});d.push({target:i,type:"mousemove",handler:function(d){b._handleRulerEvent(d?d:l.event)}});d.push({target:i,type:"mouseover",handler:function(d){b._handleRulerEvent(d?d:l.event)}});d.push({target:i,type:"mouseout",handler:function(d){b._handleRulerEvent(d?
d:l.event)}});a.isIE&&d.push({target:g,type:"selectstart",handler:function(){return!1}});d.push({target:g,type:a.isFirefox?"DOMMouseScroll":"mousewheel",handler:function(d){return b._handleMouseWheel(d?d:l.event)}});d.push({target:g,type:"click",handler:function(d){b._handleRulerEvent(d?d:l.event)}});d.push({target:g,type:"dblclick",handler:function(d){b._handleRulerEvent(d?d:l.event)}});d.push({target:g,type:"mousemove",handler:function(d){b._handleRulerEvent(d?d:l.event)}});d.push({target:g,type:"mouseover",
handler:function(d){b._handleRulerEvent(d?d:l.event)}});d.push({target:g,type:"mouseout",handler:function(d){b._handleRulerEvent(d?d:l.event)}});for(i=0;i<d.length;i++)g=d[i],e(g.target,g.type,g.handler,g.capture)},_getWindow:function(){return this._parent.ownerDocument.defaultView||this._parent.ownerDocument.parentWindow},_init:function(b){var d=b.parent;typeof d==="string"&&(d=(b.document||document).getElementById(d));if(!d)throw"no parent";b.parent=d;b.model=b.model||new p.TextModel;var c=this._defaultOptions(),
i;for(i in c)c.hasOwnProperty(i)&&(this["_"+i]=b[i]!==void 0?b[i]:c[i].value);this._rulers=[];this._selection=new l(0,0,!1);this._linksVisible=!1;this._maxLineWidth=this._redrawCount=0;this._maxLineIndex=-1;this._ignoreSelect=!0;this._hasFocus=this._ignoreFocus=!1;this._dragOffset=this._columnX=-1;this._isRangeRects=(!a.isIE||a.isIE>=9)&&typeof d.ownerDocument.createRange().getBoundingClientRect==="function";this._isW3CEvents=d.addEventListener;this._autoScrollTimerID=this._autoScrollY=this._autoScrollX=
null;this._AUTO_SCROLL_RATE=50;this._mouseUpClosure=this._moseMoveClosure=this._grabControl=null;this._clickCount=this._lastMouseTime=this._lastMouseY=this._lastMouseX=0;this._clickTime=250;this._clickDist=5;this._isMouseDown=!1;this._doubleClickSelection=null;this._vScroll=this._hScroll=0;this._imeOffset=-1;this._createActions();this._createView()},_modifyContent:function(b,d){if(!this._readonly||b._code)if(b.type="Verify",this.onVerify(b),!(b.text===null||b.text===void 0)){var c=this._model;try{if(b._ignoreDOMSelection)this._ignoreDOMSelection=
!0;c.setText(b.text,b.start,b.end)}finally{if(b._ignoreDOMSelection)this._ignoreDOMSelection=!1}d&&(c=this._getSelection(),c.setCaret(b.start+b.text.length),this._setSelection(c,!0));this.onModify({type:"Modify"})}},_onModelChanged:function(b){b.type="ModelChanged";this.onModelChanged(b);b.type="Changed";var d=b.start,c=b.addedCharCount,a=b.removedCharCount,i=b.addedLineCount,n=b.removedLineCount,g=this._getSelection();g.end>d&&(g.end>d&&g.start<d+a?g.setCaret(d+c):(g.start+=c-a,g.end+=c-a),this._setSelection(g,
!1,!1));d=this._model.getLineAtOffset(d);for(c=this._getLineNext();c;){a=c.lineIndex;if(d<=a&&a<=d+n)d===a&&!c.modelChangedEvent&&!c.lineRemoved?(c.modelChangedEvent=b,c.lineChanged=!0):(c.lineRemoved=!0,c.lineChanged=!1,c.modelChangedEvent=null);if(a>d+n)c.lineIndex=a+i-n,c._line.lineIndex=c.lineIndex;c=this._getLineNext(c)}if(!this._wrapMode&&d<=this._maxLineIndex&&this._maxLineIndex<=d+n)this._checkMaxLineIndex=this._maxLineIndex,this._maxLineIndex=-1,this._maxLineWidth=0;this._update()},_onModelChanging:function(b){b.type=
"ModelChanging";this.onModelChanging(b);b.type="Changing"},_queueUpdate:function(){if(!this._updateTimer&&!this._ignoreQueueUpdate){var b=this;this._updateTimer=this._getWindow().setTimeout(function(){b._updateTimer=null;b._update()},0)}},_resetLineHeight:function(b,d){if(this._wrapMode){if(b!==void 0&&d!==void 0)for(var c=b;c<d;c++)this._lineHeight[c]=void 0;else this._lineHeight=Array(this._model.getLineCount());this._calculateLineHeightTimer()}else this._lineHeight=null},_resetLineWidth:function(){var b=
this._clientDiv;if(b)for(b=b.firstChild;b;)b.lineWidth=void 0,b=b.nextSibling},_reset:function(){this._maxLineIndex=-1;this._maxLineWidth=0;this._columnX=-1;this._bottomChild=this._topChild=null;this._topIndexY=0;this._resetLineHeight();this._setSelection(new l(0,0,!1),!1,!1);if(this._viewDiv)this._viewDiv.scrollLeft=0,this._viewDiv.scrollTop=0;var b=this._clientDiv;if(b){for(var d=b.firstChild;d;)d.lineRemoved=!0,d=d.nextSibling;if(a.isFirefox)this._ignoreFocus=!1,(d=this._hasFocus)&&b.blur(),b.contentEditable=
!1,b.contentEditable=!0,d&&b.focus(),this._ignoreFocus=!1}},_scrollViewAnimated:function(b,d,c){if(c&&this._scrollAnimation){var a=this;this._animation=new v({window:this._getWindow(),duration:this._scrollAnimation,curve:[d,0],onAnimate:function(b){b=d-Math.floor(b);a._scrollView(0,b);d-=b},onEnd:function(){a._animation=null;a._scrollView(b,d);c&&c()}});this._animation.play()}else this._scrollView(b,d),c&&c()},_scrollView:function(b,d){this._ensureCaretVisible=!1;var c=this._viewDiv;b&&(c.scrollLeft+=
b);d&&(c.scrollTop+=d)},_setClipboardText:function(b,d){var i,g=this._parent.ownerDocument,f=this._getWindow();if(f.clipboardData)return i=[],c(b,function(b){i.push(b)},function(){i.push(a.platformDelimiter)}),f.clipboardData.setData("Text",i.join(""));if(d&&d.clipboardData&&(i=[],c(b,function(b){i.push(b)},function(){i.push(a.platformDelimiter)}),d.clipboardData.setData("text/plain",i.join(""))))return!0;var n=a.createElement(g,"pre");n.style.position="fixed";n.style.left="-1000px";c(b,function(b){n.appendChild(g.createTextNode(b))},
function(){n.appendChild(a.createElement(g,"br"))});n.appendChild(g.createTextNode(" "));this._clientDiv.appendChild(n);var e=g.createRange();e.setStart(n.firstChild,0);e.setEndBefore(n.lastChild);var l=f.getSelection();l.rangeCount>0&&l.removeAllRanges();l.addRange(e);var q=this,e=function(){n&&n.parentNode===q._clientDiv&&q._clientDiv.removeChild(n);q._updateDOMSelection()},l=!1;this._ignoreCopy=!0;try{l=g.execCommand("copy",!1,null)}catch(o){}this._ignoreCopy=!1;if(!l&&d)return f.setTimeout(e,
0),!1;e();return!0},_setDOMSelection:function(b,d,c,i){for(var g,n,f,e,l=0,q=b.firstChild,o,h,s=this._model.getLine(b.lineIndex).length;q;){o=q.firstChild;h=o.length;q.ignoreChars&&(h-=q.ignoreChars);if(l+h>d||l+h>=s){g=o;n=d-l;q.ignoreChars&&h>0&&n===h&&(n+=q.ignoreChars);break}l+=h;q=q.nextSibling}for(var l=0,q=c.firstChild,k=this._model.getLine(c.lineIndex).length;q;){o=q.firstChild;h=o.length;q.ignoreChars&&(h-=q.ignoreChars);if(h+l>i||l+h>=k){f=o;e=i-l;q.ignoreChars&&h>0&&e===h&&(e+=q.ignoreChars);
break}l+=h;q=q.nextSibling}this._setDOMFullSelection(b,d,s,c,i,k);if(this._hasFocus)if(d=this._getWindow(),b=this._parent.ownerDocument,d.getSelection){if(d=d.getSelection(),!(d.anchorNode===g&&d.anchorOffset===n&&d.focusNode===f&&d.focusOffset===e||d.anchorNode===f&&d.anchorOffset===e&&d.focusNode===g&&d.focusOffset===n))b=b.createRange(),b.setStart(g,n),b.setEnd(f,e),this._ignoreSelect=!1,d.rangeCount>0&&d.removeAllRanges(),d.addRange(b),this._ignoreSelect=!0}else if(b.selection)d=b.body,b=a.createElement(b,
"div"),d.appendChild(b),d.removeChild(b),b=d.createTextRange(),b.moveToElementText(g.parentNode),b.moveStart("character",n),g=d.createTextRange(),g.moveToElementText(f.parentNode),g.moveStart("character",e),b.setEndPoint("EndToStart",g),this._ignoreSelect=!1,b.select(),this._ignoreSelect=!0},_setDOMFullSelection:function(b,d,c,a,i){if(this._selDiv1&&(c=this._selDiv1,c.style.width="0px",c.style.height="0px",c=this._selDiv2,c.style.width="0px",c.style.height="0px",c=this._selDiv3,c.style.width="0px",
c.style.height="0px",!(b===a&&d===i))){var n=this._model,g=this._getViewPadding(),f=this._clientDiv.getBoundingClientRect(),e=this._viewDiv.getBoundingClientRect(),c=e.left+g.left,l=f.right,g=e.top+g.top,q=f.bottom,e=f=0;this._clipDiv?(e=this._clipDiv.getBoundingClientRect(),f=e.left-this._clipDiv.scrollLeft):(e=this._rootDiv.getBoundingClientRect(),f=e.left);e=e.top;this._ignoreDOMSelection=!0;var b=(new s(this,b.lineIndex,b)).getBoundingClientRect(n.getLineStart(b.lineIndex)+d,!1),o=b.left,i=(new s(this,
a.lineIndex,a)).getBoundingClientRect(n.getLineStart(a.lineIndex)+i,!1),d=i.left;this._ignoreDOMSelection=!1;var n=this._selDiv1,o=Math.min(l,Math.max(c,o)),h=Math.min(q,Math.max(g,b.top)),k=l,a=Math.min(q,Math.max(g,b.bottom));n.style.left=o-f+"px";n.style.top=h-e+"px";n.style.width=Math.max(0,k-o)+"px";n.style.height=Math.max(0,a-h)+"px";if(b.top===i.top)k=Math.min(d,l),n.style.width=Math.max(0,k-o)+"px";else if(b=Math.min(q,Math.max(g,i.top)),d=Math.min(l,Math.max(c,d)),g=Math.min(q,Math.max(g,
i.bottom)),q=this._selDiv3,q.style.left=c-f+"px",q.style.top=b-e+"px",q.style.width=Math.max(0,d-c)+"px",q.style.height=Math.max(0,g-b)+"px",b-a>0)g=this._selDiv2,g.style.left=c-f+"px",g.style.top=a-e+"px",g.style.width=Math.max(0,l-c)+"px",g.style.height=Math.max(0,b-a)+"px"}},_setGrab:function(b){if(b!==this._grabControl)b?(b.setCapture&&b.setCapture(),this._grabControl=b):(this._grabControl.releaseCapture&&this._grabControl.releaseCapture(),this._grabControl=null)},_setLinksVisible:function(b){if(this._linksVisible!==
b){this._linksVisible=b;if(a.isIE&&b)this._hadFocus=this._hasFocus;var d=this._clientDiv;d.contentEditable=!b;this._hadFocus&&!b&&d.focus();if(this._overlayDiv)this._overlayDiv.style.zIndex=b?"-1":"1";for(b=this._getLineNext();b;){if(b.hasLink)for(d=b.firstChild;d;){var c=d.nextSibling,i=d.viewStyle;i&&i.tagName==="A"&&b.replaceChild(b._line._createSpan(b,d.firstChild.data,i),d);d=c}b=this._getLineNext(b)}}},_setSelection:function(b,d,c,a,i){if(b){this._columnX=-1;c===void 0&&(c=!0);var g=this._selection;
this._selection=b;d!==!1&&this._showCaret(!1,a,d,i);c&&this._updateDOMSelection();if(!g.equals(b))this.onSelection({type:"Selection",oldValue:{start:g.start,end:g.end},newValue:{start:b.start,end:b.end}})}},_setSelectionTo:function(b,d,c,a){var i=this._model,g=this._getSelection(),d=this.convert({x:b,y:d},"page","document"),b=this._getLineIndex(d.y);if(this._clickCount===1){i=this._getLine(b);b=i.getOffset(d.x,d.y-this._getLinePixel(b));i.destroy();if(a&&!c&&g.start<=b&&b<g.end)return this._dragOffset=
b,!1;g.extend(b);c||g.collapse()}else(this._clickCount&1)===0?(i=this._getLine(b),b=i.getOffset(d.x,d.y-this._getLinePixel(b)),this._doubleClickSelection?b>=this._doubleClickSelection.start?(c=this._doubleClickSelection.start,a=i.getNextOffset(b,"wordend",1)):(c=i.getNextOffset(b,"word",-1),a=this._doubleClickSelection.end):(c=i.getNextOffset(b,"word",-1),a=i.getNextOffset(c,"wordend",1)),i.destroy()):this._doubleClickSelection?(a=i.getLineAtOffset(this._doubleClickSelection.start),b>=a?(c=i.getLineStart(a),
a=i.getLineEnd(b)):(c=i.getLineStart(b),a=i.getLineEnd(a))):(c=i.getLineStart(b),a=i.getLineEnd(b)),g.setCaret(c),g.extend(a);this._setSelection(g,!0,!0);return!0},_setFullSelection:function(b,d){this._fullSelection=b;if(a.isWebkit)this._fullSelection=!0;var c=this._clipDiv||this._rootDiv;if(c)if(this._fullSelection){if(!this._selDiv1&&this._fullSelection&&!a.isIOS){var i=c.ownerDocument;this._highlightRGB=a.isWebkit?"transparent":"Highlight";var g=a.createElement(i,"div");this._selDiv1=g;g.style.position=
"absolute";g.style.borderWidth="0px";g.style.margin="0px";g.style.padding="0px";g.style.outline="none";g.style.background=this._highlightRGB;g.style.width="0px";g.style.height="0px";g.style.zIndex="0";c.appendChild(g);var n=a.createElement(i,"div");this._selDiv2=n;n.style.position="absolute";n.style.borderWidth="0px";n.style.margin="0px";n.style.padding="0px";n.style.outline="none";n.style.background=this._highlightRGB;n.style.width="0px";n.style.height="0px";n.style.zIndex="0";c.appendChild(n);this._selDiv3=
i=a.createElement(i,"div");i.style.position="absolute";i.style.borderWidth="0px";i.style.margin="0px";i.style.padding="0px";i.style.outline="none";i.style.background=this._highlightRGB;i.style.width="0px";i.style.height="0px";i.style.zIndex="0";c.appendChild(i);if(a.isFirefox&&a.isMac){c=this._getWindow().getComputedStyle(i,null).getPropertyValue("background-color");switch(c){case "rgb(119, 141, 168)":c="rgb(199, 208, 218)";break;case "rgb(127, 127, 127)":c="rgb(198, 198, 198)";break;case "rgb(255, 193, 31)":c=
"rgb(250, 236, 115)";break;case "rgb(243, 70, 72)":c="rgb(255, 176, 139)";break;case "rgb(255, 138, 34)":c="rgb(255, 209, 129)";break;case "rgb(102, 197, 71)":c="rgb(194, 249, 144)";break;case "rgb(140, 78, 184)":c="rgb(232, 184, 255)";break;default:c="rgb(180, 213, 255)"}this._highlightRGB=c;g.style.background=c;n.style.background=c;i.style.background=c}d||this._updateDOMSelection()}}else{if(this._selDiv1)c.removeChild(this._selDiv1),this._selDiv1=null;if(this._selDiv2)c.removeChild(this._selDiv2),
this._selDiv2=null;if(this._selDiv3)c.removeChild(this._selDiv3),this._selDiv3=null}},_setReadOnly:function(b){this._readonly=b;this._clientDiv.setAttribute("aria-readonly",b?"true":"false")},_setTabSize:function(b,d){this._tabSize=b;this._customTabSize=void 0;var c=this._clientDiv;if(a.isOpera){if(c)c.style.OTabSize=this._tabSize+""}else if(a.isWebkit>=537.1){if(c)c.style.tabSize=this._tabSize+""}else if(a.isFirefox>=4){if(c)c.style.MozTabSize=this._tabSize+""}else if(this._tabSize!==8)this._customTabSize=
this._tabSize;d||(this.redrawLines(),this._resetLineWidth())},_setTheme:function(b){this._theme&&this._theme.removeEventListener("ThemeChanged",this._themeListener.onChanged);(this._theme=b)&&this._theme.addEventListener("ThemeChanged",this._themeListener.onChanged);this._setThemeClass(this._themeClass)},_setThemeClass:function(b,d){this._themeClass=b;var c="textview",a=this._theme.getThemeClass();a&&(c+=" "+a);this._themeClass&&a!==this._themeClass&&(c+=" "+this._themeClass);this._rootDiv.className=
c;this._updateStyle(d)},_setWrapMode:function(b,d){this._wrapMode=b;var c=this._clientDiv,a=this._viewDiv;b?(c.style.whiteSpace="pre-wrap",c.style.wordWrap="break-word",a.style.overflowX="hidden",a.style.overflowY="scroll"):(c.style.whiteSpace="pre",c.style.wordWrap="normal",a.style.overflowX="auto",a.style.overflowY="auto");d||(this.redraw(),this._resetLineWidth());this._resetLineHeight()},_showCaret:function(b,d,c,a){if(this._clientDiv){var i=this._model,g=this._getSelection(),f=this._getScroll(),
e=g.getCaret(),l=g.start,q=g.end,o=i.getLineAtOffset(q),h=Math.max(Math.max(l,i.getLineStart(o)),q-1),i=this._getClientWidth(),o=this._getClientHeight(),s=i/4,k=this._getBoundsAtOffset(e===l?l:h),u=k.left,m=k.right,v=k.top,p=k.bottom;b&&!g.isEmpty()&&(k=this._getBoundsAtOffset(e===q?l:h),k.top===v?e===l?m=u+Math.min(k.right-u,i):u=m-Math.min(m-k.left,i):e===l?p=v+Math.min(k.bottom-v,o):v=p-Math.min(p-k.top,o));b=0;u<f.x&&(b=Math.min(u-f.x,-s));m>f.x+i&&(b=Math.max(m-f.x-i,s));g=0;v<f.y?g=v-f.y:p>
f.y+o&&(g=p-f.y-o);a&&(a>0?g>0&&(g=Math.max(g,a)):g<0&&(g=Math.min(g,a)));return b!==0||g!==0?(g!==0&&typeof c==="number"&&(c<0&&(c=0),c>1&&(c=1),g+=Math.floor(g>0?c*o:-c*o)),this._scrollViewAnimated(b,g,d),o!==this._getClientHeight()||i!==this._getClientWidth()?this._showCaret():this._ensureCaretVisible=!0,!0):!1}},_startIME:function(){if(this._imeOffset===-1){var b=this._getSelection();b.isEmpty()||this._modifyContent({text:"",start:b.start,end:b.end},!0);this._imeOffset=b.start}},_unhookEvents:function(){this._model.removeEventListener("preChanging",
this._modelListener.onChanging);this._model.removeEventListener("postChanged",this._modelListener.onChanged);this._theme.removeEventListener("ThemeChanged",this._themeListener.onChanged);this._modelListener=null;for(var b=0;b<this._handlers.length;b++){var d=this._handlers[b],c=d.target,a=d.type,d=d.handler;typeof c.removeEventListener==="function"?c.removeEventListener(a,d,!1):c.detachEvent("on"+a,d)}this._handlers=null;if(this._mutationObserver)this._mutationObserver.disconnect(),this._mutationObserver=
null},_updateDOMSelection:function(){if(!this._ignoreDOMSelection&&this._clientDiv){var b=this._getSelection(),d=this._model,c=d.getLineAtOffset(b.start),a=d.getLineAtOffset(b.end),i=this._getLineNext();if(i){var g=this._getLinePrevious(),f;c<i.lineIndex?(f=i,c=0):c>g.lineIndex?(f=g,c=0):(f=this._getLineNode(c),c=b.start-d.getLineStart(c));a<i.lineIndex?b=0:a>g.lineIndex?(i=g,b=0):(i=this._getLineNode(a),b=b.end-d.getLineStart(a));this._setDOMSelection(f,c,i,b)}}},_update:function(b){if(!(this._redrawCount>
0)){if(this._updateTimer)this._getWindow().clearTimeout(this._updateTimer),this._updateTimer=null,b=!1;var d=this._clientDiv;if(d){if(this._metrics.invalid)this._ignoreQueueUpdate=!0,this._updateStyle(),this._ignoreQueueUpdate=!1;var c=this._model,i=this._getScroll(!1),g=this._getViewPadding(),n=c.getLineCount(),f=this._getLineHeight(),e=this._getClientWidth();if(this._wrapMode)d.style.width=e+"px";var l,q,o,h,k=0,u=0;if(this._lineHeight){for(;u<n;){o=this._getLineHeight(u);if(k+o>i.y)break;k+=o;
u++}l=u;q=Math.max(0,l-1);o=c=i.y-k;l>0&&(c+=this._getLineHeight(l-1))}else h=Math.max(0,i.y)/f,l=Math.floor(h),q=Math.max(0,l-1),c=Math.round((h-q)*f),o=Math.round((h-l)*f);this._topIndexY=o;h=this._parent;var m=h.clientWidth,v=h.clientHeight;h=this._getClientHeight();if(b){q=0;this._leftDiv&&(l=this._leftDiv.getBoundingClientRect(),q=l.right-l.left);l=e;for(this._wrapMode||(l=Math.max(this._maxLineWidth,l));u<n;)o=this._getLineHeight(u,!1),k+=o,u++;n=k}else{var e=this._viewDiv,f=Math.min(l+Math.floor((h+
o)/f),n-1),i=Math.min(f+1,n-1),p;for(o=d.firstChild;o;){p=o.lineIndex;var t=o.nextSibling;if(!(q<=p&&p<=i)||o.lineRemoved||o.lineIndex===-1)this._mouseWheelLine===o?(o.style.display="none",o.lineIndex=-1):d.removeChild(o);o=t}o=this._getLineNext();var t=e.ownerDocument,y=t.createDocumentFragment();for(p=q;p<=i;p++)if(!o||o.lineIndex>p)(new s(this,p)).create(y,null);else{y.firstChild&&(d.insertBefore(y,o),y=t.createDocumentFragment());if(o&&o.lineChanged)o=(new s(this,p)).create(y,o),o.lineChanged=
!1;o=this._getLineNext(o)}y.firstChild&&d.insertBefore(y,o);if(a.isWebkit&&!this._wrapMode)d.style.width="0x7fffffffpx";o=this._getLineNext();p=h+c;for(y=!1;o;){q=o.lineWidth;if(q===void 0)t=o._line.getBoundingClientRect(),q=o.lineWidth=Math.ceil(t.right-t.left),this._lineHeight&&(this._lineHeight[o.lineIndex]=Math.ceil(t.bottom-t.top));if(this._lineHeight&&!y&&(p-=this._lineHeight[o.lineIndex],p<0))f=o.lineIndex,y=!0;if(!this._wrapMode){if(q>=this._maxLineWidth)this._maxLineWidth=q,this._maxLineIndex=
o.lineIndex;if(this._checkMaxLineIndex===o.lineIndex)this._checkMaxLineIndex=-1}if(o.lineIndex===l)this._topChild=o;if(o.lineIndex===f)this._bottomChild=o;o=this._getLineNext(o)}if(this._checkMaxLineIndex!==-1&&(p=this._checkMaxLineIndex,this._checkMaxLineIndex=-1,0<=p&&p<n)){o=new s(this,p);t=o.getBoundingClientRect();q=t.right-t.left;if(q>=this._maxLineWidth)this._maxLineWidth=q,this._maxLineIndex=p;o.destroy()}for(;u<n;)o=this._getLineHeight(u,u<=f),k+=o,u++;n=k;this._updateRuler(this._leftDiv,
l,i,v);this._updateRuler(this._rightDiv,l,i,v);q=0;this._leftDiv&&(l=this._leftDiv.getBoundingClientRect(),q=l.right-l.left);i=0;this._rightDiv&&(i=this._rightDiv.getBoundingClientRect(),i=i.right-i.left);e.style.left=q+"px";e.style.right=i+"px";i=this._scrollDiv;i.style.height=n+"px";k=e=this._getClientWidth();this._wrapMode||(k=Math.max(this._maxLineWidth,k));l=k;if((!a.isIE||a.isIE>=9)&&this._maxLineWidth>e)k+=g.right+g.left;i.style.width=k+"px";if(this._clipScrollDiv)this._clipScrollDiv.style.width=
k+"px";i=this._getScroll(!1)}if(this._vScrollDiv)k=h-8,u=Math.max(15,Math.ceil(Math.min(1,k/(n+g.top+g.bottom))*k)),this._vScrollDiv.style.left=q+e-8+"px",this._vScrollDiv.style.top=Math.floor(Math.max(0,i.y*k/n))+"px",this._vScrollDiv.style.height=u+"px";if(!this._wrapMode&&this._hScrollDiv)k=e-8,u=Math.max(15,Math.ceil(Math.min(1,k/(this._maxLineWidth+g.left+g.right))*k)),this._hScrollDiv.style.left=q+Math.floor(Math.max(0,Math.floor(i.x*k/this._maxLineWidth)))+"px",this._hScrollDiv.style.top=h-
9+"px",this._hScrollDiv.style.width=u+"px";p=i.x;o=this._clipDiv;k=this._overlayDiv;if(o){o.scrollLeft=p;u=q+g.left;f=g.top;b=e;q=h;p=0;t=-c;if(i.x===0)u-=g.left,b+=g.left,p=g.left;i.x+e===l&&(b+=g.right);i.y===0&&(f-=g.top,q+=g.top,t+=g.top);i.y+h===n&&(q+=g.bottom);o.style.left=u+"px";o.style.top=f+"px";o.style.right=m-b-u+"px";o.style.bottom=v-q-f+"px";d.style.left=p+"px";d.style.top=t+"px";d.style.width=l+"px";d.style.height=h+c+"px";if(k)k.style.left=d.style.left,k.style.top=d.style.top,k.style.width=
d.style.width,k.style.height=d.style.height}else{u=p;f=c;m=p+e;v=c+h;u===0&&(u-=g.left);f===0&&(f-=g.top);m===l&&(m+=g.right);i.y+h===n&&(v+=g.bottom);d.style.clip="rect("+f+"px,"+m+"px,"+v+"px,"+u+"px)";d.style.left=-p+q+g.left+"px";d.style.width=(a.isWebkit?l:e+p)+"px";if(!b)d.style.top=-c+g.top+"px",d.style.height=h+c+"px";if(k&&(k.style.clip=d.style.clip,k.style.left=d.style.left,k.style.width=d.style.width,!b))k.style.top=d.style.top,k.style.height=d.style.height}this._updateDOMSelection();d=
this._ensureCaretVisible;this._ensureCaretVisible=!1;h!==this._getClientHeight()&&(this._update(),d&&this._showCaret())}}},_updateRuler:function(b,d,c,i){if(b)for(var g=this._parent.ownerDocument,n=this._getLineHeight(),e=this._getViewPadding(),b=b.firstChild;b;){var l=b._ruler,q=n,o=l.getOverview();o==="page"&&(q+=this._topIndexY);b.style.top=-q+"px";b.style.height=i+q+"px";b.rulerChanged&&f(l.getRulerStyle(),b);var h,k=b.firstChild;k?(h=k,k=k.nextSibling):(h=a.createElement(g,"div"),h.style.visibility=
"hidden",b.appendChild(h));var s;if(b.rulerChanged&&h){q=-1;if(s=l.getWidestAnnotation())if(f(s.style,h),s.html)h.innerHTML=s.html;h.lineIndex=q;h.style.height=n+e.top+"px"}var u;if(o==="page"){for(l=l.getAnnotations(d,c+1);k;)q=k.lineIndex,s=k.nextSibling,(!(d<=q&&q<=c)||k.lineChanged)&&b.removeChild(k),k=s;k=b.firstChild.nextSibling;u=g.createDocumentFragment();for(q=d;q<=c;q++)if(!k||k.lineIndex>q){h=a.createElement(g,"div");if(s=l[q]){f(s.style,h);if(s.html)h.innerHTML=s.html;h.annotation=s}h.lineIndex=
q;h.style.height=this._getLineHeight(q)+"px";u.appendChild(h)}else if(u.firstChild&&(b.insertBefore(u,k),u=g.createDocumentFragment()),k)k=k.nextSibling;u.firstChild&&b.insertBefore(u,k)}else{s=this._getClientHeight();q=this._model.getLineCount();k=s+e.top+e.bottom-2*this._metrics.scrollWidth;o=n*q<k?n:k/q;if(b.rulerChanged){for(s=b.childNodes.length;s>1;)b.removeChild(b.lastChild),s--;l=l.getAnnotations(0,q);u=g.createDocumentFragment();for(var m in l)if(q=m>>>0,!(q<0)){h=a.createElement(g,"div");
s=l[m];f(s.style,h);h.style.position="absolute";h.style.top=this._metrics.scrollWidth+n+Math.floor(q*o)+"px";if(s.html)h.innerHTML=s.html;h.annotation=s;h.lineIndex=q;u.appendChild(h)}b.appendChild(u)}else if(b._oldTrackHeight!==k)for(h=b.firstChild?b.firstChild.nextSibling:null;h;)h.style.top=this._metrics.scrollWidth+n+Math.floor(h.lineIndex*o)+"px",h=h.nextSibling;b._oldTrackHeight=k}b.rulerChanged=!1;b=b.nextSibling}},_updateStyleSheet:function(){var b="";a.isWebkit&&this._metrics.scrollWidth>
0&&(b+="\n.textview ::-webkit-scrollbar-corner {background: #eeeeee;}");a.isFirefox&&a.isMac&&this._highlightRGB&&this._highlightRGB!=="Highlight"&&(b+="\n.textview ::-moz-selection {background: "+this._highlightRGB+";}");if(b){var d=document.getElementById("_textviewStyle");if(d)d.removeChild(d.firstChild),d.appendChild(document.createTextNode(b));else{d=a.createElement(document,"style");d.id="_textviewStyle";var c=document.getElementsByTagName("head")[0]||document.documentElement;d.appendChild(document.createTextNode(b));
c.insertBefore(d,c.firstChild)}}},_updateStyle:function(b){if(!b&&a.isIE)this._rootDiv.style.lineHeight="normal";var c=this._metrics=this._calculateMetrics();this._rootDiv.style.lineHeight=a.isIE?c.lineHeight-(c.lineTrim.top+c.lineTrim.bottom)+"px":"normal";this._updateStyleSheet();b||(this.redraw(),this._resetLineWidth())}};m.EventTarget.addMixin(u.prototype);return{TextView:u}});
define("orion/editor/projectionTextModel",["orion/editor/textModel","orion/editor/eventTarget"],function(p,t){function m(h){this._model=h;this._projections=[]}m.prototype={addProjection:function(h){if(h){var a=this._model,e=this._projections;h._lineIndex=a.getLineAtOffset(h.start);h._lineCount=a.getLineAtOffset(h.end)-h._lineIndex;var f=h.text;f||(f="");h._model=typeof f==="string"?new p.TextModel(f,a.getLineDelimiter()):f;var a=this.mapOffset(h.start,!0),f=h.end-h.start,k=h._lineCount,g=h._model.getCharCount(),
c=h._model.getLineCount()-1;this.onChanging({type:"Changing",text:h._model.getText(),start:a,removedCharCount:f,addedCharCount:g,removedLineCount:k,addedLineCount:c});var i=this._binarySearch(e,h.start);e.splice(i,0,h);this.onChanged({type:"Changed",start:a,removedCharCount:f,addedCharCount:g,removedLineCount:k,addedLineCount:c})}},getProjections:function(){return this._projections.slice(0)},getBaseModel:function(){return this._model},mapOffset:function(h,a){var e=this._projections,f=0,k,g;if(a){for(k=
0;k<e.length;k++){g=e[k];if(g.start>h)break;if(g.end>h)return-1;f+=g._model.getCharCount()-(g.end-g.start)}return h+f}for(k=0;k<e.length;k++){g=e[k];if(g.start>h-f)break;var c=g._model.getCharCount();if(g.start+c>h-f)return-1;f+=c-(g.end-g.start)}return h-f},removeProjection:function(h){var a,e=0;for(a=0;a<this._projections.length;a++){var f=this._projections[a];if(f===h){h=f;break}e+=f._model.getCharCount()-(f.end-f.start)}if(a<this._projections.length){var f=this._model,e=h.start+e,k=h.end-h.start,
g=h._lineCount,c=h._model.getCharCount(),i=h._model.getLineCount()-1;this.onChanging({type:"Changing",text:f.getText(h.start,h.end),start:e,removedCharCount:c,addedCharCount:k,removedLineCount:i,addedLineCount:g});this._projections.splice(a,1);this.onChanged({type:"Changed",start:e,removedCharCount:c,addedCharCount:k,removedLineCount:i,addedLineCount:g})}},_binarySearch:function(h,a){for(var e=h.length,f=-1,k;e-f>1;)k=Math.floor((e+f)/2),a<=h[k].start?e=k:f=k;return e},getCharCount:function(){for(var h=
this._model.getCharCount(),a=this._projections,e=0;e<a.length;e++){var f=a[e];h+=f._model.getCharCount()-(f.end-f.start)}return h},getLine:function(h,a){if(h<0)return null;var e=this._model,f=this._projections,k=0,g=[],c=0,i,q,l;for(i=0;i<f.length;i++){l=f[i];if(l._lineIndex>=h-k)break;q=l._model.getLineCount()-1;if(l._lineIndex+q>=h-k)if(c=h-(l._lineIndex+k),c<q)return l._model.getLine(c,a);else g.push(l._model.getLine(q));c=l.end;k+=q-l._lineCount}for(c=Math.max(c,e.getLineStart(h-k));i<f.length;i++){l=
f[i];if(l._lineIndex>h-k)break;g.push(e.getText(c,l.start));q=l._model.getLineCount()-1;if(l._lineIndex+q>h-k)return g.push(l._model.getLine(0,a)),g.join("");g.push(l._model.getText());c=l.end;k+=q-l._lineCount}f=e.getLineEnd(h-k,a);c<f&&g.push(e.getText(c,f));return g.join("")},getLineAtOffset:function(h){for(var a=this._model,e=this._projections,f=0,k=0,g=0;g<e.length;g++){var c=e[g];if(c.start>h-f)break;var i=c._model.getCharCount();if(c.start+i>h-f){e=h-(c.start+f);k+=c._model.getLineAtOffset(e);
f+=e;break}k+=c._model.getLineCount()-1-c._lineCount;f+=i-(c.end-c.start)}return a.getLineAtOffset(h-f)+k},getLineCount:function(){for(var h=this._projections,a=this._model.getLineCount(),e=0;e<h.length;e++){var f=h[e];a+=f._model.getLineCount()-1-f._lineCount}return a},getLineDelimiter:function(){return this._model.getLineDelimiter()},getLineEnd:function(h,a){if(h<0)return-1;for(var e=this._model,f=this._projections,k=0,g=0,c=0;c<f.length;c++){var i=f[c];if(i._lineIndex>h-k)break;var q=i._model.getLineCount()-
1;if(i._lineIndex+q>h-k)return i._model.getLineEnd(h-(i._lineIndex+k),a)+i.start+g;g+=i._model.getCharCount()-(i.end-i.start);k+=q-i._lineCount}return e.getLineEnd(h-k,a)+g},getLineStart:function(h){if(h<0)return-1;for(var a=this._model,e=this._projections,f=0,k=0,g=0;g<e.length;g++){var c=e[g];if(c._lineIndex>=h-f)break;var i=c._model.getLineCount()-1;if(c._lineIndex+i>=h-f)return c._model.getLineStart(h-(c._lineIndex+f))+c.start+k;k+=c._model.getCharCount()-(c.end-c.start);f+=i-c._lineCount}return a.getLineStart(h-
f)+k},getText:function(h,a){h===void 0&&(h=0);var e=this._model,f=this._projections,k=0,g=[],c,i,q;for(c=0;c<f.length;c++){i=f[c];if(i.start>h-k)break;q=i._model.getCharCount();if(i.start+q>h-k)if(a!==void 0&&i.start+q>a-k)return i._model.getText(h-(i.start+k),a-(i.start+k));else g.push(i._model.getText(h-(i.start+k))),h=i.end+k+q-(i.end-i.start);k+=q-(i.end-i.start)}var l=h-k;if(a!==void 0){for(;c<f.length;c++){i=f[c];if(i.start>a-k)break;g.push(e.getText(l,i.start));q=i._model.getCharCount();if(i.start+
q>a-k)return g.push(i._model.getText(0,a-(i.start+k))),g.join("");g.push(i._model.getText());l=i.end;k+=q-(i.end-i.start)}g.push(e.getText(l,a-k))}else{for(;c<f.length;c++)i=f[c],g.push(e.getText(l,i.start)),g.push(i._model.getText()),l=i.end;g.push(e.getText(l))}return g.join("")},_onChanging:function(h,a,e,f,k,g){for(var c=this._model,i=this._projections,q,l=0,o,s=a+e;q<i.length;q++){e=i[q];if(e.start>a)break;l+=e._model.getCharCount()-(e.end-e.start)}a+=l;for(var u=q;q<i.length;q++){e=i[q];if(e.start>
s)break;l+=e._model.getCharCount()-(e.end-e.start);o+=e._model.getLineCount()-1-e._lineCount}e=s+l;l=q;this.onChanging(a,e-a,f,k+o,g);i.splice(i,l-u);for(h=h.length-(e-a);q<i.length;q++)e=i[q],e.start+=h,e.end+=h,e._lineIndex=c.getLineAtOffset(e.start)},onChanging:function(h){return this.dispatchEvent(h)},onChanged:function(h){return this.dispatchEvent(h)},setLineDelimiter:function(h){this._model.setLineDelimiter(h)},setText:function(h,a,e){h===void 0&&(h="");a===void 0&&(a=0);var f=a,k=e,g=this._model,
c=this._projections,i=0,q=0,l,o,s,u,m,b=0;for(l=0;l<c.length;l++){o=c[l];if(o.start>a-i)break;s=o._model.getCharCount();if(o.start+s>a-i)if(e!==void 0&&o.start+s>e-i){o._model.setText(h,a-(o.start+i),e-(o.start+i));return}else b=o._model.getLineCount()-1-o._model.getLineAtOffset(a-(o.start+i)),u={projection:o,start:a-(o.start+i)},a=o.end+i+s-(o.end-o.start);q+=o._model.getLineCount()-1-o._lineCount;i+=s-(o.end-o.start)}a-=i;var d=l,b=g.getLineAtOffset(a)+q-b;if(e!==void 0)for(;l<c.length;l++){o=c[l];
if(o.start>e-i)break;s=o._model.getCharCount();if(o.start+s>e-i){q+=o._model.getLineAtOffset(e-(o.start+i));s=e-(o.start+i);e=o.end+i;m={projection:o,end:s};break}q+=o._model.getLineCount()-1-o._lineCount;i+=s-(o.end-o.start)}else{for(;l<c.length;l++)o=c[l],q+=o._model.getLineCount()-1-o._lineCount,i+=o._model.getCharCount()-(o.end-o.start);e=k=g.getCharCount()+i}e-=i;o=g.getLineAtOffset(e)+q;k-=f;for(var q=o-b,b=h.length,j=s=o=i=0;;){o!==-1&&o<=j&&(o=h.indexOf("\r",j));s!==-1&&s<=j&&(s=h.indexOf("\n",
j));if(s===-1&&o===-1)break;j=o!==-1&&s!==-1?o+1===s?s+1:(o<s?o:s)+1:o!==-1?o+1:s+1;i++}this.onChanging({type:"Changing",text:h,start:f,removedCharCount:k,addedCharCount:b,removedLineCount:q,addedLineCount:i});g.setText(h,a,e);if(u)o=u.projection,o._model.setText("",u.start);if(m)o=m.projection,o._model.setText("",0,m.end),o.start=o.end,o._lineCount=0;c.splice(d,l-d);for(h=h.length-(e-a);l<c.length;l++)o=c[l],o.start+=h,o.end+=h,o._lineIndex=g.getLineAtOffset(o.start);this.onChanged({type:"Changed",
start:f,removedCharCount:k,addedCharCount:b,removedLineCount:q,addedLineCount:i})}};t.EventTarget.addMixin(m.prototype);return{ProjectionTextModel:m}});
(function(){function p(a,e,f,h,g,c){e[a]&&(f.push(a),(e[a]===!0||e[a]===1)&&h.push(g+a+"/"+c))}function t(a,e,f,h,g){e=h+e+"/"+g;require._fileExists(a.toUrl(e+".js"))&&f.push(e)}function m(a,e,f){for(var h in e)e.hasOwnProperty(h)&&(!a.hasOwnProperty(h)||f)?a[h]=e[h]:typeof e[h]==="object"&&m(a[h],e[h],f)}var h=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(a){var e=a.config?a.config():{};return{version:"2.0.1+",load:function(a,k,g,c){c=c||{};if(c.locale)e.locale=c.locale;
var i=h.exec(a),q=i[1],l=i[4],o=i[5],s=l.split("-"),u=[],v={},b,d="";if(i[5])q=i[1],a=q+o;else{o=i[4];l=e.locale;if(!l)l=e.locale=typeof navigator==="undefined"?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase();s=l.split("-")}if(c.isBuild){u.push(a);t(k,"root",u,q,o);for(b=0;b<s.length;b++)c=s[b],d+=(d?"-":"")+c,t(k,d,u,q,o);k(u,function(){g()})}else k([a],function(c){var i=[],a;p("root",c,i,u,q,o);for(b=0;b<s.length;b++)a=s[b],d+=(d?"-":"")+a,p(d,c,i,u,q,o);k(u,function(){var b,
d,a;for(b=i.length-1;b>-1&&i[b];b--){a=i[b];d=c[a];if(d===!0||d===1)d=k(q+a+"/"+o);m(v,d)}g(v)})})}}})})();define("orion/editor/i18n",{load:function(p,t,m){t.specified&&t.specified("orion/bootstrap")?t(["orion/i18n!"+p],function(h){m(h)}):m({})}});
define("orion/editor/nls/root/messages",{multipleAnnotations:"Multiple annotations:",line:"Line: ${0}",breakpoint:"Breakpoint",bookmark:"Bookmark",task:"Task",error:"Error",warning:"Warning",matchingSearch:"Matching Search",currentSearch:"Current Search",currentLine:"Current Line",matchingBracket:"Matching Bracket",currentBracket:"Current Bracket",Comment:"Comment","Flat outline":"Flat outline",incrementalFind:"Incremental find: ${0}",incrementalFindNotFound:"Incremental find: ${0} (not found)",find:"Find...",
undo:"Undo",redo:"Redo",cancelMode:"Cancel Current Mode",findNext:"Find Next Occurrence",findPrevious:"Find Previous Occurrence",incrementalFindKey:"Incremental Find",indentLines:"Indent Lines",unindentLines:"Unindent Lines",moveLinesUp:"Move Lines Up",moveLinesDown:"Move Lines Down",copyLinesUp:"Copy Lines Up",copyLinesDown:"Copy Lines Down",deleteLines:"Delete Lines",gotoLine:"Goto Line...",gotoLinePrompty:"Goto Line:",nextAnnotation:"Next Annotation",prevAnnotation:"Previous Annotation",expand:"Expand",
collapse:"Collapse",expandAll:"Expand All",collapseAll:"Collapse All",lastEdit:"Last Edit Location",toggleLineComment:"Toggle Line Comment",addBlockComment:"Add Block Comment",removeBlockComment:"Remove Block Comment",linkedModeEntered:"Linked Mode entered",linkedModeExited:"Linked Mode exited",syntaxError:"Syntax Error",contentAssist:"Content Assist",lineColumn:"Line ${0} : Col ${1}"});
define("orion/editor/nls/messages",["orion/editor/i18n!orion/editor/nls/messages","orion/editor/nls/root/messages"],function(p,t){var m={root:t},h;for(h in p)p.hasOwnProperty(h)&&typeof m[h]==="undefined"&&(m[h]=p[h]);return m});
define("orion/editor/annotations",["i18n!orion/editor/nls/messages","orion/editor/eventTarget"],function(p,t){function m(c,i,a){this.start=c;this.end=i;this._projectionModel=a;this.html=this._expandedHTML;this.style=this._expandedStyle;this.expanded=!0}function h(){}function a(c,i){var a=c.lastIndexOf("."),a=c.substring(a+1),g={title:p[a],style:{styleClass:"annotation "+a},html:"<div class='annotationHTML "+a+"'></div>",overviewStyle:{styleClass:"annotationOverview "+a}};i?g.lineStyle={styleClass:"annotationLine "+
a}:g.rangeStyle={styleClass:"annotationRange "+a};h.registerType(c,g)}function e(){}function f(c){this._annotations=[];var a=this;this._listener={onChanged:function(c){a._onChanged(c)}};this.setTextModel(c)}function k(c,a){this._view=c;this._annotationModel=a;var g=this;this._listener={onDestroy:function(c){g._onDestroy(c)},onLineStyle:function(c){g._onLineStyle(c)},onChanged:function(c){g._onAnnotationModelChanged(c)}};c.addEventListener("Destroy",this._listener.onDestroy);c.addEventListener("postLineStyle",
this._listener.onLineStyle);a.addEventListener("Changed",this._listener.onChanged)}m.prototype={_expandedHTML:"<div class='annotationHTML expanded'></div>",_expandedStyle:{styleClass:"annotation expanded"},_collapsedHTML:"<div class='annotationHTML collapsed'></div>",_collapsedStyle:{styleClass:"annotation collapsed"},collapse:function(){if(this.expanded){this.expanded=!1;this.html=this._collapsedHTML;this.style=this._collapsedStyle;var c=this._projectionModel,a=c.getBaseModel();this._projection=
{start:a.getLineStart(a.getLineAtOffset(this.start)+1),end:a.getLineEnd(a.getLineAtOffset(this.end),!0)};c.addProjection(this._projection)}},expand:function(){if(!this.expanded)this.expanded=!0,this.html=this._expandedHTML,this.style=this._expandedStyle,this._projectionModel.removeProjection(this._projection)}};h.ANNOTATION_ERROR="orion.annotation.error";h.ANNOTATION_WARNING="orion.annotation.warning";h.ANNOTATION_TASK="orion.annotation.task";h.ANNOTATION_BREAKPOINT="orion.annotation.breakpoint";
h.ANNOTATION_BOOKMARK="orion.annotation.bookmark";h.ANNOTATION_FOLDING="orion.annotation.folding";h.ANNOTATION_CURRENT_BRACKET="orion.annotation.currentBracket";h.ANNOTATION_MATCHING_BRACKET="orion.annotation.matchingBracket";h.ANNOTATION_CURRENT_LINE="orion.annotation.currentLine";h.ANNOTATION_CURRENT_SEARCH="orion.annotation.currentSearch";h.ANNOTATION_MATCHING_SEARCH="orion.annotation.matchingSearch";h.ANNOTATION_READ_OCCURRENCE="orion.annotation.readOccurrence";h.ANNOTATION_WRITE_OCCURRENCE="orion.annotation.writeOccurrence";
h.ANNOTATION_SELECTED_LINKED_GROUP="orion.annotation.selectedLinkedGroup";h.ANNOTATION_CURRENT_LINKED_GROUP="orion.annotation.currentLinkedGroup";h.ANNOTATION_LINKED_GROUP="orion.annotation.linkedGroup";var g={};h.registerType=function(c,a){var f=a;if(typeof f!=="function")f=function(c,a,i){this.start=c;this.end=a;if(i)this.title=i},f.prototype=a;f.prototype.type=c;g[c]=f;return c};h.createAnnotation=function(c,a,g,f){return new (this.getType(c))(a,g,f)};h.getType=function(c){return g[c]};a(h.ANNOTATION_ERROR);
a(h.ANNOTATION_WARNING);a(h.ANNOTATION_TASK);a(h.ANNOTATION_BREAKPOINT);a(h.ANNOTATION_BOOKMARK);a(h.ANNOTATION_CURRENT_BRACKET);a(h.ANNOTATION_MATCHING_BRACKET);a(h.ANNOTATION_CURRENT_SEARCH);a(h.ANNOTATION_MATCHING_SEARCH);a(h.ANNOTATION_READ_OCCURRENCE);a(h.ANNOTATION_WRITE_OCCURRENCE);a(h.ANNOTATION_SELECTED_LINKED_GROUP);a(h.ANNOTATION_CURRENT_LINKED_GROUP);a(h.ANNOTATION_LINKED_GROUP);a(h.ANNOTATION_CURRENT_LINE,!0);h.registerType(h.ANNOTATION_FOLDING,m);e.addMixin=function(c){var a=e.prototype,
g;for(g in a)a.hasOwnProperty(g)&&(c[g]=a[g])};e.prototype={addAnnotationType:function(c){if(!this._annotationTypes)this._annotationTypes=[];this._annotationTypes.push(c)},getAnnotationTypePriority:function(c){if(this._annotationTypes)for(var a=0;a<this._annotationTypes.length;a++)if(this._annotationTypes[a]===c)return a+1;return 0},getAnnotationsByType:function(c,a,g){c=c.getAnnotations(a,g);for(g=[];c.hasNext();)a=c.next(),this.getAnnotationTypePriority(a.type)!==0&&g.push(a);var f=this;g.sort(function(c,
a){return f.getAnnotationTypePriority(c.type)-f.getAnnotationTypePriority(a.type)});return g},isAnnotationTypeVisible:function(c){return this.getAnnotationTypePriority(c)!==0},removeAnnotationType:function(c){if(this._annotationTypes)for(var a=0;a<this._annotationTypes.length;a++)if(this._annotationTypes[a]===c){this._annotationTypes.splice(a,1);break}}};f.prototype={addAnnotation:function(c){if(c){var a=this._annotations,g=this._binarySearch(a,c.start);a.splice(g,0,c);this.onChanged({type:"Changed",
added:[c],removed:[],changed:[]})}},getTextModel:function(){return this._model},getAnnotations:function(c,a){var g=this._annotations,f,e=0,h=function(){for(;e<g.length;){var f=g[e++];if(c===f.start||(c>f.start?c<f.end:f.start<a))return f;if(f.start>=a)break}return null};f=h();return{next:function(){var c=f;c&&(f=h());return c},hasNext:function(){return f!==null}}},modifyAnnotation:function(c){if(c&&!(this._getAnnotationIndex(c)<0))this.onChanged({type:"Changed",added:[],removed:[],changed:[c]})},
onChanged:function(c){return this.dispatchEvent(c)},removeAnnotations:function(c){var a=this._annotations,g,f;if(c){g=[];for(f=a.length-1;f>=0;f--){var e=a[f];e.type===c&&a.splice(f,1);g.splice(0,0,e)}}else g=a;this.onChanged({type:"Changed",removed:g,added:[],changed:[]})},removeAnnotation:function(c){if(c&&(c=this._getAnnotationIndex(c),!(c<0)))this.onChanged({type:"Changed",removed:this._annotations.splice(c,1),added:[],changed:[]})},replaceAnnotations:function(c,a){var g=this._annotations,f,e,
h,k=[];if(c)for(f=c.length-1;f>=0;f--)h=c[f],e=this._getAnnotationIndex(h),e<0||(g.splice(e,1),k.splice(0,0,h));a||(a=[]);for(f=0;f<a.length;f++)h=a[f],e=this._binarySearch(g,h.start),g.splice(e,0,h);this.onChanged({type:"Changed",removed:k,added:a,changed:[]})},setTextModel:function(c){this._model&&this._model.removeEventListener("Changed",this._listener.onChanged);(this._model=c)&&this._model.addEventListener("Changed",this._listener.onChanged)},_binarySearch:function(c,a){for(var g=c.length,f=
-1,e;g-f>1;)e=Math.floor((g+f)/2),a<=c[e].start?g=e:f=e;return g},_getAnnotationIndex:function(c){for(var a=this._annotations,g=this._binarySearch(a,c.start);g<a.length&&a[g].start===c.start;){if(a[g]===c)return g;g++}return-1},_onChanged:function(c){var a=c.start,g=c.removedCharCount,f=this._annotations,e=a+g;if(0<f.length){for(var h={type:"Changed",added:[],removed:[],changed:[],textModelChangedEvent:c},c=c.addedCharCount-g,g=0;g<f.length;g++){var k=f[g];k.start>=e?(k.start+=c,k.end+=c,h.changed.push(k)):
k.end<=a||(k.start<a&&e<k.end?(k.end+=c,h.changed.push(k)):(f.splice(g,1),h.removed.push(k),g--))}if(h.added.length>0||h.removed.length>0||h.changed.length>0)this.onChanged(h)}}};t.EventTarget.addMixin(f.prototype);k.prototype={destroy:function(){var c=this._view;if(c)c.removeEventListener("Destroy",this._listener.onDestroy),c.removeEventListener("LineStyle",this._listener.onLineStyle),this.view=null;(c=this._annotationModel)&&c.removeEventListener("Changed",this._listener.onChanged)},_mergeStyle:function(c,
a){if(a){c||(c={});c.styleClass&&a.styleClass&&c.styleClass!==a.styleClass?c.styleClass+=" "+a.styleClass:c.styleClass=a.styleClass;var g;if(a.style){if(!c.style)c.style={};for(g in a.style)c.style[g]||(c.style[g]=a.style[g])}if(a.attributes){if(!c.attributes)c.attributes={};for(g in a.attributes)c.attributes[g]||(c.attributes[g]=a.attributes[g])}}return c},_mergeStyleRanges:function(c,a){c||(c=[]);var g,f;for(f=0;f<c.length&&a;f++){var e=c[f];if(a.end<=e.start)break;if(!(a.start>=e.end)){g=this._mergeStyle({},
e.style);g=this._mergeStyle(g,a.style);var h=[];h.push(f,1);a.start<e.start&&h.push({start:a.start,end:e.start,style:a.style});a.start>e.start&&h.push({start:e.start,end:a.start,style:e.style});h.push({start:Math.max(e.start,a.start),end:Math.min(e.end,a.end),style:g});a.end<e.end&&h.push({start:a.end,end:e.end,style:e.style});a=a.end>e.end?{start:e.end,end:a.end,style:a.style}:null;Array.prototype.splice.apply(c,h)}}a&&(g=this._mergeStyle({},a.style),c.splice(f,0,{start:a.start,end:a.end,style:g}));
return c},_onAnnotationModelChanged:function(c){function a(c){for(var i=0;i<c.length;i++)if(f.isAnnotationTypeVisible(c[i].type)){var h=c[i].start,b=c[i].end;e.getBaseModel&&(h=e.mapOffset(h,!0),b=e.mapOffset(b,!0));h!==-1&&b!==-1&&g.redrawRange(h,b)}}if(!c.textModelChangedEvent){var g=this._view;if(g){var f=this,e=g.getModel();a(c.added);a(c.removed);a(c.changed)}}},_onDestroy:function(){this.destroy()},_onLineStyle:function(c){var a=this._annotationModel,g=c.textView.getModel(),f=a.getTextModel(),
e=c.lineStart,h=c.lineStart+c.lineText.length;f!==g&&(e=g.mapOffset(e),h=g.mapOffset(h));for(a=a.getAnnotations(e,h);a.hasNext();)if(e=a.next(),this.isAnnotationTypeVisible(e.type)){if(e.rangeStyle){var h=e.start,k=e.end;f!==g&&(h=g.mapOffset(h,!0),k=g.mapOffset(k,!0));c.ranges=this._mergeStyleRanges(c.ranges,{start:h,end:k,style:e.rangeStyle})}if(e.lineStyle)c.style=this._mergeStyle({},c.style),c.style=this._mergeStyle(c.style,e.lineStyle)}}};e.addMixin(k.prototype);return{FoldingAnnotation:m,AnnotationType:h,
AnnotationTypeList:e,AnnotationModel:f,AnnotationStyler:k}});
define("orion/editor/tooltip",["i18n!orion/editor/nls/messages","orion/editor/textView","orion/editor/textModel","orion/editor/projectionTextModel","orion/util"],function(p,t,m,h,a){function e(a){this._view=a;this._create(a.getOptions("parent").ownerDocument);a.addEventListener("Destroy",this,this.destroy)}e.getTooltip=function(a){if(!a._tooltip)a._tooltip=new e(a);return a._tooltip};e.prototype={_create:function(f){if(!this._tooltipDiv){var e=this._tooltipDiv=a.createElement(f,"div");e.className=
"textviewTooltip";e.setAttribute("aria-live","assertive");e.setAttribute("aria-atomic","true");var g=this._tooltipContents=a.createElement(f,"div");e.appendChild(g);f.body.appendChild(e);this.hide()}},_getWindow:function(){var a=this._tooltipDiv.ownerDocument;return a.defaultView||a.parentWindow},destroy:function(){if(this._tooltipDiv){this.hide();var a=this._tooltipDiv.parentNode;a&&a.removeChild(this._tooltipDiv);this._tooltipDiv=null}},hide:function(){if(this._contentsView)this._contentsView.destroy(),
this._contentsView=null;if(this._tooltipContents)this._tooltipContents.innerHTML="";if(this._tooltipDiv)this._tooltipDiv.style.visibility="hidden";var a=this._getWindow();if(this._showTimeout)a.clearTimeout(this._showTimeout),this._showTimeout=null;if(this._hideTimeout)a.clearTimeout(this._hideTimeout),this._hideTimeout=null;if(this._fadeTimeout)a.clearInterval(this._fadeTimeout),this._fadeTimeout=null},isVisible:function(){return this._tooltipDiv&&this._tooltipDiv.style.visibility==="visible"},setTarget:function(a,
e){if(this.target!==a&&(this._target=a,this.hide(),a)){var g=this;if(e===0)g.show(!0);else{var c=this._getWindow();g._showTimeout=c.setTimeout(function(){g.show(!0)},e?e:500)}}},show:function(a){if(this._target){var e=this._target.getTooltipInfo();if(e){var g=this._tooltipDiv,c=this._tooltipContents;g.style.left=g.style.right=g.style.width=g.style.height=c.style.width=c.style.height="auto";var i=e.contents;i instanceof Array&&(i=this._getAnnotationContents(i));if(typeof i==="string")c.innerHTML=i;
else if(this._isNode(i))c.appendChild(i);else if(i instanceof h.ProjectionTextModel){var q=this._view,l=q.getOptions();l.wrapMode=!1;l.parent=c;var o=l.themeClass;o?((o=o.replace("tooltip",""))&&(o=" "+o),o="tooltip"+o):o="tooltip";l.themeClass=o;l=this._contentsView=new t.TextView(l);l._clientDiv.contentEditable=!1;l.addEventListener("LineStyle",function(c){q.onLineStyle(c)});l.setModel(i);i=l.computeSize();c.style.width=i.width+"px";c.style.height=i.height+"px";l.resize()}else return;c=g.ownerDocument.documentElement;
e.anchor==="right"?(i=c.clientWidth-e.x,g.style.right=i+"px"):(i=parseInt(this._getNodeStyle(g,"padding-left","0"),10),i+=parseInt(this._getNodeStyle(g,"border-left-width","0"),10),i=e.x-i,g.style.left=i+"px");g.style.maxWidth=c.clientWidth-i-10+"px";i=parseInt(this._getNodeStyle(g,"padding-top","0"),10);i+=parseInt(this._getNodeStyle(g,"border-top-width","0"),10);i=e.y-i;g.style.top=i+"px";g.style.maxHeight=c.clientHeight-i-10+"px";g.style.opacity="1";g.style.visibility="visible";if(a){var s=this,
u=this._getWindow();s._hideTimeout=u.setTimeout(function(){var c=parseFloat(s._getNodeStyle(g,"opacity","1"));s._fadeTimeout=u.setInterval(function(){g.style.visibility==="visible"&&c>0?(c-=0.1,g.style.opacity=c):s.hide()},50)},5E3)}}}},_getAnnotationContents:function(a){function e(a){var g=a.title;if(g==="")return null;var i="<div>";a.html&&(i+=a.html+"&nbsp;");if(!g)g=a.end,a=c.getLineStart(c.getLineAtOffset(a.start)),g=c.getLineEnd(c.getLineAtOffset(g),!0),g=c.getText(a,g);g=g.replace(/</g,"&lt;").replace(/>/g,
"&gt;");i+="<span style='vertical-align:middle;'>"+g+"</span><div>";return i}if(a.length===0)return null;var g=this._view.getModel(),c=g.getBaseModel?g.getBaseModel():g;if(a.length===1)if(g=a[0],g.title!==void 0)return e(g);else{var a=new h.ProjectionTextModel(c),i=c.getLineStart(c.getLineAtOffset(g.start)),q=c.getCharCount();g.end!==q&&a.addProjection({start:g.end,end:q});i>0&&a.addProjection({start:0,end:i});return a}else{i="<div><em>"+p.multipleAnnotations+"</em></div>";for(q=0;q<a.length;q++)g=
a[q],(g=e(g))&&(i+=g);return i}},_getNodeStyle:function(a,e,g){var c;if(a&&(c=a.style[e],!c))if(a.currentStyle){for(c=0;(c=e.indexOf("-",c))!==-1;)e=e.substring(0,c)+e.substring(c+1,c+2).toUpperCase()+e.substring(c+2);c=a.currentStyle[e]}else c=(a=a.ownerDocument.defaultView.getComputedStyle(a,null))?a.getPropertyValue(e):null;return c||g},_isNode:function(a){return typeof Node==="object"?a instanceof Node:a&&typeof a==="object"&&typeof a.nodeType==="number"&&typeof a.nodeName==="string"}};return{Tooltip:e}});
define("orion/editor/rulers",["i18n!orion/editor/nls/messages","orion/editor/annotations","orion/editor/tooltip","orion/util"],function(p,t,m,h){function a(c,a,g,e){this._location=a||"left";this._overview=g||"page";this._rulerStyle=e;this._view=null;var f=this;this._listener={onTextModelChanged:function(c){f._onTextModelChanged(c)},onAnnotationModelChanged:function(c){f._onAnnotationModelChanged(c)}};this.setAnnotationModel(c)}function e(c,g,e,f,h){a.call(this,c,g,"page",e);this._oddStyle=f||{style:{backgroundColor:"white"}};
this._evenStyle=h||{style:{backgroundColor:"white"}};this._numOfDigits=0}function f(c,g,e){a.call(this,c,g,"page",e)}function k(c,g,e){a.call(this,c,g,"document",e)}function g(c,a,g){f.call(this,c,a,g)}a.prototype={getAnnotations:function(c,a){var g=this._annotationModel;if(!g)return[];var e=this._view.getModel(),f=e.getLineStart(c),h=e.getLineEnd(a-1),k=e;e.getBaseModel&&(k=e.getBaseModel(),f=e.mapOffset(f),h=e.mapOffset(h));for(var m=[],g=this.getAnnotationsByType(g,f,h),f=0;f<g.length;f++)for(var h=
g[f],b=k.getLineAtOffset(h.start),d=k.getLineAtOffset(Math.max(h.start,h.end-1)),j=b;j<=d;j++){var r=j;if(e!==k){r=k.getLineStart(j);r=e.mapOffset(r,!0);if(r===-1)continue;r=e.getLineAtOffset(r)}if(c<=r&&r<a){var p=this._mergeAnnotation(m[r],h,j-b,d-b+1);p&&(m[r]=p)}}if(!this._multiAnnotation&&this._multiAnnotationOverlay)for(var n in m)m[n]._multiple&&(m[n].html+=this._multiAnnotationOverlay.html);return m},getAnnotationModel:function(){return this._annotationModel},getLocation:function(){return this._location},
getOverview:function(){return this._overview},getRulerStyle:function(){return this._rulerStyle},getView:function(){return this._view},getWidestAnnotation:function(){return null},setAnnotationModel:function(c){this._annotationModel&&this._annotationModel.removEventListener("Changed",this._listener.onAnnotationModelChanged);(this._annotationModel=c)&&this._annotationModel.addEventListener("Changed",this._listener.onAnnotationModelChanged)},setMultiAnnotation:function(c){this._multiAnnotation=c},setMultiAnnotationOverlay:function(c){this._multiAnnotationOverlay=
c},setView:function(c){this._onTextModelChanged&&this._view&&this._view.removeEventListener("ModelChanged",this._listener.onTextModelChanged);this._view=c;this._onTextModelChanged&&this._view&&this._view.addEventListener("ModelChanged",this._listener.onTextModelChanged)},onClick:function(c){if(c!==void 0){var a=this._view,g=a.getModel(),e=g,f=g.getLineStart(c),h=f,k=this._annotationModel;if(k){h=a.getSelection();a=Math.max(h.start,h.end);h=g.getLineEnd(c,!0);f<=a&&a<g.getLineEnd(c)&&(f=a+1);g.getBaseModel&&
(f=g.mapOffset(f),h=g.mapOffset(h),e=g.getBaseModel());for(var p,c=k.getAnnotations(f,h);!p&&c.hasNext();)h=c.next(),this.isAnnotationTypeVisible(h.type)&&(p=h);p&&e.getLineAtOffset(p.start)===e.getLineAtOffset(f)?(f=p.start,h=p.end):h=f;g.getBaseModel&&(f=g.mapOffset(f,!0),h=g.mapOffset(h,!0))}(g=m.Tooltip.getTooltip(this._view))&&g.setTarget(null);this._view.setSelection(h,f,1/3,function(){})}},onDblClick:function(){},onMouseMove:function(c,a){var g=m.Tooltip.getTooltip(this._view);if(g&&!(g.isVisible()&&
this._tooltipLineIndex===c)){this._tooltipLineIndex=c;var f=this;g.setTarget({y:a.clientY,getTooltipInfo:function(){return f._getTooltipInfo(f._tooltipLineIndex,this.y)}})}},onMouseOver:function(c,a){this.onMouseMove(c,a)},onMouseOut:function(){var c=m.Tooltip.getTooltip(this._view);c&&c.setTarget(null)},_getTooltipInfo:function(c,a){if(c!==void 0){var g=this._view,f=g.getModel(),e=this._annotationModel,h=[];if(e){var h=f.getLineStart(c),k=f.getLineEnd(c);f.getBaseModel&&(h=f.mapOffset(h),k=f.mapOffset(k));
h=this.getAnnotationsByType(e,h,k)}e=this._getTooltipContents(c,h);if(!e)return null;e={contents:e,anchor:this.getLocation()};h=g.getClientArea();h.y=this.getOverview()==="document"?g.convert({y:a},"view","document").y:g.getLocationAtOffset(f.getLineStart(c)).y;g.convert(h,"document","page");e.x=h.x;e.y=h.y;e.anchor==="right"&&(e.x+=h.width);return e}},_getTooltipContents:function(c,a){return a},_onAnnotationModelChanged:function(c){function a(c){for(var i=0;i<c.length;i++)if(f.isAnnotationTypeVisible(c[i].type)){var b=
c[i].start,d=c[i].end;e.getBaseModel&&(b=e.mapOffset(b,!0),d=e.mapOffset(d,!0));b!==-1&&d!==-1&&g.redrawLines(e.getLineAtOffset(b),e.getLineAtOffset(Math.max(b,d-1))+1,f)}}var g=this._view;if(g){var e=g.getModel(),f=this,h=e.getLineCount();c.textModelChangedEvent?(c=c.textModelChangedEvent.start,e.getBaseModel&&(c=e.mapOffset(c,!0)),c=e.getLineAtOffset(c),g.redrawLines(c,h,f)):(a(c.added),a(c.removed),a(c.changed))}},_mergeAnnotation:function(c,a,g){c||(c={});if(g===0)if(c.html&&a.html){if(a.html!==
c.html&&!c._multiple&&this._multiAnnotation)c.html=this._multiAnnotation.html;c._multiple=!0}else c.html=a.html;c.style=this._mergeStyle(c.style,a.style);return c},_mergeStyle:function(c,a){if(a){c||(c={});c.styleClass&&a.styleClass&&c.styleClass!==a.styleClass?c.styleClass+=" "+a.styleClass:c.styleClass=a.styleClass;var g;if(a.style){if(!c.style)c.style={};for(g in a.style)c.style[g]||(c.style[g]=a.style[g])}if(a.attributes){if(!c.attributes)c.attributes={};for(g in a.attributes)c.attributes[g]||
(c.attributes[g]=a.attributes[g])}}return c}};t.AnnotationTypeList.addMixin(a.prototype);e.prototype=new a;e.prototype.getAnnotations=function(c,g){for(var e=a.prototype.getAnnotations.call(this,c,g),f=this._view.getModel(),h=c;h<g;h++){var k=h&1?this._oddStyle:this._evenStyle,m=h;f.getBaseModel&&(m=f.getLineStart(m),m=f.getBaseModel().getLineAtOffset(f.mapOffset(m)));e[h]||(e[h]={});e[h].html=m+1+"";if(!e[h].style)e[h].style=k}return e};e.prototype.getWidestAnnotation=function(){var c=this._view.getModel().getLineCount();
return this.getAnnotations(c-1,c)[c-1]};e.prototype._onTextModelChanged=function(c){var c=c.start,a=this._view.getModel(),g=((a.getBaseModel?a.getBaseModel().getLineCount():a.getLineCount())+"").length;if(this._numOfDigits!==g)this._numOfDigits=g,this._view.redrawLines(a.getLineAtOffset(c),a.getLineCount(),this)};f.prototype=new a;k.prototype=new a;k.prototype.getRulerStyle=function(){var c={style:{lineHeight:"1px",fontSize:"1px"}};return c=this._mergeStyle(c,this._rulerStyle)};k.prototype._getTooltipContents=
function(c,g){if(g.length===0){var e=this._view.getModel(),f=c;e.getBaseModel&&(f=e.getLineStart(f),f=e.getBaseModel().getLineAtOffset(e.mapOffset(f)));return h.formatMessage(p.line,f+1)}return a.prototype._getTooltipContents.call(this,c,g)};k.prototype._mergeAnnotation=function(c,a,g,e){if(g===0){if(!c)c={html:"&nbsp;",style:{style:{height:3*e+"px"}}},c.style=this._mergeStyle(c.style,a.overviewStyle);return c}};g.prototype=new f;g.prototype.onClick=function(c){if(c!==void 0){var a=this._annotationModel;
if(a){var g=this._view.getModel(),e=g.getLineStart(c),c=g.getLineEnd(c,!0);g.getBaseModel&&(e=g.mapOffset(e),c=g.mapOffset(c),g=g.getBaseModel());for(var f,a=a.getAnnotations(e,c);!f&&a.hasNext();)c=a.next(),this.isAnnotationTypeVisible(c.type)&&(f=c);f&&g.getLineAtOffset(f.start)===g.getLineAtOffset(e)&&((g=m.Tooltip.getTooltip(this._view))&&g.setTarget(null),f.expanded?f.collapse():f.expand(),this._annotationModel.modifyAnnotation(f))}}};g.prototype._getTooltipContents=function(c,a){return a.length===
1&&a[0].expanded?null:f.prototype._getTooltipContents.call(this,c,a)};g.prototype._onAnnotationModelChanged=function(c){function a(b){for(k=0;k<b.length;k++)if(h.isAnnotationTypeVisible(b[k].type)){var c=b[k].start;e.getBaseModel&&(c=e.mapOffset(c,!0));c!==-1&&(p=Math.min(p,e.getLineAtOffset(c)))}}if(c.textModelChangedEvent)f.prototype._onAnnotationModelChanged.call(this,c);else{var g=this._view;if(g){var e=g.getModel(),h=this,k,m=e.getLineCount(),p=m;a(c.added);a(c.removed);a(c.changed);c=g.getRulers();
for(k=0;k<c.length;k++)g.redrawLines(p,m,c[k])}}};return{Ruler:a,AnnotationRuler:f,LineNumberRuler:e,OverviewRuler:k,FoldingRuler:g}});
define("orion/editor/undoStack",[],function(){function p(h,a,e){this.offset=h;this.text=a;this.previousText=e}function t(h){this.owner=h;this.changes=[]}function m(h,a){this.view=h;this.size=a!==void 0?a:100;this.reset();var e=h.getModel();e.getBaseModel&&(e=e.getBaseModel());this.model=e;var f=this;this._listener={onChanging:function(a){f._onChanging(a)},onDestroy:function(a){f._onDestroy(a)}};e.addEventListener("Changing",this._listener.onChanging);h.addEventListener("Destroy",this._listener.onDestroy)}
p.prototype={undo:function(h,a){this._doUndoRedo(this.offset,this.previousText,this.text,h,a)},redo:function(h,a){this._doUndoRedo(this.offset,this.text,this.previousText,h,a)},_doUndoRedo:function(h,a,e,f,k){var g=f.getModel();if(g.mapOffset&&f.annotationModel){var c=g.mapOffset(h,!0);if(c<0)for(var i=f.annotationModel.getAnnotations(h,h+1);i.hasNext();){var q=i.next();if(q.type==="orion.annotation.folding"){q.expand();c=g.mapOffset(h,!0);break}}if(c<0)return;h=c}g.setText(a,h,h+e.length);k&&f.setSelection(h,
h+a.length)}};t.prototype={add:function(h){this.changes.push(h)},end:function(h){this.endSelection=h.getSelection();this.endCaret=h.getCaretOffset();(h=this.owner)&&h.end&&h.end()},undo:function(h,a){for(var e=this.changes.length-1;e>=0;e--)this.changes[e].undo(h,!1);if(a){var e=this.startSelection.start,f=this.startSelection.end;h.setSelection(this.startCaret?e:f,this.startCaret?f:e)}(e=this.owner)&&e.undo&&e.undo()},redo:function(h,a){for(var e=0;e<this.changes.length;e++)this.changes[e].redo(h,
!1);if(a){var e=this.endSelection.start,f=this.endSelection.end;h.setSelection(this.endCaret?e:f,this.endCaret?f:e)}(e=this.owner)&&e.redo&&e.redo()},start:function(h){this.startSelection=h.getSelection();this.startCaret=h.getCaretOffset();(h=this.owner)&&h.start&&h.start()}};m.prototype={add:function(h){this.compoundChange?this.compoundChange.add(h):(this.stack.splice(this.index,this.stack.length-this.index,h),this.index++,this.stack.length>this.size&&(this.stack.shift(),this.index--,this.cleanIndex--))},
markClean:function(){this.endCompoundChange();this._commitUndo();this.cleanIndex=this.index},isClean:function(){return this.cleanIndex===this.getSize().undo},canUndo:function(){return this.getSize().undo>0},canRedo:function(){return this.getSize().redo>0},endCompoundChange:function(){this.compoundChange&&this.compoundChange.end(this.view);this.compoundChange=void 0},getSize:function(){var h=this.index,a=this.stack.length;this._undoStart!==void 0&&h++;return{undo:h,redo:a-h}},undo:function(){this._commitUndo();
if(this.index<=0)return!1;var h=this.stack[--this.index];this._ignoreUndo=!0;h.undo(this.view,!0);this._ignoreUndo=!1;return!0},redo:function(){this._commitUndo();if(this.index>=this.stack.length)return!1;var h=this.stack[this.index++];this._ignoreUndo=!0;h.redo(this.view,!0);this._ignoreUndo=!1;return!0},reset:function(){this.index=this.cleanIndex=0;this.stack=[];this._undoStart=void 0;this._undoText="";this._undoType=0;this._ignoreUndo=!1;this._compoundChange=void 0},startCompoundChange:function(h){this._commitUndo();
h=new t(h);this.add(h);this.compoundChange=h;this.compoundChange.start(this.view);return this.compoundChange},_commitUndo:function(){if(this._undoStart!==void 0)this._undoType===-1?this.add(new p(this._undoStart,"",this._undoText)):this.add(new p(this._undoStart,this._undoText,"")),this._undoStart=void 0,this._undoText="",this._undoType=0;this.endCompoundChange()},_onDestroy:function(){this.model.removeEventListener("Changing",this._listener.onChanging);this.view.removeEventListener("Destroy",this._listener.onDestroy)},
_onChanging:function(h){var a=h.text,e=h.start,f=h.removedCharCount,h=h.addedCharCount;if(!this._ignoreUndo){this._undoStart!==void 0&&!(h===1&&f===0&&this._undoType===1&&e===this._undoStart+this._undoText.length||h===0&&f===1&&this._undoType===-1&&(e+1===this._undoStart||e===this._undoStart))&&this._commitUndo();if(!this.compoundChange)if(h===1&&f===0){if(this._undoStart===void 0)this._undoStart=e;this._undoText+=a;this._undoType=1;return}else if(h===0&&f===1){a=this._undoText.length>0&&this._undoStart===
e;this._undoStart=e;this._undoType=-1;a?this._undoText+=this.model.getText(e,e+f):this._undoText=this.model.getText(e,e+f)+this._undoText;return}this.add(new p(e,a,this.model.getText(e,e+f)))}}};return{UndoStack:m}});
define("orion/editor/textDND",[],function(){function p(p,m){this._view=p;this._undoStack=m;this._dragSelection=null;this._dropOffset=-1;this._dropText=null;var h=this;this._listener={onDragStart:function(a){h._onDragStart(a)},onDragEnd:function(a){h._onDragEnd(a)},onDragEnter:function(a){h._onDragEnter(a)},onDragOver:function(a){h._onDragOver(a)},onDrop:function(a){h._onDrop(a)},onDestroy:function(a){h._onDestroy(a)}};p.addEventListener("DragStart",this._listener.onDragStart);p.addEventListener("DragEnd",
this._listener.onDragEnd);p.addEventListener("DragEnter",this._listener.onDragEnter);p.addEventListener("DragOver",this._listener.onDragOver);p.addEventListener("Drop",this._listener.onDrop);p.addEventListener("Destroy",this._listener.onDestroy)}p.prototype={destroy:function(){var p=this._view;if(p)p.removeEventListener("DragStart",this._listener.onDragStart),p.removeEventListener("DragEnd",this._listener.onDragEnd),p.removeEventListener("DragEnter",this._listener.onDragEnter),p.removeEventListener("DragOver",
this._listener.onDragOver),p.removeEventListener("Drop",this._listener.onDrop),p.removeEventListener("Destroy",this._listener.onDestroy),this._view=null},_onDestroy:function(){this.destroy()},_onDragStart:function(p){var m=this._view,h=m.getSelection(),m=m.getModel();if(m.getBaseModel)h.start=m.mapOffset(h.start),h.end=m.mapOffset(h.end),m=m.getBaseModel();if(m=m.getText(h.start,h.end))this._dragSelection=h,p.event.dataTransfer.effectAllowed="copyMove",p.event.dataTransfer.setData("Text",m)},_onDragEnd:function(p){var m=
this._view;if(this._dragSelection){this._undoStack&&this._undoStack.startCompoundChange();(p=p.event.dataTransfer.dropEffect==="move")&&m.setText("",this._dragSelection.start,this._dragSelection.end);if(this._dropText){var h=this._dropText,a=this._dropOffset;if(p)if(a>=this._dragSelection.end)a-=this._dragSelection.end-this._dragSelection.start;else if(a>=this._dragSelection.start)a=this._dragSelection.start;m.setText(h,a,a);m.setSelection(a,a+h.length);this._dropText=null;this._dropOffset=-1}this._undoStack&&
this._undoStack.endCompoundChange()}this._dragSelection=null},_onDragEnter:function(p){this._onDragOver(p)},_onDragOver:function(p){var m=p.event.dataTransfer.types;if(m){var h=!this._view.getOptions("readonly");h&&(h=m.contains?m.contains("text/plain"):m.indexOf("text/plain")!==-1);if(!h)p.event.dataTransfer.dropEffect="none"}},_onDrop:function(p){var m=this._view,h=p.event.dataTransfer.getData("Text");if(h)p=m.getOffsetAtLocation(p.x,p.y),this._dragSelection?(this._dropOffset=p,this._dropText=h):
(m.setText(h,p,p),m.setSelection(p,p+h.length))}};return{TextDND:p}});
define("orion/editor/editor","i18n!orion/editor/nls/messages,orion/keyBinding,orion/editor/eventTarget,orion/editor/tooltip,orion/editor/annotations,orion/util".split(","),function(p,t,m,h,a,e){function f(a){this._textViewFactory=a.textViewFactory;this._undoStackFactory=a.undoStackFactory;this._textDNDFactory=a.textDNDFactory;this._annotationFactory=a.annotationFactory;this._foldingRulerFactory=a.foldingRulerFactory;this._lineNumberRulerFactory=a.lineNumberRulerFactory;this._contentAssistFactory=
a.contentAssistFactory;this._keyBindingFactory=a.keyBindingFactory;this._statusReporter=a.statusReporter;this._domNode=a.domNode;this._foldingRuler=this._overviewRuler=this._lineNumberRuler=this._annotationRuler=this._annotationModel=this._annotationStyler=null;this._dirty=!1;this._title=this._contentAssist=null;this._keyModes=[]}function k(a){var c=this,i=Array.prototype.slice.call(arguments,1);return i.length?function(){return arguments.length?c.apply(a,i.concat(Array.prototype.slice.call(arguments))):
c.apply(a,i)}:function(){return arguments.length?c.apply(a,arguments):c.call(a)}}f.prototype={destroy:function(){this.uninstallTextView();this._textViewFactory=this._undoStackFactory=this._textDNDFactory=this._annotationFactory=this._foldingRulerFactory=this._lineNumberRulerFactory=this._contentAssistFactory=this._keyBindingFactory=this._statusReporter=this._domNode=null},getAnnotationModel:function(){return this._annotationModel},getAnnotationRuler:function(){return this._annotationRuler},getAnnotationStyler:function(){return this._annotationStyler},
getFoldingRuler:function(){return this._foldingRuler},getLineNumberRuler:function(){return this._lineNumberRuler},getModel:function(){var a=this._textView.getModel();a.getBaseModel&&(a=a.getBaseModel());return a},getOverviewRuler:function(){return this._overviewRuler},getTextView:function(){return this._textView},getTitle:function(){return this._title},getKeyModes:function(){return this._keyModes},isDirty:function(){return this._dirty},setAnnotationRulerVisible:function(a){if(this._annotationRulerVisible!==
a&&(this._annotationRulerVisible=a,this._annotationRuler)){var c=this._textView;a?c.addRuler(this._annotationRuler,0):c.removeRuler(this._annotationRuler)}},setFoldingRulerVisible:function(a){if(this._foldingRulerVisible!==a&&(this._foldingRulerVisible=a,this._foldingRuler)){var c=this._textView;c.getModel().getBaseModel&&(a?c.addRuler(this._foldingRuler,100):c.removeRuler(this._foldingRuler))}},setDirty:function(a){if(this._dirty!==a)this._dirty=a,this.onDirtyChanged({type:"DirtyChanged"})},setLineNumberRulerVisible:function(a){if(this._lineNumberRulerVisible!==
a&&(this._lineNumberRulerVisible=a,this._lineNumberRuler)){var c=this._textView;a?c.addRuler(this._lineNumberRuler,1):c.removeRuler(this._lineNumberRuler)}},setOverviewRulerVisible:function(a){if(this._overviewRulerVisible!==a&&(this._overviewRulerVisible=a,this._overviewRuler)){var c=this._textView;a?c.addRuler(this._overviewRuler):c.removeRuler(this._overviewRuler)}},mapOffset:function(a,c){var i=this._textView.getModel();i.getBaseModel&&(a=i.mapOffset(a,c));return a},getCaretOffset:function(){return this.mapOffset(this._textView.getCaretOffset())},
getSelection:function(){var a=this._textView,c=a.getSelection(),a=a.getModel();if(a.getBaseModel)c.start=a.mapOffset(c.start),c.end=a.mapOffset(c.end);return c},getText:function(a,c){var i=this._textView.getModel();i.getBaseModel&&(i=i.getBaseModel());return i.getText(a,c)},_expandOffset:function(g){var c=this._textView.getModel(),i=this._annotationModel;if(i&&c.getBaseModel)for(g=i.getAnnotations(g,g+1);g.hasNext();)c=g.next(),c.type===a.AnnotationType.ANNOTATION_FOLDING&&c.expand&&(c.expand(),i.modifyAnnotation(c))},
setCaretOffset:function(a,c,i){var e=this._textView,f=e.getModel();f.getBaseModel&&(this._expandOffset(a),a=f.mapOffset(a,!0));e.setCaretOffset(a,c,i)},setText:function(a,c,i){var e=this._textView,f=e.getModel();f.getBaseModel&&(c!==void 0&&(this._expandOffset(c),c=f.mapOffset(c,!0)),i!==void 0&&(this._expandOffset(i),i=f.mapOffset(i,!0)));e.setText(a,c,i)},setFoldingEnabled:function(a){this.setFoldingRulerVisible(a)},setSelection:function(a,c,i,e){var f=this._textView,h=f.getModel();h.getBaseModel&&
(this._expandOffset(a),this._expandOffset(c),a=h.mapOffset(a,!0),c=h.mapOffset(c,!0));f.setSelection(a,c,i,e)},moveSelection:function(a,c,i,e){var f=this._textView;this.setSelection(a,c||a,1/3,function(){(e===void 0||e)&&f.focus();i&&i()})},checkDirty:function(){this.setDirty(!this._undoStack.isClean())},reportStatus:function(a,c,i){this._statusReporter&&this._statusReporter(a,c,i)},_getTooltipInfo:function(a,c){var i=this._textView,e=this.getAnnotationModel();if(!e)return null;var f=this._annotationStyler;
if(!f)return null;var h=i.getOffsetAtLocation(a,c);if(h===-1)return null;h=this.mapOffset(h);f=f.getAnnotationsByType(e,h,h+1);e=[];for(h=0;h<f.length;h++)f[h].rangeStyle&&e.push(f[h]);if(e.length===0)return null;i=i.convert({x:a,y:c},"document","page");return{contents:e,anchor:"left",x:i.x+10,y:i.y+20}},_highlightCurrentLine:function(g,c){var i=this._annotationModel;if(i){var e=this._textView.getModel(),f=c?e.getLineAtOffset(c.start):-1,h=e.getLineAtOffset(g.start),k=g.start===g.end,m=!c||c.start===
c.end,p=e.getLineStart(h),b=e.getLineEnd(h);e.getBaseModel&&(p=e.mapOffset(p),b=e.mapOffset(b));e=this._currentLineAnnotation;if(!(f===h&&m&&k&&e&&e.start===p&&e.end===b)){var f=e?[e]:null,d;k&&(e=a.AnnotationType.createAnnotation(a.AnnotationType.ANNOTATION_CURRENT_LINE,p,b),d=[e]);this._currentLineAnnotation=e;i.replaceAnnotations(f,d)}}},installTextView:function(){this._textView=this._textViewFactory();if(this._undoStackFactory)this._undoStack=this._undoStackFactory.createUndoStack(this);if(this._textDNDFactory)this._textDND=
this._textDNDFactory.createTextDND(this,this._undoStack);if(this._contentAssistFactory){var g=this._contentAssistFactory.createContentAssistMode(this);this._keyModes.push(g);this._contentAssist=g.getContentAssist()}var c=this,i=this._textView,e=this;this._listener={onModelChanged:function(){e.checkDirty()},onMouseOver:function(a){e._listener.onMouseMove(a)},onMouseMove:function(a){var c=h.Tooltip.getTooltip(i);if(c&&!(e._listener.lastMouseX===a.event.clientX&&e._listener.lastMouseY===a.event.clientY))e._listener.lastMouseX=
a.event.clientX,e._listener.lastMouseY=a.event.clientY,c.setTarget({x:a.x,y:a.y,getTooltipInfo:function(){return e._getTooltipInfo(this.x,this.y)}})},onMouseOut:function(a){var c=h.Tooltip.getTooltip(i);if(c&&!(e._listener.lastMouseX===a.event.clientX&&e._listener.lastMouseY===a.event.clientY))e._listener.lastMouseX=a.event.clientX,e._listener.lastMouseY=a.event.clientY,c.setTarget(null)},onScroll:function(){var a=h.Tooltip.getTooltip(i);a&&a.setTarget(null)},onSelection:function(a){e._updateCursorStatus();
e._highlightCurrentLine(a.newValue,a.oldValue)}};i.addEventListener("ModelChanged",this._listener.onModelChanged);i.addEventListener("Selection",this._listener.onSelection);i.addEventListener("MouseOver",this._listener.onMouseOver);i.addEventListener("MouseOut",this._listener.onMouseOut);i.addEventListener("MouseMove",this._listener.onMouseMove);i.addEventListener("Scroll",this._listener.onScroll);this._keyBindingFactory&&this._keyBindingFactory(this,this._keyModes,this._undoStack,this._contentAssist);
i.setKeyBinding(new t.KeyBinding(27),"cancelMode");i.setAction("cancelMode",function(){for(var a=!1,c=0;c<this._keyModes.length;c++)this._keyModes[c].isActive()&&(a=this._keyModes[c].cancel()||a);return a}.bind(this),{name:p.cancelMode});i.setAction("lineUp",function(){for(var a=0;a<this._keyModes.length;a++)if(this._keyModes[a].isActive())return this._keyModes[a].lineUp();return!1}.bind(this));i.setAction("lineDown",function(){for(var a=0;a<this._keyModes.length;a++)if(this._keyModes[a].isActive())return this._keyModes[a].lineDown();
return!1}.bind(this));i.setAction("enter",function(){for(var a=0;a<this._keyModes.length;a++)if(this._keyModes[a].isActive())return this._keyModes[a].enter();return!1}.bind(this));g=function(g){if(g!==void 0&&g!==-1){for(var i=this.getView().getModel(),e=this.getAnnotationModel(),b=c.mapOffset(i.getLineStart(g)),g=c.mapOffset(i.getLineEnd(g)),i=e.getAnnotations(b,g),d=null;i.hasNext();){var f=i.next();if(f.type===a.AnnotationType.ANNOTATION_BOOKMARK){d=f;break}}d?e.removeAnnotation(d):(d=a.AnnotationType.createAnnotation(a.AnnotationType.ANNOTATION_BOOKMARK,
b,g),d.title=void 0,e.addAnnotation(d))}};if(this._annotationFactory){var f=i.getModel();f.getBaseModel&&(f=f.getBaseModel());if(this._annotationModel=this._annotationFactory.createAnnotationModel(f))if(f=this._annotationStyler=this._annotationFactory.createAnnotationStyler(i,this._annotationModel))f.addAnnotationType(a.AnnotationType.ANNOTATION_CURRENT_SEARCH),f.addAnnotationType(a.AnnotationType.ANNOTATION_MATCHING_SEARCH),f.addAnnotationType(a.AnnotationType.ANNOTATION_ERROR),f.addAnnotationType(a.AnnotationType.ANNOTATION_WARNING),
f.addAnnotationType(a.AnnotationType.ANNOTATION_MATCHING_BRACKET),f.addAnnotationType(a.AnnotationType.ANNOTATION_CURRENT_BRACKET),f.addAnnotationType(a.AnnotationType.ANNOTATION_CURRENT_LINE),f.addAnnotationType(a.AnnotationType.ANNOTATION_READ_OCCURRENCE),f.addAnnotationType(a.AnnotationType.ANNOTATION_WRITE_OCCURRENCE),f.addAnnotationType(a.AnnotationType.ANNOTATION_SELECTED_LINKED_GROUP),f.addAnnotationType(a.AnnotationType.ANNOTATION_CURRENT_LINKED_GROUP),f.addAnnotationType(a.AnnotationType.ANNOTATION_LINKED_GROUP),
f.addAnnotationType("orion.annotation.highlightError");i.annotationModel=this._annotationModel;var f=this._annotationFactory.createAnnotationRulers(this._annotationModel),k=this._annotationRuler=f.annotationRuler;if(k)k.onDblClick=g,k.setMultiAnnotationOverlay({html:"<div class='annotationHTML overlay'></div>"}),k.addAnnotationType(a.AnnotationType.ANNOTATION_ERROR),k.addAnnotationType(a.AnnotationType.ANNOTATION_WARNING),k.addAnnotationType(a.AnnotationType.ANNOTATION_TASK),k.addAnnotationType(a.AnnotationType.ANNOTATION_BOOKMARK);
this.setAnnotationRulerVisible(!0);if(k=this._overviewRuler=f.overviewRuler)k.addAnnotationType(a.AnnotationType.ANNOTATION_CURRENT_SEARCH),k.addAnnotationType(a.AnnotationType.ANNOTATION_MATCHING_SEARCH),k.addAnnotationType(a.AnnotationType.ANNOTATION_ERROR),k.addAnnotationType(a.AnnotationType.ANNOTATION_WARNING),k.addAnnotationType(a.AnnotationType.ANNOTATION_TASK),k.addAnnotationType(a.AnnotationType.ANNOTATION_BOOKMARK),k.addAnnotationType(a.AnnotationType.ANNOTATION_MATCHING_BRACKET),k.addAnnotationType(a.AnnotationType.ANNOTATION_CURRENT_BRACKET),
k.addAnnotationType(a.AnnotationType.ANNOTATION_CURRENT_LINE),k.addAnnotationType(a.AnnotationType.ANNOTATION_READ_OCCURRENCE),k.addAnnotationType(a.AnnotationType.ANNOTATION_WRITE_OCCURRENCE);this.setOverviewRulerVisible(!0)}if(this._lineNumberRulerFactory)this._lineNumberRuler=this._lineNumberRulerFactory.createLineNumberRuler(this._annotationModel),this._lineNumberRuler.onDblClick=g,this.setLineNumberRulerVisible(!0);if(this._foldingRulerFactory)this._foldingRuler=this._foldingRulerFactory.createFoldingRuler(this._annotationModel),
this._foldingRuler.addAnnotationType(a.AnnotationType.ANNOTATION_FOLDING),this.setFoldingRulerVisible(!1);this.dispatchEvent({type:"TextViewInstalled",textView:i})},uninstallTextView:function(){var a=this._textView;if(a)a.destroy(),this._textView=this._undoStack=this._textDND=this._contentAssist=this._listener=this._annotationModel=this._annotationStyler=this._annotationRuler=this._overviewRuler=this._lineNumberRuler=this._foldingRuler=this._currentLineAnnotation=this._title=null,this._dirty=!1,this._keyModes=
[],this.dispatchEvent({type:"TextViewUninstalled",textView:a})},_updateCursorStatus:function(){var a=this.getModel(),c=this.getCaretOffset(),i=a.getLineAtOffset(c),a=a.getLineStart(i);c-=a;for(a=0;a<this._keyModes.length;a++){var f=this._keyModes[a];if(f.isActive()&&f.isStatusActive&&f.isStatusActive())return}this.reportStatus(e.formatMessage(p.lineColumn,i+1,c+1))},showProblems:function(g){var c=this._annotationModel;if(c){for(var i=[],e=[],f=c.getTextModel(),h=c.getAnnotations(0,f.getCharCount()),
k;h.hasNext();)k=h.next(),(k.type===a.AnnotationType.ANNOTATION_ERROR||k.type===a.AnnotationType.ANNOTATION_WARNING)&&i.push(k);if(g)for(h=0;h<g.length;h++)if(k=g[h]){var m=k.description.replace(/'/g,"&#39;").replace(/"/g,"&#34;"),p=f.getLineStart(k.line-1);k=a.AnnotationType.createAnnotation(k.severity==="error"?a.AnnotationType.ANNOTATION_ERROR:a.AnnotationType.ANNOTATION_WARNING,p+k.start-1,p+k.end,m);e.push(k)}c.replaceAnnotations(i,e)}},showOccurrences:function(g){var c=this._annotationModel;
if(c){for(var i=[],e=[],f=c.getTextModel(),h=c.getAnnotations(0,f.getCharCount()),k;h.hasNext();)k=h.next(),(k.type===a.AnnotationType.ANNOTATION_READ_OCCURRENCE||k.type===a.AnnotationType.ANNOTATION_WRITE_OCCURRENCE)&&i.push(k);if(g)for(h=0;h<g.length;h++)if(k=g[h]){var m=f.getLineStart(k.line-1);k=a.AnnotationType.createAnnotation(k.readAccess===!0?a.AnnotationType.ANNOTATION_READ_OCCURRENCE:a.AnnotationType.ANNOTATION_WRITE_OCCURRENCE,m+k.start-1,m+k.end,k.description);e.push(k)}c.replaceAnnotations(i,
e)}},showSelection:function(a,c,i,e,f){typeof a==="number"?(typeof c!=="number"&&(c=a),this.moveSelection(a,c)):typeof i==="number"&&(a=this.getModel().getLineStart(i-1),typeof e==="number"&&(a+=e),typeof f!=="number"&&(f=0),this.moveSelection(a,a+f))},setInput:function(a,c,i,e){this._title=a;this._textView&&(e?(this._undoStack.markClean(),this.checkDirty()):(c?this._textView.setText(c):i!==null&&i!==void 0&&(this._textView.setText(i),this._textView.getModel().setLineDelimiter("auto"),this._highlightCurrentLine(this._textView.getSelection())),
this._undoStack.reset(),this.checkDirty(),this._textView.focus()));this.onInputChanged({type:"InputChanged",title:a,message:c,contents:i,contentsSaved:e})},onInputChanged:function(a){return this.dispatchEvent(a)},onGotoLine:function(a,c,i){if(this._textView){var e=this.getModel(),f=e.getLineStart(a),h=0;i===void 0&&(i=0);typeof c==="string"?(a=e.getLine(a).indexOf(c),a!==-1&&(h=a,i=h+c.length)):(h=c,c=e.getLineEnd(a)-f,h=Math.min(h,c),i=Math.min(i,c));this.moveSelection(f+h,f+i)}},onDirtyChanged:function(a){return this.dispatchEvent(a)}};
m.EventTarget.addMixin(f.prototype);if(!Function.prototype.bind)Function.prototype.bind=k;return{Editor:f}});define("orion/editor/regex",[],function(){return{escape:function(p){return p.replace(/([\\$\^*\/+?\.\(\)|{}\[\]])/g,"\\$&")},parse:function(p){return(p=/^\s*\/(.+)\/([gim]{0,3})\s*$/.exec(p))?{pattern:p[1],flags:p[2]}:null}}});
define("orion/editor/editorFeatures","i18n!orion/editor/nls/messages,orion/editor/undoStack,orion/keyBinding,orion/editor/rulers,orion/editor/annotations,orion/editor/tooltip,orion/editor/textDND,orion/editor/regex,orion/util".split(","),function(p,t,m,h,a,e,f,k,g){function c(){}function i(){}function q(){}function l(){}function o(){}function s(b){this.editor=b;this._active=!1;this._success=!0;this._ignoreSelection=!1;this._prefix="";var a=this;this._listener={onVerify:function(b){var c=a.editor,
d=c.getModel(),g=c.mapOffset(b.start),c=c.mapOffset(b.end),d=d.getText(g,c);if((d=a._prefix.match(RegExp("^"+k.escape(d),"i")))&&d.length>0)a._prefix+=b.text,a._success=!0,a._status(),a.find(!0),b.text=null},onSelection:function(){a._ignoreSelection||a.setActive(!1)}}}function u(b,a,c){this.editor=b;this.undoStack=a;this._incrementalFind=new s(b);this._searcher=c;this._lastEditLocation=null;this.init()}function v(b,a,c,g){this.editor=b;this.undoStack=a;this.contentAssist=c;this.linkedMode=g;this.contentAssist&&
this.contentAssist.addEventListener("ProposalApplied",this.contentAssistProposalApplied.bind(this));this.init()}function b(b,a){this.editor=b;this.undoStack=a;this.linkedModeActive=!1;this.linkedModeModel=null;this.linkedModeGroupIndex=0;this.linkedModeListener={onVerify:function(b){if(!this.ignoreVerify){var a=b.start,c=b.end-b.start,d=a+c,c=b.text.length-c,g=[],i=this.linkedModeModel.groups,e;for(e=0;e<i.length;e++)for(var f=i[e].positions,h=0;h<f.length;h++)g.push({group:e,position:f[h]});g.sort(function(b,
a){return b.position.offset-a.position.offset});var j,h=b.start,k=b.end;for(e=0;e<g.length;e++)if(i=g[e].group,f=g[e].position,f.offset<=a&&d<=f.offset+f.length){h-=f.offset;k-=f.offset;j=i;break}if(j!==void 0){if(this._compoundChange){if(this._compoundChange.owner.group!==j)this.linkedModeGroupIndex=j,this.endUndo(),this.startUndo()}else this.startUndo();this.ignoreVerify=!0;a=this.editor.getTextView();for(e=g.length-1;e>=0;e--)i=g[e].group,f=g[e].position,i===j&&a.setText(b.text,f.offset+h,f.offset+
k);this.ignoreVerify=!1;b.text=null;var b=0,l;for(e=0;e<g.length;++e)i=g[e].group,f=g[e].position,l===void 0&&this.linkedModeModel.escapePosition<f.offset&&(l=b),i===j?(f.offset+=b,f.length+=c,b+=c):f.offset+=b;l===void 0&&(l=b);this.linkedModeModel.escapePosition+=l;this._updateAnnotations()}else this.cancel()}}.bind(this)}}c.prototype={createUndoStack:function(b){var b=b.getTextView(),a=new t.UndoStack(b,200);b.setAction("undo",function(){a.undo();return!0},{name:p.undo});b.setAction("redo",function(){a.redo();
return!0},{name:p.redo});return a}};i.prototype={createLineNumberRuler:function(b){return new h.LineNumberRuler(b,"left",{styleClass:"ruler lines"},{styleClass:"rulerLines odd"},{styleClass:"rulerLines even"})}};q.prototype={createFoldingRuler:function(b){return new h.FoldingRuler(b,"left",{styleClass:"ruler folding"})}};l.prototype={createAnnotationModel:function(b){return new a.AnnotationModel(b)},createAnnotationStyler:function(b,c){return new a.AnnotationStyler(b,c)},createAnnotationRulers:function(b){var a=
new h.AnnotationRuler(b,"left",{styleClass:"ruler annotations"}),b=new h.OverviewRuler(b,"right",{styleClass:"ruler overview"});return{annotationRuler:a,overviewRuler:b}}};o.prototype={createTextDND:function(b,a){return new f.TextDND(b.getTextView(),a)}};s.prototype={backspace:function(){if(!this.isActive())return!1;var b=this._prefix,b=this._prefix=b.substring(0,b.length-1);return b.length===0?(this._ignoreSelection=this._success=!0,this.editor.setCaretOffset(this.editor.getSelection().start),this._ignoreSelection=
!1,this._status(),!0):this.find(!1)},find:function(b){if(!this.isActive())return!1;var a=this._prefix;if(a.length===0)return!1;var c=this.editor,g=c.getModel(),g=b?this._success?c.getSelection().start+1:0:this._success?c.getCaretOffset()-a.length-1:g.getCharCount()-1;(b=c.getModel().find({string:a,start:g,reverse:!b,caseInsensitive:a.toLowerCase()===a}).next())?(this._ignoreSelection=this._success=!0,c.moveSelection(b.start,b.end),this._ignoreSelection=!1):this._success=!1;this._status();return!0},
isActive:function(){return this._active},setActive:function(b){this._active=b;this._prefix="";this._success=!0;b=this.editor.getTextView();this.editor.setCaretOffset(this.editor.getCaretOffset());this._active?(b.addEventListener("Verify",this._listener.onVerify),b.addEventListener("Selection",this._listener.onSelection)):(b.removeEventListener("Verify",this._listener.onVerify),b.removeEventListener("Selection",this._listener.onSelection));this._status()},_status:function(){this.isActive()?this.editor.reportStatus(g.formatMessage(this._success?
p.incrementalFind:p.incrementalFindNotFound,this._prefix),this._success?"":"error"):this.editor.reportStatus("")}};u.prototype={init:function(){var b=this,a=this.editor.getTextView();this._lastEditListener={onModelChanged:function(a){if(b.editor.isDirty())b._lastEditLocation=a.start+a.addedCharCount}};a.addEventListener("ModelChanged",this._lastEditListener.onModelChanged);a.setKeyBinding(new m.KeyBinding("k",!0),"findNext");a.setAction("findNext",function(){if(this._searcher){var b=a.getSelection();
b.start<b.end?this._searcher.findNext(!0,a.getText(b.start,b.end)):this._searcher.findNext(!0);return!0}return!1}.bind(this),{name:p.findNext});a.setKeyBinding(new m.KeyBinding("k",!0,!0),"findPrevious");a.setAction("findPrevious",function(){if(this._searcher){var b=a.getSelection();b.start<b.end?this._searcher.findNext(!1,a.getText(b.start,b.end)):this._searcher.findNext(!1);return!0}return!1}.bind(this),{name:p.findPrevious});a.setKeyBinding(new m.KeyBinding("j",!0),"incrementalFind");a.setAction("incrementalFind",
function(){if(this._searcher&&this._searcher.visible())return!0;this._incrementalFind.isActive()?this._incrementalFind.find(!0):this._incrementalFind.setActive(!0);return!0}.bind(this),{name:p.incrementalFindKey});a.setAction("deletePrevious",function(){return this._incrementalFind.backspace()}.bind(this));a.setAction("tab",function(){if(a.getOptions("readonly"))return!1;if(a.getOptions("tabMode")){var b=this.editor,c=b.getModel(),d=b.getSelection(),g=c.getLineAtOffset(d.start),i=c.getLineAtOffset(d.end>
d.start?d.end-1:d.end);if(g!==i){var e=[];e.push("");for(var f=g;f<=i;f++)e.push(c.getLine(f,!0));var f=c.getLineStart(g),c=c.getLineEnd(i,!0),h=a.getOptions("tabSize","expandTab"),h=h.expandTab?Array(h.tabSize+1).join(" "):"\t";b.setText(e.join(h),f,c);b.setSelection(f===d.start?d.start:d.start+h.length,d.end+(i-g+1)*h.length);return!0}b=b.getKeyModes();for(d=0;d<b.length;d++)if(b[d].isActive())return b[d].tab();return!1}}.bind(this));a.setAction("shiftTab",function(){if(a.getOptions("readonly"))return!1;
if(a.getOptions("tabMode")){for(var b=this.editor,c=b.getModel(),d=b.getSelection(),g=c.getLineAtOffset(d.start),i=c.getLineAtOffset(d.end>d.start?d.end-1:d.end),e=a.getOptions("tabSize"),f=Array(e+1).join(" "),h=[],k=0,l=0,o=g;o<=i;o++){var q=c.getLine(o,!0);if(c.getLineStart(o)!==c.getLineEnd(o))if(q.indexOf("\t")===0)q=q.substring(1),k++;else if(q.indexOf(f)===0)q=q.substring(e),k+=e;else return!0;o===g&&(l=k);h.push(q)}g=c.getLineStart(g);e=c.getLineEnd(i,!0);c=c.getLineStart(i);b.setText(h.join(""),
g,e);h=g===d.start?d.start:d.start-l;d=Math.max(h,d.end-k+(d.end===c+1&&d.start!==d.end?1:0));b.setSelection(h,d);return!0}}.bind(this),{name:p.unindentLines});a.setKeyBinding(new m.KeyBinding(38,!1,!1,!0),"moveLinesUp");a.setAction("moveLinesUp",function(){if(a.getOptions("readonly"))return!1;var b=this.editor,c=b.getModel(),d=b.getSelection(),g=c.getLineAtOffset(d.start);if(g===0)return!0;var i=c.getLineAtOffset(d.end>d.start?d.end-1:d.end),e=c.getLineCount(),d=c.getLineStart(g-1),f=c.getLineStart(g),
h=c.getLineEnd(i,!0),k=c.getText(f,h),l=0;i===e-1&&(i=c.getLineEnd(g-1),g=c.getLineEnd(g-1,!0),k+=c.getText(i,g),f=i,l=g-i);this.startUndo();b.setText("",f,h);b.setText(k,d,d);b.setSelection(d,d+k.length-l);this.endUndo();return!0}.bind(this),{name:p.moveLinesUp});a.setKeyBinding(new m.KeyBinding(40,!1,!1,!0),"moveLinesDown");a.setAction("moveLinesDown",function(){if(a.getOptions("readonly"))return!1;var b=this.editor,c=b.getModel(),d=b.getSelection(),g=c.getLineAtOffset(d.start),i=c.getLineAtOffset(d.end>
d.start?d.end-1:d.end),e=c.getLineCount();if(i===e-1)return!0;var g=c.getLineStart(g),d=c.getLineEnd(i,!0),f=c.getLineEnd(i+1,!0)-(d-g),h=0;i!==e-2?c=c.getText(g,d):(i=c.getLineEnd(i),c=c.getText(i,d)+c.getText(g,i),h+=d-i);this.startUndo();b.setText("",g,d);b.setText(c,f,f);b.setSelection(f+h,f+h+c.length);this.endUndo();return!0}.bind(this),{name:p.moveLinesDown});a.setKeyBinding(new m.KeyBinding(38,!0,!1,!0),"copyLinesUp");a.setAction("copyLinesUp",function(){if(a.getOptions("readonly"))return!1;
var b=this.editor,c=b.getModel(),d=b.getSelection(),g=c.getLineAtOffset(d.start),d=c.getLineAtOffset(d.end>d.start?d.end-1:d.end),g=c.getLineStart(g),i=c.getLineEnd(d,!0),e=c.getLineCount(),f="",i=c.getText(g,i);d===e-1&&(i+=f=c.getLineDelimiter());b.setText(i,g,g);b.setSelection(g,g+i.length-f.length);return!0}.bind(this),{name:p.copyLinesUp});a.setKeyBinding(new m.KeyBinding(40,!0,!1,!0),"copyLinesDown");a.setAction("copyLinesDown",function(){if(a.getOptions("readonly"))return!1;var b=this.editor,
c=b.getModel(),d=b.getSelection(),g=c.getLineAtOffset(d.start),d=c.getLineAtOffset(d.end>d.start?d.end-1:d.end),i=c.getLineStart(g),g=c.getLineEnd(d,!0),e=c.getLineCount(),f="",i=c.getText(i,g);d===e-1&&(i=(f=c.getLineDelimiter())+i);b.setText(i,g,g);b.setSelection(g+f.length,g+i.length);return!0}.bind(this),{name:p.copyLinesDown});a.setKeyBinding(new m.KeyBinding("d",!0,!1,!1),"deleteLines");a.setAction("deleteLines",function(){if(a.getOptions("readonly"))return!1;var b=this.editor,c=b.getSelection(),
d=b.getModel(),g=d.getLineAtOffset(c.start),c=d.getLineAtOffset(c.end>c.start?c.end-1:c.end),g=d.getLineStart(g),d=d.getLineEnd(c,!0);b.setText("",g,d);return!0}.bind(this),{name:p.deleteLines});a.setKeyBinding(new m.KeyBinding("l",!0),"gotoLine");a.setAction("gotoLine",function(){var b=this.editor,a=b.getModel().getLineAtOffset(b.getCaretOffset());if(a=prompt(p.gotoLinePrompty,a+1))a=parseInt(a,10),b.onGotoLine(a-1,0);return!0}.bind(this),{name:p.gotoLine});a.setKeyBinding(new m.KeyBinding(190,!0),
"nextAnnotation");a.setAction("nextAnnotation",function(){return this.nextAnnotation(!0)}.bind(this),{name:p.nextAnnotation});a.setKeyBinding(new m.KeyBinding(188,!0),"previousAnnotation");a.setAction("previousAnnotation",function(){return this.nextAnnotation(!1)}.bind(this),{name:p.prevAnnotation});a.setKeyBinding(new m.KeyBinding("e",!0,!1,!0,!1),"expand");a.setAction("expand",function(){return this.expandAnnotation(!0)}.bind(this),{name:p.expand});a.setKeyBinding(new m.KeyBinding("c",!0,!1,!0,
!1),"collapse");a.setAction("collapse",function(){return this.expandAnnotation(!1)}.bind(this),{name:p.collapse});a.setKeyBinding(new m.KeyBinding("e",!0,!0,!0,!1),"expandAll");a.setAction("expandAll",function(){return this.expandAnnotations(!0)}.bind(this),{name:p.expandAll});a.setKeyBinding(new m.KeyBinding("c",!0,!0,!0,!1),"collapseAll");a.setAction("collapseAll",function(){return this.expandAnnotations(!1)}.bind(this),{name:p.collapseAll});a.setKeyBinding(new m.KeyBinding("q",!g.isMac,!1,!1,g.isMac),
"lastEdit");a.setAction("lastEdit",function(){typeof this._lastEditLocation==="number"&&this.editor.showSelection(this._lastEditLocation);return!0}.bind(this),{name:p.lastEdit})},nextAnnotation:function(b){var c=this.editor,g=c.getAnnotationModel();if(!g)return!0;for(var i=c.getModel(),f=c.getCaretOffset(),g=g.getAnnotations(b?f:0,b?i.getCharCount():f),h=null;g.hasNext();){var k=g.next();if(b){if(k.start<=f)continue}else if(k.start>=f)continue;switch(k.type){case a.AnnotationType.ANNOTATION_ERROR:case a.AnnotationType.ANNOTATION_WARNING:case a.AnnotationType.ANNOTATION_TASK:case a.AnnotationType.ANNOTATION_BOOKMARK:break;
default:continue}h=k;if(b)break}if(h){var l=c.getTextView(),o=i.getLineAtOffset(h.start),q=e.Tooltip.getTooltip(l);if(!q)return c.moveSelection(h.start),!0;c.moveSelection(h.start,h.start,function(){q.setTarget({getTooltipInfo:function(){var b=l.convert({x:l.getLocationAtOffset(h.start).x,y:l.getLocationAtOffset(i.getLineStart(o)).y},"document","page");return{contents:[h],x:b.x,y:b.y+Math.floor(l.getLineHeight(o)*1.33)}}},0)})}return!0},expandAnnotation:function(b){var c=this.editor,g=c.getAnnotationModel();
if(!g)return!0;var i=c.getModel(),e=c.getCaretOffset(),f=i.getLineAtOffset(e),e=i.getLineStart(f),f=i.getLineEnd(f,!0);i.getBaseModel&&(e=i.mapOffset(e),f=i.mapOffset(f),i.getBaseModel());for(var h,i=g.getAnnotations(e,f);!h&&i.hasNext();)e=i.next(),e.type===a.AnnotationType.ANNOTATION_FOLDING&&(h=e);h&&b!==h.expanded&&(b?h.expand():(c.setCaretOffset(h.start),h.collapse()),g.modifyAnnotation(h));return!0},expandAnnotations:function(b){var c=this.editor,g=c.getTextView(),i=c.getAnnotationModel();if(!i)return!0;
var c=c.getModel(),e=i.getAnnotations(0,c.getCharCount());for(g.setRedraw(!1);e.hasNext();)c=e.next(),c.type===a.AnnotationType.ANNOTATION_FOLDING&&b!==c.expanded&&(b?c.expand():c.collapse(),i.modifyAnnotation(c));g.setRedraw(!0);return!0},startUndo:function(){this.undoStack&&this.undoStack.startCompoundChange()},endUndo:function(){this.undoStack&&this.undoStack.endCompoundChange()},cancel:function(){this._incrementalFind.setActive(!1)},isActive:function(){return this._incrementalFind.isActive()},
isStatusActive:function(){return this._incrementalFind.isActive()},lineUp:function(){return this._incrementalFind.find(!1)},lineDown:function(){return this._incrementalFind.find(!0)},enter:function(){return!1}};v.prototype={startUndo:function(){this.undoStack&&this.undoStack.startCompoundChange()},endUndo:function(){this.undoStack&&this.undoStack.endCompoundChange()},init:function(){function b(a,c,d){var g=a.getLineAtOffset(c),i=a.getLineAtOffset(d),e,f,h,j,k,l;for(e=g;e>=0;e--)if(f=a.getLine(e),
h=e===g?c-a.getLineStart(g):f.length,j=f.lastIndexOf("/*",h),f=f.lastIndexOf("*/",h),f>j)break;else if(j!==-1){k=a.getLineStart(e)+j;break}for(e=i;e<a.getLineCount();e++)if(f=a.getLine(e),h=e===i?d-a.getLineStart(i):0,j=f.indexOf("/*",h),f=f.indexOf("*/",h),j!==-1&&j<f)break;else if(f!==-1){l=a.getLineStart(e)+f;break}return{commentStart:k,commentEnd:l}}var a=this.editor.getTextView();a.setAction("lineStart",function(){for(var b=this.editor,a=b.getModel(),c=b.getCaretOffset(),d=a.getLineAtOffset(c),
g=a.getLineStart(d),a=a.getLine(d),d=0;d<a.length;d++){var i=a.charCodeAt(d);if(!(i===32||i===9))break}d+=g;return c!==d?(b.setSelection(d,d),!0):!1}.bind(this));a.setKeyBinding(new m.KeyBinding(191,!0),"toggleLineComment");a.setAction("toggleLineComment",function(){if(a.getOptions("readonly"))return!1;for(var b=this.editor,c=b.getModel(),d=b.getSelection(),g=c.getLineAtOffset(d.start),i=c.getLineAtOffset(d.end>d.start?d.end-1:d.end),e=!0,f=[],h,k,l=g;l<=i;l++)if(h=c.getLine(l,!0),f.push(h),!e||(k=
h.indexOf("//"))===-1)e=!1;else if(k!==0){var o;for(o=0;o<k;o++)if(e=h.charCodeAt(o),!(e===32||e===9))break;e=o===k}l=c.getLineStart(g);o=c.getLineEnd(i,!0);if(e){for(e=0;e<f.length;e++)h=f[e],k=h.indexOf("//"),f[e]=h.substring(0,k)+h.substring(k+2);f=f.join("");h=c.getLineStart(i);c=l===d.start?d.start:d.start-2;d=d.end-2*(i-g+1)+(d.end===h+1?2:0)}else f.splice(0,0,""),f=f.join("//"),c=l===d.start?d.start:d.start+2,d=d.end+2*(i-g+1);b.setText(f,l,o);b.setSelection(c,d);return!0}.bind(this),{name:p.toggleLineComment});
a.setKeyBinding(new m.KeyBinding(191,!0,!g.isMac,!1,g.isMac),"addBlockComment");a.setAction("addBlockComment",function(){if(a.getOptions("readonly"))return!1;var c=this.editor,g=c.getModel(),i=c.getSelection(),e=b(g,i.start,i.end);if(e.commentStart!==void 0&&e.commentEnd!==void 0)return!0;g=g.getText(i.start,i.end);if(g.length===0)return!0;var e=g.length,g=g.replace(/\/\*|\*\//g,""),f=g.length;c.setText("/*"+g+"*/",i.start,i.end);c.setSelection(i.start+2,i.end+2+(f-e));return!0}.bind(this),{name:p.addBlockComment});
a.setKeyBinding(new m.KeyBinding(220,!0,!g.isMac,!1,g.isMac),"removeBlockComment");a.setAction("removeBlockComment",function(){if(a.getOptions("readonly"))return!1;var c=this.editor,g=c.getModel(),i=c.getSelection(),e=g.getText(i.start,i.end),f,h,k;for(k=0;k<e.length;k++)if(e.substring(k,k+2)==="/*"){f=i.start+k;break}for(;k<e.length;k++)if(e.substring(k,k+2)==="*/"){h=i.start+k;break}if(f!==void 0&&h!==void 0)c.setText(g.getText(f+2,h),f,h+2),c.setSelection(f,h);else{e=b(g,i.start,i.end);if(e.commentStart===
void 0||e.commentEnd===void 0)return!0;g=g.getText(e.commentStart+2,e.commentEnd);c.setText(g,e.commentStart,e.commentEnd+2);c.setSelection(i.start-2,i.end-2)}return!0}.bind(this),{name:p.removeBlockComment})},contentAssistProposalApplied:function(b){b=b.data.proposal;if(b.positions&&b.positions.length>0&&this.linkedMode){for(var a=[],c=0;c<b.positions.length;++c)a[c]={positions:[{offset:b.positions[c].offset,length:b.positions[c].length}]};this.linkedMode.enterLinkedMode({groups:a,escapePosition:b.escapePosition})}else b.groups&&
b.groups.length>0&&this.linkedMode?this.linkedMode.enterLinkedMode({groups:b.groups,escapePosition:b.escapePosition}):b.escapePosition&&this.editor.getTextView().setCaretOffset(b.escapePosition);return!0},cancel:function(){return!1},isActive:function(){return!0},isStatusActive:function(){return!1},lineUp:function(){return!1},lineDown:function(){return!1},enter:function(){if(this.editor.getTextView().getOptions("readonly"))return!1;var b=this.editor,a=b.getSelection();if(a.start===a.end){for(var c=
b.getModel(),g=c.getLineAtOffset(a.start),i=c.getLine(g,!0),e=c.getLineStart(g),g=0,e=a.start-e,f;g<e&&((f=i.charCodeAt(g))===32||f===9);)g++;if(g>0){for(var h=i.substring(0,g),g=e;g<i.length&&((f=i.charCodeAt(g++))===32||f===9);)a.end++;b.setText(c.getLineDelimiter()+h,a.start,a.end);return!0}}return!1},tab:function(){return!1}};b.prototype={enterLinkedMode:function(b){if(!this.linkedModeActive)this.linkedModeActive=!0,this.linkedModeModel=b,this.selectLinkedGroup(0),b=this.editor.getTextView(),
b.addEventListener("Verify",this.linkedModeListener.onVerify),b.setKeyBinding(new m.KeyBinding(9),"nextLinkedModePosition"),b.setAction("nextLinkedModePosition",function(){this.selectLinkedGroup((this.linkedModeGroupIndex+1)%this.linkedModeModel.groups.length);return!0}.bind(this)),b.setKeyBinding(new m.KeyBinding(9,!1,!0),"previousLinkedModePosition"),b.setAction("previousLinkedModePosition",function(){this.selectLinkedGroup(this.linkedModeGroupIndex>0?this.linkedModeGroupIndex-1:this.linkedModeModel.groups.length-
1);return!0}.bind(this)),this.editor.reportStatus(p.linkedModeEntered,null,!0)},_cloneModel:function(){for(var b=this.linkedModeModel,a=[],c={escapePosition:b.escapePosition,groups:a},b=b.groups,g=0;g<b.length;g++){var i=[];a.push({positions:i});for(var e=b[g].positions,f=0;f<e.length;f++)i.push({offset:e[f].offset,length:e[f].length})}return c},startUndo:function(){if(this.undoStack){var b=this;this._compoundChange=this.undoStack.startCompoundChange({startModel:b._cloneModel(),group:b.linkedModeGroupIndex,
end:function(){b._compoundChange=null;this.endModel=b._cloneModel()},redo:function(){if(b.linkedModeActive)b.linkedModeModel=this.endModel,b.selectLinkedGroup(0)},undo:function(){if(b.linkedModeActive)b.linkedModeModel=this.startModel,b.selectLinkedGroup(0)}})}},endUndo:function(){this.undoStack&&this.undoStack.endCompoundChange()},isActive:function(){return this.linkedModeActive},isStatusActive:function(){return this.linkedModeActive},enter:function(){this.cancel();return!0},cancel:function(b){if(this.linkedModeActive){this.linkedModeActive=
!1;var a=this.editor.getTextView();a.removeEventListener("Verify",this.linkedModeListener.onVerify);a.setKeyBinding(new m.KeyBinding(9),"tab");a.setKeyBinding(new m.KeyBinding(9,!1,!0),"shiftTab");b||a.setCaretOffset(this.linkedModeModel.escapePosition,!1);if(this._compoundChange)this.endUndo(),this._compoundChange=null;this._updateAnnotations();this.editor.reportStatus(p.linkedModeExited,null,!0)}},lineUp:function(){this.cancel(!0);return!1},lineDown:function(){this.cancel(!0);return!1},selectLinkedGroup:function(b){this.linkedModeGroupIndex=
b;b=this.linkedModeModel.groups[b].positions[0];this.editor.getTextView().setSelection(b.offset,b.offset+b.length);this._updateAnnotations()},_updateAnnotations:function(){var b=this.editor.getAnnotationModel();if(b){for(var c=[],g=[],i=b.getTextModel(),i=b.getAnnotations(0,i.getCharCount()),e;i.hasNext();)switch(e=i.next(),e.type){case a.AnnotationType.ANNOTATION_LINKED_GROUP:case a.AnnotationType.ANNOTATION_CURRENT_LINKED_GROUP:case a.AnnotationType.ANNOTATION_SELECTED_LINKED_GROUP:c.push(e)}if(this.linkedModeActive)for(var i=
this.linkedModeModel.groups,f=0;f<i.length;f++)for(var h=i[f].positions,k=0;k<h.length;k++){e=h[k];var l=a.AnnotationType.ANNOTATION_LINKED_GROUP;f===this.linkedModeGroupIndex&&(l=k===0?a.AnnotationType.ANNOTATION_SELECTED_LINKED_GROUP:a.AnnotationType.ANNOTATION_CURRENT_LINKED_GROUP);e=a.AnnotationType.createAnnotation(l,e.offset,e.offset+e.length);g.push(e)}b.replaceAnnotations(c,g)}}};return{UndoFactory:c,LineNumberRulerFactory:i,FoldingRulerFactory:q,AnnotationFactory:l,TextDNDFactory:o,TextActions:u,
SourceCodeActions:v,LinkedMode:b}});
(function(p,t){typeof define==="function"&&define.amd?define("orion/Deferred",t):typeof exports==="object"?module.exports=t():(p.orion=p.orion||{},p.orion.Deferred=t())})(this,function(){function p(){for(var a;a=f.shift()||k.shift();)a();g=!1}function t(a,i){(i?k:f).push(a);g||(g=!0,i?setTimeout(p,0):p())}function m(a){return function(){a.apply(null,arguments)}}function h(){}function a(){var a=Error("Cancel");a.name="Cancel";return a}function e(){function c(){for(var a;a=k.shift();){var c=a.deferred,
e=f==="resolved"?"resolve":"reject";if(typeof a[e]==="function")try{var b=a[e](g);b&&typeof b.then==="function"?(c.cancel=b.cancel||h,b.then(m(c.resolve),m(c.reject),c.progress)):c.resolve(b)}catch(d){c.reject(d)}else c[e](g)}}var g,f,k=[],o=this;this.reject=function(a){f||(f="rejected",g=a,k.length&&t(c));return o.promise};this.resolve=function(a){f||(f="resolved",g=a,k.length&&t(c));return o.promise};this.progress=function(a){f||k.forEach(function(c){c.progress&&c.progress(a)});return o.promise};
this.cancel=function(){f||o.reject(a())};this.then=function(a,g,i){var a={resolve:a,reject:g,progress:i,deferred:new e},b=a.deferred,d=!1,h=function(){d||(d=!0,t(function(){var a=b.cancel===h?o.cancel:b.cancel;typeof a==="function"&&a()},!0))};b.cancel=h;k.push(a);f&&t(c,!0);return b.promise};this.promise=Object.create(Object.prototype,{then:{value:o.then},cancel:{get:function(){return o.cancel},set:function(a){o.cancel=a}}})}var f=[],k=[],g=!1;e.all=function(a,g){function f(b,a){m||(s[b]=a,--k===
0&&p.resolve(s))}function h(b,a){if(!m){if(g)try{f(b,g(a));return}catch(c){a=c}p.reject(a)}}var k=a.length,s=[],m=!1,p=new e;p.then(null,function(){m=!0;a.forEach(function(b){b.cancel&&b.cancel()})});k===0?p.resolve(s):a.forEach(function(b,a){b.then(f.bind(null,a),h.bind(null,a))});return p.promise};e.when=function(a,g,f,h){var k;if(!(a&&typeof a.then==="function"))k=new e,k.resolve(a),a=k.promise;return a.then(g,f,h)};return e});
define("orion/editor/contentAssist",["i18n!orion/editor/nls/messages","orion/keyBinding","orion/editor/eventTarget","orion/Deferred","orion/util"],function(p,t,m,h,a){var e,f,k;function g(c){this.textView=c;this.state=e;this.providers=[];var g=this;this.contentAssistListener={onModelChanging:function(a){g.isDeactivatingChange(a)?g.setState(e):g.state===f&&g.setState(k)},onScroll:function(){g.setState(e)},onSelection:function(){var a=g.state;if(a===f||a===k)g.computeProposals(),g.setState(k)}};c.setKeyBinding(a.isMac?
new t.KeyBinding(" ",!1,!1,!1,!0):new t.KeyBinding(" ",!0),"contentAssist");c.setAction("contentAssist",function(){g.activate();return!0},{name:p.contentAssist})}function c(a,c){this.contentAssist=a;this.widget=c;this.proposals=[];var g=this;this.contentAssist.addEventListener("ProposalsComputed",function(a){g.proposals=a.data.proposals;g.selectedIndex=g.proposals.length?0:-1})}function i(c,g){this.contentAssist=c;this.textView=this.contentAssist.getTextView();this.isShowing=this.textViewListenerAdded=
!1;var i=this.textView.getOptions("parent").ownerDocument;this.parentNode=typeof g==="string"?i.getElementById(g):g;if(!this.parentNode){this.parentNode=a.createElement(i,"div");this.parentNode.className="contentassist";var e=i.getElementsByTagName("body")[0];if(e)e.appendChild(this.parentNode);else throw Error("parentNode is required");}var f=this;this.textViewListener={onMouseDown:function(b){b.event.target.parentElement!==f.parentNode&&f.contentAssist.deactivate()}};this.contentAssist.addEventListener("ProposalsComputed",
function(b){f.setProposals(b.data.proposals);f.show();if(!f.textViewListenerAdded)f.textView.addEventListener("MouseDown",f.textViewListener.onMouseDown),f.textViewListenerAdded=!0});this.contentAssist.addEventListener("Deactivating",function(){f.setProposals([]);f.hide();if(f.textViewListenerAdded)f.textView.removeEventListener("MouseDown",f.textViewListener.onMouseDown),f.textViewListenerAdded=!1;f.textViewListenerAdded=!1});this.scrollListener=function(){f.isShowing&&f.position()};i.addEventListener&&
i.addEventListener("scroll",this.scrollListener)}e=1;f=2;k=3;var q={selected:" selected",hr:"proposal-hr",emphasis:"proposal-emphasis",noemphasis:"proposal-noemphasis",dfault:"proposal-default"};g.prototype={apply:function(a){if(!a)return!1;var c=this.textView.getSelection(),g=Math.min(c.start,c.end),c=Math.max(c.start,c.end);a.overwrite&&(g=this.getPrefixStart(g));var i={proposal:a,start:g,end:c};this.setState(e);this.textView.setText(a.proposal||a,g,c);this.dispatchEvent({type:"ProposalApplied",
data:i});return!0},activate:function(){this.state===e&&this.setState(f)},deactivate:function(){this.setState(e)},getTextView:function(){return this.textView},isActive:function(){return this.state===f||this.state===k},isDeactivatingChange:function(a){var c=a.removedCharCount>0&&a.addedCharCount===0,g=this.textView,g=a.start+1<=g.getModel().getCharCount()&&/^\s*$/.test(g.getText(a.start,a.start+1));return a.removedLineCount>0||a.addedLineCount>0||c&&g},setState:function(a){var c;a===f?c="Activating":
a===e&&(c="Deactivating");c&&this.dispatchEvent({type:c});this.state=a;this.onStateChange(a)},onStateChange:function(a){if(a===e){if(this.listenerAdded)this.textView.removeEventListener("ModelChanging",this.contentAssistListener.onModelChanging),this.textView.removeEventListener("Scroll",this.contentAssistListener.onScroll),this.textView.removeEventListener("Selection",this.contentAssistListener.onSelection),this.listenerAdded=!1}else if(a===f){if(!this.listenerAdded)this.textView.addEventListener("ModelChanging",
this.contentAssistListener.onModelChanging),this.textView.addEventListener("Scroll",this.contentAssistListener.onScroll),this.textView.addEventListener("Selection",this.contentAssistListener.onSelection),this.listenerAdded=!0;this.computeProposals()}},computeProposals:function(){var a=this;this._computeProposals(this.textView.getCaretOffset()).then(function(c){a.dispatchEvent({type:"ProposalsComputed",data:{proposals:c}})})},getPrefixStart:function(a){for(;a>0&&/[A-Za-z0-9_]/.test(this.textView.getText(a-
1,a));)a--;return a},handleError:function(a){typeof console!=="undefined"&&(console.log("Error retrieving content assist proposals"),console.log(a))},_computeProposals:function(a){for(var c=this.providers,g=this.textView,i=g.getModel(),e=g.getText(),b=i.getLine(i.getLineAtOffset(a)),d=0;d<b.length&&/\s/.test(b.charAt(d));)d++;var d=b.substring(0,d),f=g.getOptions("tabSize","expandTab"),f=f.expandTab?Array(f.tabSize+1).join(" "):"\t",k={line:b,prefix:g.getText(this.getPrefixStart(a),a),selection:g.getSelection(),
delimiter:i.getLineDelimiter(),tab:f,indentation:d},q=this,c=c.map(function(b){var c=b.computeProposals||b.getProposals,d;try{typeof c==="function"&&(d=q.progress?q.progress.progress(c.apply(b,[e,a,k]),"Generating content assist proposal"):c.apply(b,[e,a,k]))}catch(g){q.handleError(g)}return h.when(d)});return h.all(c,this.handleError).then(function(b){return b.reduce(function(b,a){return a instanceof Array?b.concat(a):b},[])})},setProviders:function(a){this.providers=a.slice(0)},setProgress:function(a){this.progress=
a}};m.EventTarget.addMixin(g.prototype);c.prototype={cancel:function(){this.getContentAssist().deactivate()},getContentAssist:function(){return this.contentAssist},isActive:function(){return this.getContentAssist().isActive()},lineUp:function(){for(var a=this.selectedIndex===0?this.proposals.length-1:this.selectedIndex-1;this.proposals[a].unselectable&&a>0;)a--;this.selectedIndex=a;this.widget&&this.widget.setSelectedIndex(this.selectedIndex);return!0},lineDown:function(){for(var a=this.selectedIndex===
this.proposals.length-1?0:this.selectedIndex+1;this.proposals[a].unselectable&&a<this.proposals.length-1;)a++;this.selectedIndex=a;this.widget&&this.widget.setSelectedIndex(this.selectedIndex);return!0},enter:function(){return this.contentAssist.apply(this.proposals[this.selectedIndex]||null)},tab:function(){return this.widget?(this.widget.createAccessible(this),this.widget.parentNode.focus(),!0):!1}};i.prototype={onClick:function(a){this.contentAssist.apply(this.getProposal(a.target));this.textView.focus()},
createDiv:function(c,g,i,e){var f=i.ownerDocument,b=a.createElement(f,"div");b.id="contentoption"+e;b.setAttribute("role","option");c.style==="hr"?c=a.createElement(f,"hr"):(b.className=this.calculateClasses(c.style,g),c=f.createTextNode(this.getDisplayString(c)),g&&this.parentNode.setAttribute("aria-activedescendant",b.id));b.appendChild(c,b);i.appendChild(b)},createAccessible:function(a){this._isAccessible||this.parentNode.addEventListener("keydown",function(c){c.preventDefault();if(c.keyCode===
27)return a.cancel();else if(c.keyCode===38)return a.lineUp();else if(c.keyCode===40)return a.lineDown();else if(c.keyCode===13)return a.enter();return!1});this._isAccessible=!0},calculateClasses:function(a,c){var g=q[a];if(!g)g=q.dfault;return c?g+q.selected:g},getDisplayString:function(a){return typeof a==="string"?a:a.description&&typeof a.description==="string"?a.description:a.proposal},getProposal:function(a){for(var c=0,g=this.parentNode.firstChild;g!==null;g=g.nextSibling){if(g===a)return this.proposals[c]||
null;c++}return null},setSelectedIndex:function(a){this.selectedIndex=a;this.selectNode(this.parentNode.childNodes[this.selectedIndex])},selectNode:function(a){for(var c=this.parentNode.childNodes,g=0;g<c.length;g++){var i=c[g],f=i.className.indexOf(q.selected);if(f>=0)i.className=i.className.substring(0,f)+i.className.substring(f+q.selected.length);i===a&&(i.className+=q.selected,this.parentNode.setAttribute("aria-activedescendant",i.id),i.focus(),i.offsetTop<this.parentNode.scrollTop?i.scrollIntoView(!0):
i.offsetTop+i.offsetHeight>this.parentNode.scrollTop+this.parentNode.clientHeight&&i.scrollIntoView(!1))}},setProposals:function(a){this.proposals=a},show:function(){if(this.proposals.length===0)this.hide();else{this.parentNode.innerHTML="";for(var a=0;a<this.proposals.length;a++)this.createDiv(this.proposals[a],a===0,this.parentNode,a);this.position();this.parentNode.onclick=this.onClick.bind(this);this.isShowing=!0}},hide:function(){this.parentNode.ownerDocument.activeElement===this.parentNode&&
this.textView.focus();this.parentNode.style.display="none";this.parentNode.onclick=null;this.isShowing=!1},position:function(){var a=this.textView.getLocationAtOffset(this.textView.getCaretOffset());a.y+=this.textView.getLineHeight();this.textView.convert(a,"document","page");this.parentNode.style.position="fixed";this.parentNode.style.left=a.x+"px";this.parentNode.style.top=a.y+"px";this.parentNode.style.display="block";this.parentNode.scrollTop=0;var c=this.parentNode.ownerDocument,g=c.documentElement.clientWidth;
if(a.y+this.parentNode.offsetHeight>c.documentElement.clientHeight)this.parentNode.style.top=a.y-this.parentNode.offsetHeight-this.textView.getLineHeight()+"px";if(a.x+this.parentNode.offsetWidth>g)this.parentNode.style.left=g-this.parentNode.offsetWidth+"px"}};return{ContentAssist:g,ContentAssistMode:c,ContentAssistWidget:i}});
define("orion/editor/templates",[],function(){function p(m,h,a){this.prefix=m;this.description=h;this.template=a;this._parse()}function t(m,h){this._keywords=m||[];this._templates=[];this.addTemplates(h||[])}p.prototype={getProposal:function(m,h,a){var m=h-m.length,h={},e,f=a.delimiter!==void 0?a.delimiter:"\n";a.indentation&&(f+=a.indentation);var k=this.variables;k["${delimiter}"]=f;k["${tab}"]=a.tab!==void 0?a.tab:"\t";k["${cursor}"]="";for(var f=0,g=this.segments,a=[],c=0;c<g.length;c++){var i=
g[c],q=i,l=k[i];if(l!==void 0)switch(i=l,q){case "${tab}":case "${delimiter}":break;case "${cursor}":e=f;break;default:(q=h[i])||(q=h[i]={positions:[]}),q.positions.push({offset:m+f,length:i.length})}a.push(i);f+=i.length}var k=[],o;for(o in h)h.hasOwnProperty(o)&&k.push(h[o]);a=a.join("");if(e===void 0)e=a.length;return{proposal:a,description:this.description,groups:k,escapePosition:m+e}},match:function(m){return this.prefix.indexOf(m)===0},_parse:function(){var m=this.template,h=[],a={},e,f=0,m=
m.replace(/\n/g,"${delimiter}"),m=m.replace(/\t/g,"${tab}");m.replace(/\$\{([^\}]+)\}/g,function(k,g,c){var i=g.indexOf(":");i!==-1&&(g=g.substring(0,i));a[k]||(a[k]=g);(e=m.substring(f,c))&&h.push(e);h.push(k);f=c+k.length;return g});(e=m.substring(f,m.length))&&h.push(e);this.segments=h;this.variables=a}};t.prototype={addTemplates:function(m){for(var h=this.getTemplates(),a=0;a<m.length;a++)h.push(new p(m[a].prefix,m[a].description,m[a].template))},computeProposals:function(m,h,a){var e=this.getPrefix(m,
h,a),f=[];if(!this.isValid(e,m,h,a))return f;f=f.concat(this.getTemplateProposals(e,h,a));return f=f.concat(this.getKeywordProposals(e))},getKeywords:function(){return this._keywords},getKeywordProposals:function(m){var h=[],a=this.getKeywords();if(a)for(var e=0;e<a.length;e++)a[e].indexOf(m)===0&&h.push({proposal:a[e].substring(m.length),description:a[e]});return h},getPrefix:function(m,h,a){return a.prefix},getTemplates:function(){return this._templates},getTemplateProposals:function(m,h,a){for(var e=
[],f=this.getTemplates(),k=0;k<f.length;k++){var g=f[k];g.match(m)&&(g=g.getProposal(m,h,a),this.removePrefix(m,g),e.push(g))}return e},removePrefix:function(m,h){if(!(h.overwrite=h.proposal.substring(0,m.length)!==m))h.proposal=h.proposal.substring(m.length)},isValid:function(){return!0}};return{Template:p,TemplateContentAssist:t}});
define("orion/editor/keywords",[],function(){return{JSKeywords:"break,case,class,catch,continue,const,debugger,default,delete,do,else,enum,export,extends,false,finally,for,function,if,implements,import,in,instanceof,interface,let,new,null,package,private,protected,public,return,static,super,switch,this,throw,true,try,typeof,undefined,var,void,while,with,yield".split(","),CSSKeywords:"alignment-adjust,alignment-baseline,animation,animation-delay,animation-direction,animation-duration,animation-iteration-count,animation-name,animation-play-state,animation-timing-function,appearance,azimuth,backface-visibility,background,background-attachment,background-clip,background-color,background-image,background-origin,background-position,background-repeat,background-size,baseline-shift,binding,bleed,bookmark-label,bookmark-level,bookmark-state,bookmark-target,border,border-bottom,border-bottom-color,border-bottom-left-radius,border-bottom-right-radius,border-bottom-style,border-bottom-width,border-collapse,border-color,border-image,border-image-outset,border-image-repeat,border-image-slice,border-image-source,border-image-width,border-left,border-left-color,border-left-style,border-left-width,border-radius,border-right,border-right-color,border-right-style,border-right-width,border-spacing,border-style,border-top,border-top-color,border-top-left-radius,border-top-right-radius,border-top-style,border-top-width,border-width,bottom,box-align,box-decoration-break,box-direction,box-flex,box-flex-group,box-lines,box-ordinal-group,box-orient,box-pack,box-shadow,box-sizing,break-after,break-before,break-inside,caption-side,clear,clip,color,color-profile,column-count,column-fill,column-gap,column-rule,column-rule-color,column-rule-style,column-rule-width,column-span,column-width,columns,content,counter-increment,counter-reset,crop,cue,cue-after,cue-before,cursor,direction,display,dominant-baseline,drop-initial-after-adjust,drop-initial-after-align,drop-initial-before-adjust,drop-initial-before-align,drop-initial-size,drop-initial-value,elevation,empty-cells,fit,fit-position,flex-align,flex-flow,flex-inline-pack,flex-order,flex-pack,float,float-offset,font,font-family,font-size,font-size-adjust,font-stretch,font-style,font-variant,font-weight,grid-columns,grid-rows,hanging-punctuation,height,hyphenate-after,hyphenate-before,hyphenate-character,hyphenate-lines,hyphenate-resource,hyphens,icon,image-orientation,image-rendering,image-resolution,inline-box-align,left,letter-spacing,line-height,line-stacking,line-stacking-ruby,line-stacking-shift,line-stacking-strategy,list-style,list-style-image,list-style-position,list-style-type,margin,margin-bottom,margin-left,margin-right,margin-top,mark,mark-after,mark-before,marker-offset,marks,marquee-direction,marquee-loop,marquee-play-count,marquee-speed,marquee-style,max-height,max-width,min-height,min-width,move-to,nav-down,nav-index,nav-left,nav-right,nav-up,opacity,orphans,outline,outline-color,outline-offset,outline-style,outline-width,overflow,overflow-style,overflow-x,overflow-y,padding,padding-bottom,padding-left,padding-right,padding-top,page,page-break-after,page-break-before,page-break-inside,page-policy,pause,pause-after,pause-before,perspective,perspective-origin,phonemes,pitch,pitch-range,play-during,position,presentation-level,punctuation-trim,quotes,rendering-intent,resize,rest,rest-after,rest-before,richness,right,rotation,rotation-point,ruby-align,ruby-overhang,ruby-position,ruby-span,size,speak,speak-header,speak-numeral,speak-punctuation,speech-rate,stress,string-set,table-layout,target,target-name,target-new,target-position,text-align,text-align-last,text-decoration,text-emphasis,text-height,text-indent,text-justify,text-outline,text-shadow,text-transform,text-wrap,top,transform,transform-origin,transform-style,transition,transition-delay,transition-duration,transition-property,transition-timing-function,unicode-bidi,vertical-align,visibility,voice-balance,voice-duration,voice-family,voice-pitch,voice-pitch-range,voice-rate,voice-stress,voice-volume,volume,white-space,white-space-collapse,widows,width,word-break,word-spacing,word-wrap,z-index".split(","),
JAVAKeywords:"abstract,boolean,break,byte,case,catch,char,class,continue,default,do,double,else,extends,false,final,finally,float,for,if,implements,import,instanceof,int,interface,long,native,new,null,package,private,protected,public,return,short,static,super,switch,synchronized,this,throw,throws,transient,true,try,void,volatile,while".split(",")}});
define("orion/editor/cssContentAssist",["orion/editor/templates","orion/editor/keywords"],function(p,t){function m(){}m.prototype=new p.TemplateContentAssist(t.CSSKeywords,[{prefix:"rule",description:"rule - class selector rule",template:".${class} {\n\t${cursor}\n}"},{prefix:"rule",description:"rule - id selector rule",template:"#${id} {\n\t${cursor}\n}"},{prefix:"width",description:"width - width pixel style",template:"width: ${value}px;"},{prefix:"height",description:"height - height pixel style",
template:"width: ${value}px;"},{prefix:"background-image",description:"background-image - image style",template:'background-image: url("${uri}");'},{prefix:"url",description:"url - url image",template:'url("${uri}");'},{prefix:"@",description:"import - import style sheet",template:'@import "${uri}";'}]);m.prototype.getPrefix=function(h,a){for(var e=a;e&&/[A-Za-z\-\@]/.test(h.charAt(e-1));)e--;return e?h.substring(e,a):""};return{CssContentAssistProvider:m}});
define("orion/editor/htmlContentAssist",["orion/editor/templates"],function(p){function t(){}var m=new p.Template("","Simple HTML document",'<!DOCTYPE html>\n<html lang="en">\n\t<head>\n\t\t<meta charset=utf-8>\n\t\t<title>${title}</title>\n\t</head>\n\t<body>\n\t\t<h1>${header}</h1>\n\t\t<p>\n\t\t\t${cursor}\n\t\t</p>\n\t</body>\n</html>'),h=[{prefix:"<img",description:"<img> - HTML image element",template:'<img src="${cursor}" alt="${Image}"/>'},{prefix:"<a",description:"<a> - HTML anchor element",
template:'<a href="${cursor}"></a>'},{prefix:"<ul",description:"<ul> - HTML unordered list",template:"<ul>\n\t<li>${cursor}</li>\n</ul>"},{prefix:"<ol",description:"<ol> - HTML ordered list",template:"<ol>\n\t<li>${cursor}</li>\n</ol>"},{prefix:"<dl",description:"<dl> - HTML definition list",template:"<dl>\n\t<dt>${cursor}</dt>\n\t<dd></dd>\n</dl>"},{prefix:"<table",description:"<table> - basic HTML table",template:"<table>\n\t<tr>\n\t\t<td>${cursor}</td>\n\t</tr>\n</table>"}],a,e,f,k,g="abbr,b,button,canvas,cite,command,dd,del,dfn,dt,em,embed,font,h1,h2,h3,h4,h5,h6,i,ins,kbd,label,li,mark,meter,object,option,output,progress,q,rp,rt,samp,small,strong,sub,sup,td,time,title,tt,u,var".split(",");
for(k=0;k<g.length;k++)a=g[k],f="<"+a+"></"+a+">",e="<"+a+">${cursor}</"+a+">",h.push({prefix:"<"+a,description:f,template:e});g="address,article,aside,audio,bdo,blockquote,body,caption,code,colgroup,datalist,details,div,fieldset,figure,footer,form,head,header,hgroup,iframe,legend,map,menu,nav,noframes,noscript,optgroup,p,pre,ruby,script,section,select,span,style,tbody,textarea,tfoot,th,thead,tr,video".split(",");for(k=0;k<g.length;k++)a=g[k],f="<"+a+"></"+a+">",e="<"+a+">\n\t${cursor}\n</"+a+">",
h.push({prefix:"<"+a,description:f,template:e});g="area,base,br,col,hr,input,link,meta,param,keygen,source".split(",");for(k=0;k<g.length;k++)a=g[k],e=f="<"+a+"/>",h.push({prefix:"<"+a,description:f,template:e});t.prototype=new p.TemplateContentAssist([],h);t.prototype.getPrefix=function(a,g){for(var f=g;f&&/[A-Za-z<]/.test(a.charAt(f-1));)if(f--,a.charAt(f)==="<")break;return f?a.substring(f,g):""};t.prototype.computeProposals=function(a,g,f){return a.length===0?[m.getProposal("",g,f)]:p.TemplateContentAssist.prototype.computeProposals.call(this,
a,g,f)};return{HTMLContentAssistProvider:t}});
define("orion/editor/jsTemplateContentAssist",["orion/editor/templates","orion/editor/keywords"],function(p,t){function m(){}m.prototype=new p.TemplateContentAssist(t.JSKeywords,[{prefix:"if",description:"if - if statement",template:"if (${condition}) {\n\t${cursor}\n}"},{prefix:"if",description:"if - if else statement",template:"if (${condition}) {\n\t${cursor}\n} else {\n\t${cursor}\n}"},{prefix:"for",description:"for - iterate over array",template:"for (var ${i}=0; ${i}<${array}.length; ${i}++) {\n\t${cursor}\n}"},{prefix:"for",
description:"for - iterate over array with local var",template:"for (var ${i}=0; ${i}<${array}.length; ${i}++) {\n\tvar ${v} = ${array}[${i}];\n\t${cursor}\n}"},{prefix:"for",description:"for..in - iterate over properties of an object",template:"for (var ${property} in ${object} {\n\tif (${object}.hasOwnProperty(${property})) {\n\t\t${cursor}\n\t}\n}"},{prefix:"while",description:"while - while loop with condition",template:"while (${condition}) {\n\t${cursor}\n}"},{prefix:"do",description:"do - do while loop with condition",
template:"do {\n\t${cursor}\n} while (${condition});"},{prefix:"switch",description:"switch - switch case statement",template:"switch (${expression}) {\n\tcase ${value1}:\n\t\t${cursor}\n\t\tbreak;\n\tdefault:\n}"},{prefix:"case",description:"case - case statement",template:"case ${value}:\n\t${cursor}\n\tbreak;"},{prefix:"try",description:"try - try..catch statement",template:"try {\n\t${cursor}\n} catch (${err}) {\n}"},{prefix:"try",description:"try - try..catch statement with finally block",template:"try {\n\t${cursor}\n} catch (${err}) {\n} finally {\n}"},
{prefix:"var",description:"var - variable declaration",template:"var ${name};"},{prefix:"var",description:"var - variable declaration with value",template:"var ${name} = ${value};"},{prefix:"let",description:"let - local scope variable declaration",template:"let ${name};"},{prefix:"let",description:"let - local scope variable declaration with value",template:"let ${name} = ${value};"},{prefix:"return",description:"return - return result",template:"return ${result};"},{prefix:"typeof",description:"typeof - typeof statement",
template:'typeof ${var} = "${type}"'},{prefix:"instanceof",description:"instanceof - instanceof statement",template:"${var} instanceof ${type}"},{prefix:"with",description:"with - with statement",template:"with (${object}) {\n\t${cursor}\n}"},{prefix:"function",description:"function - function declaration",template:"function ${name} (${parameter}) {\n\t${cursor}\n}"},{prefix:"log",description:"log - console log",template:"console.log(${object});"}]);m.prototype.isValid=function(h,a,e){h=e-h.length-
1;for(e="";h>=0;)if(e=a[h],e==="\n"||e==="\r")break;else if(/\s/.test(e))h--;else break;return":!@#$^&*.?<>".indexOf(e)===-1};return{JSTemplateContentAssistProvider:m}});
define("orion/editor/AsyncStyler",["i18n!orion/editor/nls/messages","orion/editor/annotations"],function(p,t){function m(f){return f.getProperty("objectClass").indexOf(a)!==-1&&f.getProperty("type")==="highlighter"}function h(a,e,g){this.initialize(a,e,g);this.lineStyles=[]}var a="orion.edit.highlighter",e=a+" service must be an event emitter";t.AnnotationType.registerType("orion.annotation.highlightError",{title:p.syntaxError,html:"<div class='annotationHTML error'></div>",rangeStyle:{styleClass:"annotationRange error"}});
h.prototype={initialize:function(f,e,g){this.textView=f;this.serviceRegistry=e;this.annotationModel=g;this.services=[];var c=this;this.listener={onModelChanging:function(a){c.onModelChanging(a)},onModelChanged:function(a){c.onModelChanged(a)},onDestroy:function(a){c.onDestroy(a)},onLineStyle:function(a){c.onLineStyle(a)},onStyleReady:function(a){c.onStyleReady(a)},onServiceAdded:function(a){c.onServiceAdded(a.serviceReference,c.serviceRegistry.getService(a.serviceReference))},onServiceRemoved:function(a){c.onServiceRemoved(a.serviceReference,
c.serviceRegistry.getService(a.serviceReference))}};f.addEventListener("ModelChanging",this.listener.onModelChanging);f.addEventListener("ModelChanged",this.listener.onModelChanged);f.addEventListener("Destroy",this.listener.onDestroy);f.addEventListener("LineStyle",this.listener.onLineStyle);e.addEventListener("registered",this.listener.onServiceAdded);e.addEventListener("unregistering",this.listener.onServiceRemoved);f=e.getServiceReferences(a);for(g=0;g<f.length;g++){var i=f[g];m(i)&&this.addServiceListener(e.getService(i))}},
onDestroy:function(){this.destroy()},destroy:function(){if(this.textView)this.textView.removeEventListener("ModelChanging",this.listener.onModelChanging),this.textView.removeEventListener("ModelChanged",this.listener.onModelChanged),this.textView.removeEventListener("Destroy",this.listener.onDestroy),this.textView.removeEventListener("LineStyle",this.listener.onLineStyle),this.textView=null;if(this.services){for(var a=0;a<this.services.length;a++)this.removeServiceListener(this.services[a]);this.services=
null}if(this.serviceRegistry)this.serviceRegistry.removeEventListener("registered",this.listener.onServiceAdded),this.serviceRegistry.removeEventListener("unregistering",this.listener.onServiceRemoved),this.serviceRegistry=null;this.lineStyles=this.listener=null},onModelChanging:function(a){this.startLine=this.textView.getModel().getLineAtOffset(a.start)},onModelChanged:function(a){var e=this.startLine;(a.addedLineCount||a.removedLineCount)&&Array.prototype.splice.apply(this.lineStyles,[e,a.removedLineCount].concat(this._getEmptyStyle(a.addedLineCount)))},
onStyleReady:function(a){var e=a.lineStyles||a.style,a=Number.MAX_VALUE,g=-1,c=this.textView.getModel(),i;for(i in e)e.hasOwnProperty(i)&&(this.lineStyles[i]=e[i],a=Math.min(a,i),g=Math.max(g,i));a=Math.max(a,0);g=Math.min(g,c.getLineCount());if(e=this.annotationModel){for(var h=e.getAnnotations(c.getLineStart(a),c.getLineEnd(g)),l=[];h.hasNext();){var o=h.next();o.type==="orion.annotation.highlightError"&&l.push(o)}h=[];for(o=a;o<=g;o++){i=o;var m=this.lineStyles[i],m=m&&m.errors;i=c.getLineStart(i);
if(m)for(var p=0;p<m.length;p++){var v=m[p];h.push(t.AnnotationType.createAnnotation("orion.annotation.highlightError",v.start+i,v.end+i))}}e.replaceAnnotations(l,h)}this.textView.redrawLines(a,g+1)},onLineStyle:function(a){function e(a,g){for(var f=a.length,h=[],k=0;k<f;k++){var m=a[k];h.push({start:m.start+g,end:m.end+g,style:m.style})}return h}var g=this.lineStyles[a.lineIndex];if(g)if(g.ranges)a.ranges=e(g.ranges,a.lineStart);else if(g.style)a.style=g.style},_getEmptyStyle:function(a){for(var e=
[],g=0;g<a;g++)e.push(null);return e},setContentType:function(a){this.contentType=a;if(this.services)for(a=0;a<this.services.length;a++){var e=this.services[a];if(e.setContentType){var g=this.serviceRegistry.getService("orion.page.progress");g?g.progress(e.setContentType(this.contentType),"Styling content type: "+this.contentType.id?this.contentType.id:this.contentType):e.setContentType(this.contentType)}}},onServiceAdded:function(a,e){m(a)&&this.addServiceListener(e)},onServiceRemoved:function(a,
e){this.services.indexOf(e)!==-1&&this.removeServiceListener(e)},addServiceListener:function(a){if(typeof a.addEventListener==="function"){if(a.addEventListener("orion.edit.highlighter.styleReady",this.listener.onStyleReady),this.services.push(a),a.setContentType&&this.contentType){var h=this.serviceRegistry.getService("orion.page.progress");h?h.progress(a.setContentType(this.contentType),"Styling content type: "+this.contentType.id?this.contentType.id:this.contentType):a.setContentType(this.contentType)}}else typeof console!==
"undefined"&&console.log(Error(e))},removeServiceListener:function(a){typeof a.removeEventListener==="function"?(a.removeEventListener("orion.edit.highlighter.styleReady",this.listener.onStyleReady),a=this.services.indexOf(a),a!==-1&&this.services.splice(a,1)):typeof console!=="undefined"&&console.log(Error(e))}};return h});
define("orion/editor/mirror",["i18n!orion/editor/nls/messages","orion/editor/eventTarget","orion/editor/annotations"],function(p,t,m){function h(a){this.string=a;this.tokenStart=this.pos=0}function a(){this._modes={};this.mimeModes={};this.options={};this.StringStream=h}function e(a){var c=[],e;for(e in a)Object.prototype.hasOwnProperty.call(a,e)&&c.push(e);return c}function f(a,c,e){e=e||{};this.model=a;this.codeMirror=c;this.isWhitespaceVisible=typeof e.whitespacesVisible==="undefined"?!1:e.whitespacesVisible;
this.mode=null;this.isModeLoaded=!1;this.lines=[];this.dirtyLines=[];this.startLine=Number.MAX_VALUE;this.endLine=-1;this.timer=null;this.initialize(a)}function k(a,c,e){this.init(a,c,e)}h.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos===0},peek:function(){return this.string[this.pos]},next:function(){return this.string[this.pos++]},eat:function(a){var c=this.string[this.pos];return typeof c==="string"&&(c===a||a.test&&a.test(c)||typeof a==="function"&&
a(c))?this.string[this.pos++]:void 0},eatWhile:function(a){for(var c=!1;this.eat(a)!==void 0;)c=!0;return c},eatSpace:function(){return this.eatWhile(/\s/)},skipToEnd:function(){this.pos=this.string.length},skipTo:function(a){a=this.string.indexOf(a,this.pos);return a!==-1?(this.pos=a,!0):!1},match:function(a,c,e){c=c===!0||typeof c==="undefined";if(typeof a==="string"){var f=e?this.string.toLowerCase():this.string,a=e?a.toLowerCase():a,e=f.indexOf(a,this.pos);if(e!==-1&&c)this.pos=e+a.length;return e!==
-1}else return(a=this.string.substring(this.pos).match(a))&&c&&typeof a[0]==="string"&&(this.pos+=a.index+a[0].length),a},backUp:function(a){this.pos-=a},column:function(){for(var a=0,c=0;c<this.tokenStart;)a+=this.string[c++]==="\t"?4:1;return a},indentation:function(){for(var a=this.string.search(/\S/),c=0,e=0;e<a;)c+=this.string[e++]==="\t"?4:1;return c},current:function(){return this.string.substring(this.tokenStart,this.pos)},advance:function(){this.tokenStart=this.pos}};a.prototype={options:{},
setOption:function(a,c){this.options[a]=c},getOption:function(a){return this.options[a]},copyState:function(a,c){if(typeof a.copyState==="function")return a.copyState(c);var e={},f;for(f in c){var h=c[f];e[f]=h instanceof Array?h.slice():h}return e},defineMode:function(a,c){this._modes[a]=c},defineMIME:function(a,c){this.mimeModes[a]=c},getMode:function(a,c){var e={},f;typeof c==="string"&&this.mimeModes[c]&&(c=this.mimeModes[c]);typeof c==="object"&&(e=c,f=this._modes[c.name]);f=f||this._modes[c];
if(typeof f!=="function")throw"Mode not found "+c;return f(a,e)},listModes:function(){return e(this._modes)},listMIMEs:function(){return e(this.mimeModes)},_getModeName:function(a){a=this.mimeModes[a];if(typeof a==="object")a=a.name;return a}};f.prototype={initialize:function(){var a=this;this.listener={onModelChanging:function(c){a._onModelChanging(c)},onModelChanged:function(c){a._onModelChanged(c)},onDestroy:function(c){a._onDestroy(c)}};this.model.addEventListener("Changing",this.listener.onModelChanging);
this.model.addEventListener("Changed",this.listener.onModelChanged);this.model.addEventListener("Destroy",this.listener.onDestroy)},destroy:function(){this.model&&(this.model.removeEventListener("Changing",this.listener.onModelChanging),this.model.removeEventListener("Changed",this.listener.onModelChanged),this.model.removeEventListener("Destroy",this.listener.onDestroy));this.dirtyLines=this.lines=this.mode=this.codeMirror=this.model=null;clearTimeout(this.timer);this.timer=null},_onModelChanging:function(a){this.startLine=
this.model.getLineAtOffset(a.start)},_onModelChanged:function(a){this._dbgEvent(a);var c=this.startLine;(a.removedLineCount||a.addedLineCount)&&Array.prototype.splice.apply(this.lines,[c+1,a.removedLineCount].concat(this._newLines(a.addedLineCount)));this.mode&&(a=Math.max(a.addedLineCount,a.removedLineCount),a=c+Math.min(a,500),this.highlight(c,a),this.highlightLater(a+1))},_onDestroy:function(){this.destroy()},setViewportIndex:function(a){this.viewportIndex=a},_dbgEvent:function(){},_dbgStyle:function(){},
_newLines:function(a){for(var c=[],e=0;e<a;e++)c.push({style:null,eolState:null});return c},setMode:function(a,c){if(a)this.mode=this.codeMirror.getMode(this.codeMirror.options,a),this.lines=this._newLines(this.model.getLineCount()),c&&this.highlight()},highlight:function(a,c,e){if(this.mode){for(var f=this.model.getLineCount(),a=typeof a==="undefined"?0:a,c=typeof c==="undefined"?f-1:Math.min(c,f-1),f=this.mode,h=this.getState(a),k=a;k<=c;k++){var m=this.lines[k];this.highlightLine(k,m,h);m.eolState=
this.codeMirror.copyState(f,h)}this._expandRange(a,c);if(!e)this.onHighlightDone()}},highlightLater:function(a){this.dirtyLines.push(a);var c=this;this.timer=setTimeout(function(){c._highlightJob()},50)},_highlightJob:function(){for(var a=+new Date+30,c=this.mode.compareStates,e=this.model.getLineCount();this.dirtyLines.length;){var f=this.viewportIndex,h=this.lines[f],f=h&&!h.eolState?f:this.dirtyLines.pop();if(f>=e)break;this._expandRange(f,f);for(var h=this._getResumeLineIndex(f),f=h+1,h=(h=h>=
0&&this.lines[h].eolState)?this.codeMirror.copyState(this.mode,h):this.mode.startState(),k=0,m=f;m<e;m++){var p=this.lines[m],t=p.eolState,b=this.highlightLine(m,p,h);p.eolState=this.codeMirror.copyState(this.mode,h);b&&this._expandRange(f,m+1);var p=c&&t&&c(t,p.eolState),d=!c&&!b&&k++>3;if(p||d)break;else if(!t||b)k=0;t=m<e||this.dirtyLines.length;if(+new Date>a&&t){this.highlightLater(m+1);this.onHighlightDone();return}}}this.onHighlightDone()},onHighlightDone:function(){this.startLine!==Number.MAX_VALUE&&
this.endLine!==-1&&this.dispatchEvent({type:"Highlight",start:this.startLine,end:this.endLine});this.startLine=Number.MAX_VALUE;this.endLine=-1},_getResumeLineIndex:function(a){for(var c=this.lines,e=a-1;e>=0;e--)if(c[e].eolState||a-e>40)return e;return-1},getState:function(a){var c=this.mode,e=this.lines,f,h;for(f=a-1;f>=0;f--)if(h=e[f],h.eolState||a-f>40)break;var k=f>=0&&e[f].eolState;if(k){k=this.codeMirror.copyState(c,k);for(f=Math.max(0,f);f<a-1;f++)h=e[f],this.highlightLine(f,h,k),h.eolState=
this.codeMirror.copyState(c,k);return k}else return c.startState()},highlightLine:function(a,c,e){if(this.mode){var f=this.model;f.getLineStart(a)===f.getLineEnd(a)&&this.mode.blankLine&&this.mode.blankLine(e);for(var k=c.style||[],a=f.getLine(a),a=new h(a),f=!c.style,o=[],m=0;!a.eol();m++){var p=this.mode.token(a,e)||null,t=a.current();this._whitespaceStyle(p,t,a.tokenStart);p=[a.tokenStart,a.pos,p];t=k[m];o.push(p);f=f||!t||t[0]!==p[0]||t[1]!==p[1]||t[2]!==p[2];a.advance()}if(f=f||o.length!==k.length)c.style=
o.length?o:null;return f}},_whitespaceStyle:function(a,c,e){if(!a&&this.isWhitespaceVisible&&/\s+/.test(c)){for(var a=[],f,h,k=0;k<c.length;k++){var m=c[k];m!==h&&(h&&a.push([e+f,e+k,h==="\t"?"token_tab":"token_space"]),f=k,h=m)}a.push([e+f,e+k,h==="\t"?"token_tab":"token_space"]);return a}return null},_expandRange:function(a,c){this.startLine=Math.min(this.startLine,a);this.endLine=Math.max(this.endLine,c)},toStyleRangesAndErrors:function(a,c){var e=a.style;if(!e)return null;for(var f=[],h=[],k=
typeof c==="undefined"?0:this.model.getLineStart(c),m=0;m<e.length;m++){var p=e[m],t=!p[2]?null:p[2]==="token_tab"||p[2]==="token_space"?p[2]:"cm-"+p[2];t&&(p={start:k+p[0],end:k+p[1],style:{styleClass:t}},f.push(p),t==="cm-error"&&h.push(p))}return[f,h]},getLineStyle:function(a){return this.lines[a]},getLineStyles:function(){return this.lines}};t.EventTarget.addMixin(f.prototype);m.AnnotationType.registerType("orion.annotation.highlightError",{title:p.syntaxError,html:"<div class='annotationHTML error'></div>",
rangeStyle:{styleClass:"annotationRange error"}});k.prototype={init:function(a,c,e){this.textView=a;this.annotationModel=e;this.modeApplier=new f(a.getModel(),c);var h=this;this.listener={onLineStyle:function(a){h.onLineStyle(a)},onDestroy:function(a){h.onDestroy(a)},onHighlight:function(a){h.onHighlight(a)}};a.addEventListener("LineStyle",this.listener.onLineStyle);a.addEventListener("Destroy",this.listener.onDestroy);this.modeApplier.addEventListener("Highlight",this.listener.onHighlight)},destroy:function(){this.modeApplier&&
(this.modeApplier.removeEventListener("Highlight",this.listener.onHighlight),this.modeApplier.destroy());this.textView&&(this.textView.removeEventListener("LineStyle",this.listener.onLineStyle),this.textView.removeEventListener("Destroy",this.listener.onDestroy));this.listener=this.modeApplier=this.annotationModel=this.textView=null},setMode:function(a){this.modeApplier.setMode(a)},onLineStyle:function(a){var c=a.lineIndex,e=this.modeApplier,f=e.getLineStyle(c);if(!f||!f.eolState){var h=this.textView.getModel().getLineCount();
e.highlight(c,Math.min(c+20,h-1),!0);f=e.getLineStyle(c)}h=this.textView.getModel();if(f){var k=e.toStyleRangesAndErrors(f,c);if(k&&(a.ranges=k[0],a=this.annotationModel)){e=[];f=[];if(k=k[1])for(var p=0;p<k.length;p++){var u=k[p];u.style.styleClass==="cm-error"&&f.push(m.AnnotationType.createAnnotation("orion.annotation.highlightError",u.start,u.end))}for(c=a.getAnnotations(h.getLineStart(c),h.getLineEnd(c));c.hasNext();)h=c.next(),h.type==="orion.annotation.highlightError"&&e.push(h);a.replaceAnnotations(e,
f)}}},onHighlight:function(a){this.textView.redrawLines(a.start,a.end)},onDestroy:function(){this.destroy()}};return{Mirror:a,ModeApplier:f,CodeMirrorStyler:k}});
define("orion/editor/textMateStyler",["orion/editor/regex"],function(p){function t(a){var e;if(a instanceof Array){e=Array(a.length);for(var f=0;f<a.length;f++)e[f]=t(a[f])}else for(f in e={},a)if(Object.prototype.hasOwnProperty.call(a,f)){var h=a[f];e[f]=typeof h==="object"&&h!==null?t(h):h}return e}function m(a,e,f){this.initialize(a);this.grammar=t(e);this.externalGrammars=f?t(f):[];this._styles={};this._tree=null;this._allGrammars={};this.preprocess(this.grammar)}var h={unsupported:[{regex:/\(\?[ims\-]:/,
func:function(){return"option on/off for subexp"}},{regex:/\(\?<([=!])/,func:function(a){return a[1]==="="?"lookbehind":"negative lookbehind"}},{regex:/\(\?>/,func:function(){return"atomic group"}}],toRegExp:function(a){function e(a,e){throw Error('Unsupported regex feature "'+a+'": "'+e[0]+'" at index: '+e.index+" in "+e.input);}var f="",k,a=h.processGlobalFlag("x",a,function(a){for(var e="",f=!1,g=a.length,h=0;h<g;){var k=a.charAt(h);if(!f&&k==="#")for(;h<g&&k!=="\r"&&k!=="\n";)k=a.charAt(++h);
else if(!f&&/\s/.test(k))for(;h<g&&/\s/.test(k);)k=a.charAt(++h);else k==="\\"?(e+=k,/\s/.test(a.charAt(h+1))||(e+=a.charAt(h+1),h+=1)):(k==="["?f=!0:k==="]"&&(f=!1),e+=k),h+=1}return e}),a=h.processGlobalFlag("i",a,function(a){f+="i";return a});for(k=0;k<this.unsupported.length;k++){var g;(g=this.unsupported[k].regex.exec(a))&&e(this.unsupported[k].func(g),g)}return RegExp(a,f)},processGlobalFlag:function(a,e,f){function h(a,e){for(var f=0,g=a.length,k=-1,m=e;m<g&&k===-1;m++)switch(a.charAt(m)){case "\\":m++;
break;case "(":f++;break;case ")":f--,f===0&&(k=m)}return k}var g="(?"+a+")",a="(?"+a+":";if(e.substring(0,g.length)===g)return f(e.substring(g.length));else if(e.substring(0,a.length)===a){g=h(e,0);if(g<e.length-1)throw Error("Only a "+a+") group that encloses the entire regex is supported in: "+e);return f(e.substring(a.length,g))}return e},hasBackReference:function(a){return/\\\d+/.test(a.source)},getSubstitutedRegex:function(a,e,f){for(var f=typeof f==="undefined"?!0:!1,a=a.source.split(/(\\\d+)/g),
h=[],g=0;g<a.length;g++){var c=a[g],i=/\\(\d+)/.exec(c);i?(c=e[i[1]]||"",h.push(f?p.escape(c):c)):h.push(c)}return RegExp(h.join(""))},groupify:function(a,e){for(var f=a.source,h=f.length,g=[],c=0,i=[],q=1,l=1,o=[],m={},p={},t=0;t<h;t++){var b=g[g.length-1],d=f.charAt(t);switch(d){case "(":if(b===4)g.pop(),o.push(")"),i[i.length-1].end=t;var j=t+2<h?f.charAt(t+1)+""+f.charAt(t+2):null;if(j==="?:"||j==="?="||j==="?!"){var r;j==="?:"?r=1:(r=3,c++);g.push(r);i.push({start:t,end:-1,type:r});o.push(d);
o.push(j);t+=j.length}else g.push(2),i.push({start:t,end:-1,type:2,oldNum:q,num:l}),o.push(d),c===0&&(p[l]=null),m[q]=l,q++,l++;break;case ")":b=g.pop();b===3&&c--;i[i.length-1].end=t;o.push(d);break;case "*":case "+":case "?":case "}":var x=d,n=f.charAt(t-1),j=t-1;if(d==="}"){for(r=t-1;f.charAt(r)!=="{"&&r>=0;r--);n=f.charAt(r-1);j=r-1;x=f.substring(r,t+1)}r=i[i.length-1];if(n===")"&&(r.type===2||r.type===4)){o.splice(r.start,0,"(");o.push(x);o.push(")");d={start:r.start,end:o.length-1,type:4,num:r.num};
for(n=0;n<i.length;n++)if(b=i[n],(b.type===2||b.type===4)&&b.start>=r.start&&b.end<=j)if(b.start+=1,b.end+=1,b.num+=1,b.type===2)m[b.oldNum]=b.num;i.push(d);l++;break}default:d!=="|"&&b!==2&&b!==4&&c===0&&(g.push(4),i.push({start:t,end:-1,type:4,num:l}),o.push("("),p[l]=null,l++),o.push(d),d==="\\"&&(d=f.charAt(t+1),o.push(d),t+=1)}}for(;g.length;)g.pop(),o.push(")");var f=RegExp(o.join("")),h={},e=e||m,z;for(z in e)e.hasOwnProperty(z)&&(h[z]="\\"+e[z]);f=this.getSubstitutedRegex(f,h,!1);return[f,
m,p]},complexCaptures:function(a){if(!a)return!1;for(var e in a)if(a.hasOwnProperty(e)&&e!=="0")return!0;return!1}};m.prototype={initialize:function(a){this.textView=a;this.textView.stylerOptions=this;var e=this;this._listener={onModelChanged:function(a){e.onModelChanged(a)},onDestroy:function(a){e.onDestroy(a)},onLineStyle:function(a){e.onLineStyle(a)},onStorage:function(a){e.onStorage(a)}};a.addEventListener("ModelChanged",this._listener.onModelChanged);a.addEventListener("Destroy",this._listener.onDestroy);
a.addEventListener("LineStyle",this._listener.onLineStyle);a.redrawLines()},onDestroy:function(){this.destroy()},destroy:function(){if(this.textView)this.textView.removeEventListener("ModelChanged",this._listener.onModelChanged),this.textView.removeEventListener("Destroy",this._listener.onDestroy),this.textView.removeEventListener("LineStyle",this._listener.onLineStyle),this.textView=null;this._listener=this._tree=this._styles=this.grammar=null},preprocess:function(a){for(a=[a];a.length!==0;){var e=
a.pop();if(!e._resolvedRule||!e._typedRule)if(e._resolvedRule=this._resolve(e),e._typedRule=this._createTypedRule(e),this.addStyles(e.name),this.addStyles(e.contentName),this.addStylesForCaptures(e.captures),this.addStylesForCaptures(e.beginCaptures),this.addStylesForCaptures(e.endCaptures),e._resolvedRule!==e&&a.push(e._resolvedRule),e.patterns)for(var f=0;f<e.patterns.length;f++)a.push(e.patterns[f])}},addStyles:function(a){if(a&&!this._styles[a]){this._styles[a]=[];for(var e=a.split("."),f=0;f<
e.length;f++)this._styles[a].push(e.slice(0,f+1).join("-"))}},addStylesForCaptures:function(a){for(var e in a)a.hasOwnProperty(e)&&this.addStyles(a[e].name)},ContainerRule:function(){function a(a){this.rule=a;this.subrules=a.patterns}a.prototype.valueOf=function(){return"aa"};return a}(),BeginEndRule:function(){function a(a){this.rule=a;this.beginRegex=h.toRegExp(a.begin);this.endRegex=h.toRegExp(a.end);this.subrules=a.patterns||[];this.endRegexHasBackRef=h.hasBackReference(this.endRegex);var f=h.complexCaptures(a.captures),
a=h.complexCaptures(a.beginCaptures)||h.complexCaptures(a.endCaptures);if(this.isComplex=f||a)f=h.groupify(this.beginRegex),this.beginRegex=f[0],this.beginOld2New=f[1],this.beginConsuming=f[2],f=h.groupify(this.endRegex,this.beginOld2New),this.endRegex=f[0],this.endOld2New=f[1],this.endConsuming=f[2]}a.prototype.valueOf=function(){return this.beginRegex};return a}(),MatchRule:function(){function a(a){this.rule=a;this.matchRegex=h.toRegExp(a.match);if(this.isComplex=h.complexCaptures(a.captures))a=
h.groupify(this.matchRegex),this.matchRegex=a[0],this.matchOld2New=a[1],this.matchConsuming=a[2]}a.prototype.valueOf=function(){return this.matchRegex};return a}(),_createTypedRule:function(a){return a.match?new this.MatchRule(a):a.begin?new this.BeginEndRule(a):new this.ContainerRule(a)},_resolve:function(a){var e=a;if(a.include){if(a.begin||a.end||a.match)throw Error('Unexpected regex pattern in "include" rule '+a.include);a=a.include;if(a.charAt(0)==="#"){if(e=this.grammar.repository&&this.grammar.repository[a.substring(1)],
!e)throw Error("Couldn't find included rule "+a+" in grammar repository");}else if(a==="$self")e=this.grammar;else if(a==="$base")throw Error('Include "$base" is not supported');else if(e=this._allGrammars[a],!e)for(var f=0;f<this.externalGrammars.length;f++){var h=this.externalGrammars[f];if(h.scopeName===a){this.preprocess(h);e=this._allGrammars[a]=h;break}}}return e},ContainerNode:function(){function a(a,f){this.parent=a;this.rule=f;this.children=[];this.end=this.start=null}a.prototype.addChild=
function(a){this.children.push(a)};a.prototype.valueOf=function(){var a=this.rule;return"ContainerNode { "+(a.include||"")+" "+(a.name||"")+(a.comment||"")+"}"};return a}(),BeginEndNode:function(){function a(a,f,k){this.parent=a;this.rule=f;this.children=[];this.setStart(k);this.endMatch=this.end=null;this.endRegexSubstituted=f.endRegexHasBackRef?h.getSubstitutedRegex(f.endRegex,k):null}a.prototype.addChild=function(a){this.children.push(a)};a.prototype.getIndexInParent=function(){return this.parent?
this.parent.children.indexOf(this):-1};a.prototype.setStart=function(a){this.start=a.index;this.beginMatch=a};a.prototype.setEnd=function(a){a&&typeof a==="object"?(this.endMatch=a,this.end=a.index+a[0].length):(this.endMatch=null,this.end=a)};a.prototype.shiftStart=function(a){this.start+=a;this.beginMatch.index+=a};a.prototype.shiftEnd=function(a){this.end+=a;this.endMatch&&(this.endMatch.index+=a)};a.prototype.valueOf=function(){return"{"+this.rule.beginRegex+" range="+this.start+".."+this.end+
"}"};return a}(),push:function(a,e){if(e)for(var f=e.length;f>0;)a.push(e[--f])},exec:function(a,e,f){(e=a.exec(e))&&(e.index+=f);a.lastIndex=0;return e},afterMatch:function(a){return a.index+a[0].length},getEndMatch:function(a,e,f){if(a instanceof this.BeginEndNode){var h=a.rule,a=a.endRegexSubstituted||h.endRegex;return!a?null:this.exec(a,e,f)}return null},initialParse:function(){this.textView.getModel().getCharCount();this._tree=new this.ContainerNode(null,this.grammar._typedRule);this.parse(this._tree,
!1,0)},onModelChanged:function(a){var e=a.addedCharCount,f=a.removedCharCount,a=a.start;if(this._tree){var h=this.textView.getModel(),g=h.getCharCount(),h=h.getLineEnd(h.getLineAtOffset(a)-1),c=this.getFirstDamaged(h,h),h=h===-1?0:h,e=c?this.parse(c,!0,h,a,e,f):g;this.textView.redrawRange(h,e)}else this.initialParse()},getFirstDamaged:function(a,e){if(a<0)return this._tree;for(var f=[this._tree],h=null;f.length;){var g=f.pop();if(!g.parent||this.isDamaged(g,a,e)){g instanceof this.BeginEndNode&&(h=
g);for(var c=0;c<g.children.length;c++)f.push(g.children[c])}}return h||this._tree},isDamaged:function(a,e,f){return a.start<=f&&a.end>e},parse:function(a,e,f,h,g,c){var i=this.textView.getModel(),q=i.getLineStart(i.getLineCount()-1),l=i.getCharCount(),o=this.getInitialExpected(a,f),m=-1;if(e)a.repaired=!0,a.endNeedsUpdate=!0,m=(m=a.children[a.children.length-1])?i.getLineEnd(i.getLineAtOffset(m.end+(g-c))):-1,h=i.getLineEnd(i.getLineAtOffset(h+c)),m=Math.max(m,h);for(var m=m===-1?l:m,h=o,p=a,t=!1,
b=f,d=-1;p&&(!e||b<m);){var j=this.getNextMatch(i,p,b);j||(b=b>=q?l:i.getLineStart(i.getLineAtOffset(b)+1));var r=j&&j.match,x=j&&j.rule,n=j&&j.isEnd;if(j&&j.isSub){if(b=this.afterMatch(r),x instanceof this.BeginEndRule)t=!0,e&&x===h.rule&&p===h.parent?(p=h,p.setStart(r),p.repaired=!0,p.endNeedsUpdate=!0,h=this.getNextExpected(h,"begin")):(e&&(this.prune(p,h),e=!1),r=new this.BeginEndNode(p,x,r),p.addChild(r),p=r)}else if(n||b===l){if(p instanceof this.BeginEndNode)r?(t=!0,d=Math.max(d,p.end),p.setEnd(r),
b=this.afterMatch(r),e&&p===h&&p.parent===h.parent?(p.repaired=!0,delete p.endNeedsUpdate,h=this.getNextExpected(h,"end")):e&&(this.prune(p,h),e=!1)):(p.setEnd(l),delete p.endNeedsUpdate);p=p.parent}e&&b>=m&&!t&&(this.prune(a,o),e=!1)}this.removeUnrepairedChildren(a,e,f);this.cleanup(e,a,f,m,l,g,c);return e?Math.max(d,b):b},removeUnrepairedChildren:function(a,e,f){if(e){for(var e=a.children,h=-1,g=0;g<e.length;g++){var c=e[g];if(!c.repaired&&this.isDamaged(c,f,Number.MAX_VALUE)){h=g;break}}if(h!==
-1)a.children.length=h}},cleanup:function(a,e,f,h,g,c,i){if(a){a=c-i;g=this.getIntersecting(h-a+1,g);e=this.getIntersecting(f,h);for(f=0;f<g.length;f++)h=g[f],!h.repaired&&h instanceof this.BeginEndNode&&(h.shiftEnd(a),h.shiftStart(a));for(f=0;f<e.length;f++)h=e[f],h.repaired&&h.endNeedsUpdate&&h.shiftEnd(a),delete h.endNeedsUpdate,delete h.repaired}else{e=this.getIntersecting(f,h);for(f=0;f<e.length;f++)delete e[f].repaired}},getNextMatch:function(a,e,f,h){var g=a.getLineAtOffset(f),g=a.getLineEnd(g),
c=a.getText(f,g),i=[],m=[],a=[],g=[];for(this.push(i,e.rule.subrules);i.length;){var l=i.length?i.pop():null,l=l&&l._resolvedRule._typedRule;if(l instanceof this.ContainerRule&&m.indexOf(l)===-1)m.push(l),this.push(i,l.subrules);else if(!l||!h||l.matchRegex){var o=l&&this.exec(l.matchRegex||l.beginRegex,c,f);o&&(a.push(o),g.push(l))}}i=Number.MAX_VALUE;m=-1;for(l=0;l<a.length;l++)if(o=a[l],o.index<i)i=o.index,m=l;if(!h&&(f=this.getEndMatch(e,c,f)))if(h=e.rule.applyEndPatternLast,m===-1||f.index<i||
!h&&f.index===i)return{isEnd:!0,rule:e.rule,match:f};return m===-1?null:{isSub:!0,rule:g[m],match:a[m]}},getInitialExpected:function(a,e){var f,h;if(a===this._tree)for(f=0;f<a.children.length;f++){if(h=a.children[f],h.start>=e)return h}else if(a instanceof this.BeginEndNode&&a.endMatch){var g=a.endMatch.index;for(f=0;f<a.children.length;f++)if(h=a.children[f],h.start>=e)break;if(h&&h.start<g)return h}return a},getNextExpected:function(a,e){if(e==="begin"){var f=a.children[0];return f?f:a}else if(e===
"end"&&(f=a.parent)){var h=f.children[f.children.indexOf(a)+1];return h?h:f}return null},prune:function(a,e){if(e.parent===a)a.children.length=e.getIndexInParent();else if(a instanceof this.BeginEndNode)a.endMatch=null,a.end=null;if(a.parent)a.parent.children.length=a.getIndexInParent()+1},onLineStyle:function(a){this._tree||this.initialParse();var e=a.lineStart,f=this.textView.getModel(),h=f.getLineEnd(a.lineIndex),g=f.getLineEnd(f.getLineAtOffset(e)-1),g=this.getFirstDamaged(g,g),e=this.getLineScope(f,
g,e,h);a.ranges=this.toStyleRanges(e);a.ranges.sort(function(a,e){return a.start-e.start})},getLineScope:function(a,e,f,h){for(var g=f,c=this.getInitialExpected(e,f),i=[],m=[];e&&g<h;){var l=this.getNextMatch(a,e,g);if(!l)break;var o=l&&l.match,p=l&&l.rule,t=l&&l.isSub,l=l&&l.isEnd;o.index!==g&&m.push({start:g,end:o.index,node:e});if(t)g=this.afterMatch(o),p instanceof this.BeginEndRule?(this.addBeginScope(i,o,p),e=c,c=this.getNextExpected(c,"begin")):this.addMatchScope(i,o,p);else if(l)g=this.afterMatch(o),
this.addEndScope(i,o,p),c=this.getNextExpected(c,"end"),e=e.parent}g<h&&m.push({start:g,end:h,node:e});a=this.getInheritedLineScope(m,f,h);return i.concat(a)},getInheritedLineScope:function(a){for(var e=[],f=0;f<a.length;f++)for(var h=a[f],g=h.node;g;){var c=g.rule.rule,i=c.name;if(c=c.contentName||i){this.addScopeRange(e,h.start,h.end,c);break}g=g.parent}return e},addBeginScope:function(a,e,f){var h=f.rule;this.addCapturesScope(a,e,h.beginCaptures||h.captures,f.isComplex,f.beginOld2New,f.beginConsuming)},
addEndScope:function(a,e,f){var h=f.rule;this.addCapturesScope(a,e,h.endCaptures||h.captures,f.isComplex,f.endOld2New,f.endConsuming)},addMatchScope:function(a,e,f){var h=f.rule,g=h.name;(h=h.captures)?this.addCapturesScope(a,e,h,f.isComplex,f.matchOld2New,f.matchConsuming):this.addScope(a,e,g)},addScope:function(a,e,f){f&&a.push({start:e.index,end:this.afterMatch(e),scope:f})},addScopeRange:function(a,e,f,h){h&&a.push({start:e,end:f,scope:h})},addCapturesScope:function(a,e,f,h,g,c){if(f)if(h){for(var h=
{1:0},i=0,m=1;e[m]!==void 0;m++)c[m]!==void 0&&(i+=e[m].length),e[m+1]!==void 0&&(h[m+1]=i);c=e.index;for(i=1;f[i];i++){var m=f[i].name,l=g[i],o=c+h[l];typeof e[l]!=="undefined"&&this.addScopeRange(a,o,o+e[l].length,m)}}else this.addScope(a,e,f[0]&&f[0].name)},getIntersecting:function(a,e){for(var f=[],h=this._tree?[this._tree]:[];h.length;){var g=h.pop(),c=!1;g instanceof this.ContainerNode?c=!0:this.isDamaged(g,a,e)&&(c=!0,f.push(g));if(c)for(var c=g.children.length,i=0;i<c;i++)h.push(g.children[i])}return f.reverse()},
toStyleRanges:function(a){for(var e=[],f=0;f<a.length;f++){var h=a[f],g=this._styles[h.scope];if(!g)throw Error("styles not found for "+h.scope);g=g.join(" ");e.push({start:h.start,end:h.end,style:{styleClass:g}})}return e}};return{RegexUtil:h,TextMateStyler:m}});
define("orion/editor/htmlGrammar",[],function(){return{HtmlGrammar:function(){return{scopeName:"source.html",uuid:"3B5C76FB-EBB5-D930-F40C-047D082CE99B",patterns:[{begin:"<!(doctype|DOCTYPE)",end:">",contentName:"entity.name.tag.doctype.html",beginCaptures:{0:{name:"entity.name.tag.doctype.html"}},endCaptures:{0:{name:"entity.name.tag.doctype.html"}}},{begin:"<\!--",end:"--\>",beginCaptures:{0:{name:"punctuation.definition.comment.html"}},endCaptures:{0:{name:"punctuation.definition.comment.html"}},
patterns:[{match:"--",name:"invalid.illegal.badcomment.html"}],contentName:"comment.block.html"},{match:"<[A-Za-z0-9_\\-:]+(?= ?)",name:"entity.name.tag.html"},{include:"#attrName"},{include:"#qString"},{include:"#qqString"},{include:"#entity"},{match:"</[A-Za-z0-9_\\-:]+>",name:"entity.name.tag.html"},{match:">",name:"entity.name.tag.html"}],repository:{attrName:{match:"[A-Za-z\\-:]+(?=\\s*=\\s*['\"])",name:"entity.other.attribute.name.html"},qqString:{match:'(")[^"]+(")',name:"string.quoted.double.html"},
qString:{match:"(')[^']+(')",name:"string.quoted.single.html"},entity:{match:"&[A-Za-z0-9]+;",name:"constant.character.entity.html"}}}}}});
define("examples/editor/textStyler",["orion/editor/annotations","orion/editor/keywords"],function(p,t){function m(a,b){this.keywords=a;this.whitespacesVisible=b;this.setText("")}function h(){m.call(this,null,!0)}function a(a){m.call(this,null,a)}function e(){m.call(this,null,!1)}function f(b,d,f){this.commentStart="/*";this.commentEnd="*/";var i=[];switch(d){case "java":i=g;break;case "js":i=k;break;case "css":i=c}this.whitespacesVisible=!1;this.detectHyperlinks=!0;this.highlightCaretLine=!1;this.detectTasks=
this.foldingEnabled=!0;this._scanner=new m(i,this.whitespacesVisible);this._firstScanner=new e;this._commentScanner=new a(this.whitespacesVisible);this._whitespaceScanner=new h;if(d==="css")this._scanner.isCSS=!0,this._firstScanner.isCSS=!0;this.view=b;this.annotationModel=f;this._bracketAnnotations=void 0;var j=this;this._listener={onChanged:function(a){j._onModelChanged(a)},onDestroy:function(a){j._onDestroy(a)},onLineStyle:function(a){j._onLineStyle(a)},onMouseDown:function(a){j._onMouseDown(a)},
onSelection:function(a){j._onSelection(a)}};d=b.getModel();d.getBaseModel&&(d=d.getBaseModel());d.addEventListener("Changed",this._listener.onChanged);b.addEventListener("MouseDown",this._listener.onMouseDown);b.addEventListener("Selection",this._listener.onSelection);b.addEventListener("Destroy",this._listener.onDestroy);b.addEventListener("LineStyle",this._listener.onLineStyle);this._computeComments();this._computeFolding();b.redrawLines()}var k=t.JSKeywords,g=t.JAVAKeywords,c=t.CSSKeywords,i={styleClass:"comment"},
q={styleClass:"token_multiline_comment"},l={styleClass:"token_doc_comment"},o={styleClass:"token_doc_html_markup"},s={styleClass:"token_task_tag"},u={styleClass:"token_doc_tag"},v={styleClass:"token_string"},b={styleClass:"token_number"},d={styleClass:"token_keyword"},j={styleClass:"token_space"},r={styleClass:"token_tab"},x={styleClass:"line_caret"};m.prototype={getOffset:function(){return this.offset},getStartOffset:function(){return this.startOffset},getData:function(){return this.text.substring(this.startOffset,
this.offset)},getDataLength:function(){return this.offset-this.startOffset},_default:function(a){switch(a){case 32:case 9:if(this.whitespacesVisible)return a===32?11:10;do a=this._read();while(a===32||a===9);this._unread(a);return 9;case 123:case 125:case 40:case 41:case 91:case 93:case 60:case 62:return a;default:var b=this.isCSS,c=this.offset-1;if(!b&&48<=a&&a<=57){var d=b=!1,e=!1,f=a;do if(a=this._read(),a===46&&!b)b=!0;else if(a===101&&!d)b=d=!0,a=this._read(),a!==45&&this._unread(a);else if(a===
120&&f===48&&this.offset-c===2)b=d=e=!0;else if(!(48<=a&&a<=57||e&&(65<=a&&a<=70||97<=a&&a<=102)))break;while(1);this._unread(a);return 3}if(97<=a&&a<=122||65<=a&&a<=90||a===95||45===a&&b){do a=this._read();while(97<=a&&a<=122||65<=a&&a<=90||a===95||48<=a&&a<=57||45===a&&b);this._unread(a);a=this.keywords;if(a.length>0){c=this.text.substring(c,this.offset);for(b=0;b<a.length;b++)if(this.keywords[b]===c)return 2}}return 1}},_read:function(){return this.offset<this.text.length?this.text.charCodeAt(this.offset++):
-1},_unread:function(a){a!==-1&&this.offset--},nextToken:function(){for(this.startOffset=this.offset;;){var a=this._read(),b;switch(a){case -1:return null;case 47:a=this._read();if(!this.isCSS&&a===47)for(;;)if(a=this._read(),a===-1||a===10||a===13)return this._unread(a),6;if(a===42){a=this._read();b=7;for(a===42&&(b=8);;){for(;a===42;)if(a=this._read(),a===47)return b;if(a===-1)return this._unread(a),b;a=this._read()}}this._unread(a);return 1;case 39:for(b=4;;)switch(a=this._read(),a){case 39:return b;
case 13:case 10:case -1:return this._unread(a),b;case 92:switch(a=this._read(),a){case 10:b=5;break;case 13:b=5,a=this._read(),a!==10&&this._unread(a)}}break;case 34:for(b=4;;)switch(a=this._read(),a){case 34:return b;case 13:case 10:case -1:return this._unread(a),b;case 92:switch(a=this._read(),a){case 10:b=5;break;case 13:b=5,a=this._read(),a!==10&&this._unread(a)}}break;default:return this._default(a)}}},setText:function(a){this.text=a;this.startOffset=this.offset=0}};h.prototype=new m(null);h.prototype.nextToken=
function(){for(this.startOffset=this.offset;;){var a=this._read();switch(a){case -1:return null;case 32:return 11;case 9:return 10;default:do a=this._read();while(!(a===32||a===9||a===-1));this._unread(a);return 1}}};a.prototype=new m(null);a.prototype.setType=function(a){this._type=a};a.prototype.nextToken=function(){for(this.startOffset=this.offset;;){var a=this._read();switch(a){case -1:return null;case 32:case 9:if(this.whitespacesVisible)return a===32?11:10;do a=this._read();while(a===32||a===
9);this._unread(a);return 9;case 60:if(this._type===8){do a=this._read();while(!(a===62||a===-1));if(a===62)return 12}return 1;case 64:if(this._type===8){do a=this._read();while(97<=a&&a<=122||65<=a&&a<=90||a===95||48<=a&&a<=57);this._unread(a);return 13}return 1;case 84:if((a=this._read())===79)if((a=this._read())===68)if((a=this._read())===79)if(a=this._read(),!(97<=a&&a<=122||65<=a&&a<=90||a===95||48<=a&&a<=57))return this._unread(a),14;this._unread(a);default:do a=this._read();while(!(a===32||
a===9||a===-1||a===60||a===64||a===84));this._unread(a);return 1}}};e.prototype=new m(null);e.prototype._default=function(a){for(;;)switch(a=this._read(),a){case 47:case 34:case 39:case -1:return this._unread(a),1}};f.prototype={destroy:function(){var a=this.view;if(a){var b=a.getModel();b.getBaseModel&&(b=b.getBaseModel());b.removeEventListener("Changed",this._listener.onChanged);a.removeEventListener("MouseDown",this._listener.onMouseDown);a.removeEventListener("Selection",this._listener.onSelection);
a.removeEventListener("Destroy",this._listener.onDestroy);a.removeEventListener("LineStyle",this._listener.onLineStyle);this.view=null}},setHighlightCaretLine:function(a){this.highlightCaretLine=a},setWhitespacesVisible:function(a){this.whitespacesVisible=a;this._scanner.whitespacesVisible=a;this._commentScanner.whitespacesVisible=a},setDetectHyperlinks:function(a){this.detectHyperlinks=a},setFoldingEnabled:function(a){this.foldingEnabled=a},setDetectTasks:function(a){this.detectTasks=a},_binarySearch:function(a,
b,c,d,e){var f;d===void 0&&(d=-1);if(e===void 0)e=a.length;for(;e-d>1;)if(f=Math.floor((e+d)/2),b<=a[f].start)e=f;else if(c&&b<a[f].end){e=f;break}else d=f;return e},_computeComments:function(){var a=this.view.getModel();a.getBaseModel&&(a=a.getBaseModel());this.comments=this._findComments(a.getText())},_computeFolding:function(){if(this.foldingEnabled){var a=this.view.getModel();if(a.getBaseModel){var b=this.annotationModel;if(b){b.removeAnnotations(p.AnnotationType.ANNOTATION_FOLDING);for(var c=
[],d=a.getBaseModel(),e=this.comments,f=0;f<e.length;f++){var g=e[f];(g=this._createFoldingAnnotation(a,d,g.start,g.end))&&c.push(g)}b.replaceAnnotations(null,c)}}}},_createFoldingAnnotation:function(a,b,c,d){var e=b.getLineAtOffset(c),b=b.getLineAtOffset(d);return e===b?null:new (p.AnnotationType.getType(p.AnnotationType.ANNOTATION_FOLDING))(c,d,a)},_computeTasks:function(a,b,c){if(this.detectTasks){var d=this.annotationModel;if(d){var e=this.view.getModel(),f=e;e.getBaseModel&&(f=e.getBaseModel());
for(var g=d.getAnnotations(b,c),e=[],i=p.AnnotationType.ANNOTATION_TASK;g.hasNext();){var h=g.next();h.type===i&&e.push(h)}g=[];h=this._commentScanner;h.setText(f.getText(b,c));for(var j;j=h.nextToken();){var k=h.getStartOffset()+b;j===14&&(j=f.getLineEnd(f.getLineAtOffset(k)),a!==6&&(j=Math.min(j,c-this.commentEnd.length)),g.push(p.AnnotationType.createAnnotation(i,k,j,f.getText(k,j))))}d.replaceAnnotations(e,g)}}},_getLineStyle:function(a){if(this.highlightCaretLine){var b=this.view,c=b.getModel(),
b=b.getSelection();if(b.start===b.end&&c.getLineAtOffset(b.start)===a)return x}return null},_getStyles:function(a,b,c){a.getBaseModel&&(c=a.mapOffset(c));for(var d=c+b.length,e=[],f=c,g=this.comments,i=this._binarySearch(g,c,!0);i<g.length;i++){if(g[i].start>=d)break;var h=g[i].start,j=g[i].end;f<h&&this._parse(b.substring(f-c,h-c),f,e);var k=g[i].type,m;switch(k){case 8:m=l;break;case 7:m=q;break;case 5:m=v}f=Math.max(f,h);h=Math.min(d,j);(k===8||k===7)&&(this.whitespacesVisible||this.detectHyperlinks)?
this._parseComment(b.substring(f-c,h-c),f,e,m,k):k===5&&this.whitespacesVisible?this._parseString(b.substring(f-c,h-c),f,e,v):e.push({start:f,end:h,style:m});f=j}f<d&&this._parse(b.substring(f-c,d-c),f,e);if(a.getBaseModel)for(b=0;b<e.length;b++)c=e[b].end-e[b].start,e[b].start=a.mapOffset(e[b].start,!0),e[b].end=e[b].start+c;return e},_parse:function(a,c,e){var f=this._scanner;for(f.setText(a);a=f.nextToken();){var g=f.getStartOffset()+c,h=null;switch(a){case 2:h=d;break;case 3:h=b;break;case 5:case 4:if(this.whitespacesVisible){this._parseString(f.getData(),
g,e,v);continue}else h=v;break;case 8:this._parseComment(f.getData(),g,e,l,a);continue;case 6:this._parseComment(f.getData(),g,e,i,a);continue;case 7:this._parseComment(f.getData(),g,e,q,a);continue;case 10:this.whitespacesVisible&&(h=r);break;case 11:this.whitespacesVisible&&(h=j)}e.push({start:g,end:f.getOffset()+c,style:h})}},_parseComment:function(a,b,c,d,e){var f=this._commentScanner;f.setText(a);for(f.setType(e);a=f.nextToken();){var e=f.getStartOffset()+b,g=d;switch(a){case 10:this.whitespacesVisible&&
(g=r);break;case 11:this.whitespacesVisible&&(g=j);break;case 12:g=o;break;case 13:g=u;break;case 14:g=s;break;default:this.detectHyperlinks&&(g=this._detectHyperlinks(f.getData(),e,c,g))}g&&c.push({start:e,end:f.getOffset()+b,style:g})}},_parseString:function(a,b,c,d){var e=this._whitespaceScanner;for(e.setText(a);a=e.nextToken();){var f=e.getStartOffset()+b,g=d;switch(a){case 10:this.whitespacesVisible&&(g=r);break;case 11:this.whitespacesVisible&&(g=j)}g&&c.push({start:f,end:e.getOffset()+b,style:g})}},
_detectHyperlinks:function(a,b,c,d){var e=null,f;if((f=a.indexOf("://"))>0){for(var e=a,g=f;g>0;){f=e.charCodeAt(g-1);if(!(97<=f&&f<=122||65<=f&&f<=90||45===f||48<=f&&f<=57))break;g--}if(g>0&&(f="\"\"''(){}[]<>".indexOf(e.substring(g-1,g)),f!==-1&&(f&1)===0&&(f=e.lastIndexOf("\"\"''(){}[]<>".substring(f+1,f+2)))!==-1)){var h=f;f=this._clone(d);f.tagName="A";f.attributes={href:e.substring(g,h)};c.push({start:b,end:b+g,style:d});c.push({start:b+g,end:b+h,style:f});c.push({start:b+h,end:b+a.length,style:d});
return null}}else a.toLowerCase().indexOf("bug#")===0&&(e="https://bugs.eclipse.org/bugs/show_bug.cgi?id="+parseInt(a.substring(4),10));return e?(f=this._clone(d),f.tagName="A",f.attributes={href:e},f):d},_clone:function(a){if(!a)return a;var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},_findComments:function(a,b){var b=b||0,c=this._firstScanner,d;c.setText(a);for(var e=[];d=c.nextToken();)(d===7||d===8||d===5)&&e.push({start:c.getStartOffset()+b,end:c.getOffset()+b,type:d}),(d===
6||d===7||d===8)&&this._computeTasks(d,c.getStartOffset()+b,c.getOffset()+b);return e},_findMatchingBracket:function(a,b){var c="{}()[]<>",d=a.getText(b,b+1),e=c.indexOf(d,0);if(e===-1)return-1;var f;f=e&1?c.substring(e-1,e):c.substring(e+1,e+2);for(var g=a.getLineAtOffset(b),c=a.getLine(g),h=a.getLineStart(g),i=a.getLineEnd(g),c=this._findBrackets(d,f,c,h,h,i),i=0;i<c.length;i++)if(h=c[i]>=0?1:-1,c[i]*h-1===b){var j=1;if(e&1){for(i--;i>=0;i--)if(h=c[i]>=0?1:-1,j+=h,j===0)return c[i]*h-1;for(g-=1;g>=
0;){c=a.getLine(g);h=a.getLineStart(g);i=a.getLineEnd(g);c=this._findBrackets(d,f,c,h,h,i);for(e=c.length-1;e>=0;e--)if(h=c[e]>=0?1:-1,j+=h,j===0)return c[e]*h-1;g--}}else{for(i++;i<c.length;i++)if(h=c[i]>=0?1:-1,j+=h,j===0)return c[i]*h-1;g+=1;for(e=a.getLineCount();g<e;){c=a.getLine(g);h=a.getLineStart(g);i=a.getLineEnd(g);c=this._findBrackets(d,f,c,h,h,i);for(i=0;i<c.length;i++)if(h=c[i]>=0?1:-1,j+=h,j===0)return c[i]*h-1;g++}}break}return-1},_findBrackets:function(a,b,c,d,e,f){for(var g=[],a=
a.charCodeAt(0),b=b.charCodeAt(0),h=e,i=this._scanner,j,k=this.comments,l=this._binarySearch(k,e,!0);l<k.length;l++){if(k[l].start>=f)break;j=k[l].start;var m=k[l].end;if(h<j)for(i.setText(c.substring(h-e,j-e));j=i.nextToken();)j===a?g.push(i.getStartOffset()+h-e+d+1):j===b&&g.push(-(i.getStartOffset()+h-e+d+1));h=m}if(h<f)for(i.setText(c.substring(h-e,f-e));j=i.nextToken();)j===a?g.push(i.getStartOffset()+h-e+d+1):j===b&&g.push(-(i.getStartOffset()+h-e+d+1));return g},_onDestroy:function(){this.destroy()},
_onLineStyle:function(a){if(a.textView===this.view)a.style=this._getLineStyle(a.lineIndex);a.ranges=this._getStyles(a.textView.getModel(),a.lineText,a.lineStart)},_onSelection:function(a){var b=a.oldValue,c=a.newValue,d=this.view,a=d.getModel(),e;if(this.highlightCaretLine){var f=a.getLineAtOffset(b.start);e=a.getLineAtOffset(c.start);var g=c.start===c.end,b=b.start===b.end;f===e&&b&&g||(b&&d.redrawLines(f,f+1),(f!==e||!b)&&g&&d.redrawLines(e,e+1))}if(this.annotationModel){var b=this._bracketAnnotations,
h,i;if(c.start===c.end&&(i=d.getCaretOffset())>0)i-=1,a.getBaseModel&&(i=a.mapOffset(i),a=a.getBaseModel()),a=this._findMatchingBracket(a,i),a!==-1&&(h=[p.AnnotationType.createAnnotation(p.AnnotationType.ANNOTATION_MATCHING_BRACKET,a,a+1),p.AnnotationType.createAnnotation(p.AnnotationType.ANNOTATION_CURRENT_BRACKET,i,i+1)]);this._bracketAnnotations=h;this.annotationModel.replaceAnnotations(b,h)}},_onMouseDown:function(a){if(a.clickCount===2){var b=this.view,c=b.getModel(),d=b.getOffsetAtLocation(a.x,
a.y);if(d>0){var e=d-1,f=c;c.getBaseModel&&(e=c.mapOffset(e),f=c.getBaseModel());e=this._findMatchingBracket(f,e);e!==-1&&(a.preventDefault(),a=e,c.getBaseModel&&(a=c.mapOffset(a,!0)),d>a&&(d--,a++),b.setSelection(a,d))}}},_onModelChanged:function(a){var b=a.start,c=a.removedCharCount,d=a.addedCharCount-c,e=this.view,a=e.getModel(),f=a.getBaseModel?a.getBaseModel():a,c=b+c,g=f.getCharCount(),h=this.comments.length,i=f.getLineStart(f.getLineAtOffset(b)),j=this._binarySearch(this.comments,i,!0),k=this._binarySearch(this.comments,
c,!1,j-1,h);j<h&&this.comments[j].start<=i&&i<this.comments[j].end?(i=this.comments[j].start,i>b&&(i+=d)):i=j===h&&h>0&&g-d===this.comments[h-1].end?this.comments[h-1].start:i;var l;k<h?(l=this.comments[k].end,l>b&&(l+=d),k+=1):(k=h,l=g);for(var m,g=this._findComments(f.getText(i,l),i),h=j;h<this.comments.length;h++)m=this.comments[h],m.start>b&&(m.start+=d),m.start>b&&(m.end+=d);var o=k-j!==g.length;if(!o)for(h=0;h<g.length;h++){m=this.comments[j+h];var q=g[h];if(m.start!==q.start||m.end!==q.end||
m.type!==q.type){o=!0;break}}h=[j,k-j].concat(g);Array.prototype.splice.apply(this.comments,h);o&&(h=i,m=l,a!==f&&(h=a.mapOffset(h,!0),m=a.mapOffset(m,!0)),e.redrawRange(h,m));if(this.foldingEnabled&&f!==a&&this.annotationModel){e=this.annotationModel;j=e.getAnnotations(i,l);i=[];for(l=[];j.hasNext();)if(m=j.next(),m.type===p.AnnotationType.ANNOTATION_FOLDING){l.push(m);for(h=0;h<g.length;h++)if(m.start===g[h].start&&m.end===g[h].end)break;h===g.length?(i.push(m),m.expand()):(h=m.start,k=m.end,h>
b&&(h-=d),k>b&&(k-=d),h<=b&&b<k&&h<=c&&c<k&&(h=f.getLineAtOffset(m.start),k=f.getLineAtOffset(m.end),h!==k?m.expanded||(m.expand(),e.modifyAnnotation(m)):e.removeAnnotation(m)))}b=[];for(h=0;h<g.length;h++){m=g[h];for(d=0;d<l.length;d++)if(l[d].start===m.start&&l[d].end===m.end)break;d===l.length&&(m=this._createFoldingAnnotation(a,f,m.start,m.end))&&b.push(m)}e.replaceAnnotations(i,b)}}};return{TextStyler:f}});
define("orion/editor/edit","orion/editor/textView,orion/editor/textModel,orion/editor/textTheme,orion/editor/projectionTextModel,orion/editor/eventTarget,orion/keyBinding,orion/editor/rulers,orion/editor/annotations,orion/editor/tooltip,orion/editor/undoStack,orion/editor/textDND,orion/editor/editor,orion/editor/editorFeatures,orion/editor/contentAssist,orion/editor/cssContentAssist,orion/editor/htmlContentAssist,orion/editor/jsTemplateContentAssist,orion/editor/AsyncStyler,orion/editor/mirror,orion/editor/textMateStyler,orion/editor/htmlGrammar,examples/editor/textStyler".split(","),function(p,
t,m,h,a,e,f,k,g,c,i,q,l,o,s,u,v,b,d,j,r,x){function n(a){var b=a.firstChild;if(b&&b.tagName==="TEXTAREA")return b.value;var c=a.ownerDocument,d=c.defaultView||c.parentWindow,e;if(!(e=!d.getSelection)){if(!(b=a.childNodes.length===1&&b.nodeType===Node.TEXT_NODE)){for(var f,b=a;b&&b!==c&&f!=="none";)f=d.getComputedStyle?d.getComputedStyle(b,null).getPropertyValue("display"):b.currentStyle.display,b=b.parentNode;b=f==="none"}e=b}if(e)return a.innerText||a.textContent;c=c.createRange();c.selectNode(a);
a=d.getSelection();d=[];for(f=0;f<a.rangeCount;f++)d.push(a.getRangeAt(f));a.removeAllRanges();a.addRange(c);c=a.toString();a.removeAllRanges();for(f=0;f<d.length;f++)a.addRange(d[f]);return c}function z(a){if(a.substring(0,12)==="data-editor-")return a=a.substring(12),a=a.replace(/-([a-z])/ig,function(a,b){return b.toUpperCase()})}function C(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}function G(a,b){var c={};C(c,b);for(var d,e=0,f=a.attributes,g=f.length;e<g;e++){d=f.item(e);var h=z(d.nodeName);
if(h){d=d.nodeValue;if(d==="true"||d==="false")d=d==="true";c[h]=d}}return c}function w(a){var b=a.ownerDocument,b=b.defaultView||b.parentWindow,c;if(b.getComputedStyle)c=b.getComputedStyle(a,null).getPropertyValue("height");else if(a.currentStyle)c=a.currentStyle.height;return parseInt(c,10)||0}function D(a){var b=a.parent;b||(b="editor");typeof b==="string"&&(b=(a.document||document).getElementById(b));if(!b&&a.className){var c=(a.document||document).getElementsByClassName(a.className);if(c){a.className=
void 0;for(var d=[],e=0;e<c.length;e++)a.parent=c[e],d.push(D(a));return d}}if(!b)throw"no parent";a=G(b,a);if(typeof a.theme==="string"){var c=m.TextTheme.getTheme(a.theme),e=a.theme.lastIndexOf("/"),f=a.theme;e!==-1&&(f=f.substring(e+1));f.substring(f.length-4)===".css"&&(f=f.substring(0,f.length-4));c.setThemeClass(f,{href:a.theme});a.theme=c}var g;a.readonly||(d={createContentAssistMode:function(a){g=new o.ContentAssist(a.getTextView());a=new o.ContentAssistWidget(g);return new o.ContentAssistMode(g,
a)}});d=new q.Editor({textViewFactory:function(){return new p.TextView({parent:b,model:new h.ProjectionTextModel(new t.TextModel("")),tabSize:a.tabSize?a.tabSize:4,readonly:a.readonly,fullSelection:a.fullSelection,tabMode:a.tabMode,expandTab:a.expandTab,themeClass:a.themeClass,theme:a.theme,wrapMode:a.wrapMode})},undoStackFactory:new l.UndoFactory,annotationFactory:new l.AnnotationFactory,lineNumberRulerFactory:new l.LineNumberRulerFactory,foldingRulerFactory:new l.FoldingRulerFactory,textDNDFactory:new l.TextDNDFactory,
contentAssistFactory:d,keyBindingFactory:function(a,b,c,d){var e=new l.TextActions(a,c);b.push(e);e=new l.LinkedMode(a,c);b.push(e);a=new l.SourceCodeActions(a,c,d,e);b.push(a)},statusReporter:a.statusReporter,domNode:b});c=a.contents;c===void 0&&(c=n(b));c||(c="");d.installTextView();d.setLineNumberRulerVisible(a.showLinesRuler===void 0||a.showLinesRuler);d.setAnnotationRulerVisible(a.showAnnotationRuler===void 0||a.showFoldingRuler);d.setOverviewRulerVisible(a.showOverviewRuler===void 0||a.showOverviewRuler);
d.setFoldingRulerVisible(a.showFoldingRuler===void 0||a.showFoldingRuler);d.setInput(a.title,null,c);({styler:null,highlight:function(b,c){if(this.styler)this.styler.destroy(),this.styler=null;if(b){var d=c.getTextView(),e=c.getAnnotationModel();switch(b){case "js":case "java":case "css":this.styler=new x.TextStyler(d,b,e);c.setFoldingRulerVisible(a.showFoldingRuler===void 0||a.showFoldingRuler);break;case "html":this.styler=new j.TextMateStyler(d,new r.HtmlGrammar)}}}}).highlight(a.lang,d);if(g){var i=
new s.CssContentAssistProvider,k=new v.JSTemplateContentAssistProvider;g.addEventListener("Activating",function(){/css$/.test(a.lang)?g.setProviders([i]):/js$/.test(a.lang)&&g.setProviders([k])})}if(w(b)<=50)c=d.getTextView().computeSize().height,b.style.height=c+"px";return d}var E=this.orion?this.orion.editor:void 0;if(E)for(var A=0;A<arguments.length;A++)C(E,arguments[A]);return D});var orion=this.orion||(this.orion={}),editor=orion.editor||(orion.editor={});editor.edit=require("orion/editor/edit");